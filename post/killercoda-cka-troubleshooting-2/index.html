<!doctype html><html class=no-js lang=zh-cn><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><title>killercoda CKA：Troubleshooting - 2 - "地瓜哥"博客网</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=keywords content="Kubernetes,CKA,Kubernetes,Linux,系统架构"><meta name=description content><meta property="og:url" content="https://www.diguage.com/post/killercoda-cka-troubleshooting-2/"><meta property="og:site_name" content='"地瓜哥"博客网'><meta property="og:title" content="killercoda CKA：Troubleshooting - 2"><meta property="og:description" content=' 1. Troubleshooting - Persistent Volume, Persistent Volume Claim - Issue Troubleshooting - Persistent Volume, Persistent Volume Claim - Issue
my-pvc Persistent Volume Claim is stuck in a Pending state, fix this issue, make sure it is in Bound state
# @author D瓜哥 · https://www.diguage.com $ kubectl get pvc my-pvc -o wide NAME STATUS VOLUME CAPACITY ACCESS MODES STORAGECLASS VOLUMEATTRIBUTESCLASS AGE VOLUMEMODE my-pvc Pending standard <unset> 38s Filesystem $ kubectl get pv my-pv -o wide NAME CAPACITY ACCESS MODES RECLAIM POLICY STATUS CLAIM STORAGECLASS VOLUMEATTRIBUTESCLASS REASON AGE VOLUMEMODE my-pv 100Mi RWO Retain Available standard <unset> 51s Filesystem $ kubectl get pvc my-pvc -o yaml | tee pv.yaml apiVersion: v1 kind: PersistentVolumeClaim metadata: annotations: kubectl.kubernetes.io/last-applied-configuration: | {"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"annotations":{},"name":"my-pvc","namespace":"default"},"spec":{"accessModes":["ReadWriteMany"],"resources":{"requests":{"storage":"150Mi"}},"storageClassName":"standard"}} creationTimestamp: "2025-01-20T13:08:41Z" finalizers: - kubernetes.io/pvc-protection name: my-pvc namespace: default resourceVersion: "2002" uid: a4c6c044-4118-47a4-97b9-ceb69fac3bc2 spec: accessModes: - ReadWriteMany resources: requests: storage: 150Mi storageClassName: standard volumeMode: Filesystem status: phase: Pending $ kubectl get pv my-pv -o yaml apiVersion: v1 kind: PersistentVolume metadata: annotations: kubectl.kubernetes.io/last-applied-configuration: | {"apiVersion":"v1","kind":"PersistentVolume","metadata":{"annotations":{},"name":"my-pv"},"spec":{"accessModes":["ReadWriteOnce"],"capacity":{"storage":"100Mi"},"hostPath":{"path":"/mnt/data"},"persistentVolumeReclaimPolicy":"Retain","storageClassName":"standard"}} creationTimestamp: "2025-01-20T13:08:41Z" finalizers: - kubernetes.io/pv-protection name: my-pv resourceVersion: "2003" uid: 85a371c4-0931-4b57-87ea-fc1fceb674c1 spec: accessModes: - ReadWriteOnce capacity: storage: 100Mi hostPath: path: /mnt/data type: "" persistentVolumeReclaimPolicy: Retain storageClassName: standard volumeMode: Filesystem $ vim pv.yaml # 两个问题： # 1、 PVC 和 PV 的 accessModes 不一致，改为 ReadWriteOnce即可 # 2、 PVC 的存储是 150Mi，而 PV 只有 100Mi，也改为 100Mi 即可。 $ kubectl delete -f pv.yaml --force --grace-period 0 Warning: Immediate deletion does not wait for confirmation that the running resource has been terminated. The resource may continue to run on the cluster indefinitely. persistentvolumeclaim "my-pvc" force deleted $ kubectl apply -f pv.yaml persistentvolumeclaim/my-pvc created $ kubectl get pvc my-pvc -o wide NAME STATUS VOLUME CAPACITY ACCESS MODES STORAGECLASS VOLUMEATTRIBUTESCLASS AGE VOLUMEMODE my-pvc Bound my-pv 100Mi RWO standard <unset> 10s Filesystem '><meta property="og:locale" content="zh_cn"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2024-12-24T19:54:28+08:00"><meta property="article:modified_time" content="2025-01-22T17:24:30+08:00"><meta property="article:tag" content="Kubernetes"><meta property="article:tag" content="Linux"><meta name=twitter:card content="summary"><meta name=twitter:title content="killercoda CKA：Troubleshooting - 2"><meta name=twitter:description content=' 1. Troubleshooting - Persistent Volume, Persistent Volume Claim - Issue Troubleshooting - Persistent Volume, Persistent Volume Claim - Issue
my-pvc Persistent Volume Claim is stuck in a Pending state, fix this issue, make sure it is in Bound state
# @author D瓜哥 · https://www.diguage.com $ kubectl get pvc my-pvc -o wide NAME STATUS VOLUME CAPACITY ACCESS MODES STORAGECLASS VOLUMEATTRIBUTESCLASS AGE VOLUMEMODE my-pvc Pending standard <unset> 38s Filesystem $ kubectl get pv my-pv -o wide NAME CAPACITY ACCESS MODES RECLAIM POLICY STATUS CLAIM STORAGECLASS VOLUMEATTRIBUTESCLASS REASON AGE VOLUMEMODE my-pv 100Mi RWO Retain Available standard <unset> 51s Filesystem $ kubectl get pvc my-pvc -o yaml | tee pv.yaml apiVersion: v1 kind: PersistentVolumeClaim metadata: annotations: kubectl.kubernetes.io/last-applied-configuration: | {"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"annotations":{},"name":"my-pvc","namespace":"default"},"spec":{"accessModes":["ReadWriteMany"],"resources":{"requests":{"storage":"150Mi"}},"storageClassName":"standard"}} creationTimestamp: "2025-01-20T13:08:41Z" finalizers: - kubernetes.io/pvc-protection name: my-pvc namespace: default resourceVersion: "2002" uid: a4c6c044-4118-47a4-97b9-ceb69fac3bc2 spec: accessModes: - ReadWriteMany resources: requests: storage: 150Mi storageClassName: standard volumeMode: Filesystem status: phase: Pending $ kubectl get pv my-pv -o yaml apiVersion: v1 kind: PersistentVolume metadata: annotations: kubectl.kubernetes.io/last-applied-configuration: | {"apiVersion":"v1","kind":"PersistentVolume","metadata":{"annotations":{},"name":"my-pv"},"spec":{"accessModes":["ReadWriteOnce"],"capacity":{"storage":"100Mi"},"hostPath":{"path":"/mnt/data"},"persistentVolumeReclaimPolicy":"Retain","storageClassName":"standard"}} creationTimestamp: "2025-01-20T13:08:41Z" finalizers: - kubernetes.io/pv-protection name: my-pv resourceVersion: "2003" uid: 85a371c4-0931-4b57-87ea-fc1fceb674c1 spec: accessModes: - ReadWriteOnce capacity: storage: 100Mi hostPath: path: /mnt/data type: "" persistentVolumeReclaimPolicy: Retain storageClassName: standard volumeMode: Filesystem $ vim pv.yaml # 两个问题： # 1、 PVC 和 PV 的 accessModes 不一致，改为 ReadWriteOnce即可 # 2、 PVC 的存储是 150Mi，而 PV 只有 100Mi，也改为 100Mi 即可。 $ kubectl delete -f pv.yaml --force --grace-period 0 Warning: Immediate deletion does not wait for confirmation that the running resource has been terminated. The resource may continue to run on the cluster indefinitely. persistentvolumeclaim "my-pvc" force deleted $ kubectl apply -f pv.yaml persistentvolumeclaim/my-pvc created $ kubectl get pvc my-pvc -o wide NAME STATUS VOLUME CAPACITY ACCESS MODES STORAGECLASS VOLUMEATTRIBUTESCLASS AGE VOLUMEMODE my-pvc Bound my-pv 100Mi RWO standard <unset> 10s Filesystem '><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//fonts.gstatic.com><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/css/asciidoctor.css><link rel=stylesheet href=/css/rouge-monokai.css><link rel="shortcut icon" href=/favicon.ico><script async src="https://www.googletagmanager.com/gtag/js?id=G-1MMT2NLEL4"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-1MMT2NLEL4")}</script><script id=baidu_analytics>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?e56e7dd0a120b414f5741f4c5e5218ea",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title='"地瓜哥"博客网' rel=home><div class="logo__item logo__text"><div class=logo__title>"地瓜哥"博客网</div><div class=logo__tagline>分享技术带来的喜悦 — https://www.diguage.com/</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>菜单</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>首页</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>分类</span></a></li><li class=menu__item><a class=menu__link href=/about/><span class=menu__text>关于</span></a></li><li class=menu__item><a class=menu__link href=/archives/><span class=menu__text>归档</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>killercoda CKA：Troubleshooting - 2</h1><div class="post__meta meta"><div class="meta__item-author meta__item"><svg class="meta__icon icon icon-author" width="16" height="16" viewBox="0 0 12 16"><path d="M6 1c2.2.0 3.5 2 3.5 4.5C9.5 7 8.9 8.2 8 9c2.9.8 4 2.5 4 5v1H0v-1c0-2.5 1.1-4.2 4-5-.9-.8-1.5-2-1.5-3.5C2.5 3 3.8 1 6 1z"/></svg><span class=meta__text>D瓜哥</span></div><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2024-12-24T19:54:28+08:00>2024-12-24</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class=meta__text><a class=meta__link href=/categories/%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84/ rel=category>系统架构</a></span></div></div></header><figure class="post__thumbnail thumbnail"><img class=thumbnail__image src=/images/logos/kubernetes.svg alt="killercoda CKA：Troubleshooting - 2"></figure><div class="content post__content clearfix"><div class=sect1><h2 id=_troubleshooting_persistent_volume_persistent_volume_claim_issue>1. Troubleshooting - Persistent Volume, Persistent Volume Claim - Issue</h2><div class=sectionbody><div class=paragraph><p><a href=https://killercoda.com/sachin/course/CKA/pv-pvc-issue target=_blank rel=noopener>Troubleshooting - Persistent Volume, Persistent Volume Claim - Issue</a></p></div><div class=sidebarblock><div class=content><div class=paragraph><p><code>my-pvc</code> Persistent Volume Claim is stuck in a Pending state, fix this issue, make sure it is in Bound state</p></div></div></div><div class=listingblock><div class=content><pre class="rouge highlight nowrap"><code data-lang=bash><span class=c># @author D瓜哥 · <a href=https://www.diguage.com target=_blank>https://www.diguage.com</a></span>

<span class=nv>$ </span>kubectl get pvc my-pvc <span class=nt>-o</span> wide
NAME     STATUS    VOLUME   CAPACITY   ACCESS MODES   STORAGECLASS   VOLUMEATTRIBUTESCLASS   AGE   VOLUMEMODE
my-pvc   Pending                                      standard       &lt;<span class=nb>unset</span><span class=o>&gt;</span>                 38s   Filesystem

<span class=nv>$ </span>kubectl get pv my-pv <span class=nt>-o</span> wide
NAME    CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS      CLAIM   STORAGECLASS   VOLUMEATTRIBUTESCLASS   REASON   AGE   VOLUMEMODE
my-pv   100Mi      RWO            Retain           Available           standard       &lt;<span class=nb>unset</span><span class=o>&gt;</span>                          51s   Filesystem

<span class=nv>$ </span>kubectl get pvc my-pvc <span class=nt>-o</span> yaml | <span class=nb>tee </span>pv.yaml
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  annotations:
    kubectl.kubernetes.io/last-applied-configuration: |
      <span class=o>{</span><span class=s2>&#34;apiVersion&#34;</span>:<span class=s2>&#34;v1&#34;</span>,<span class=s2>&#34;kind&#34;</span>:<span class=s2>&#34;PersistentVolumeClaim&#34;</span>,<span class=s2>&#34;metadata&#34;</span>:<span class=o>{</span><span class=s2>&#34;annotations&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;my-pvc&#34;</span>,<span class=s2>&#34;namespace&#34;</span>:<span class=s2>&#34;default&#34;</span><span class=o>}</span>,<span class=s2>&#34;spec&#34;</span>:<span class=o>{</span><span class=s2>&#34;accessModes&#34;</span>:[<span class=s2>&#34;ReadWriteMany&#34;</span><span class=o>]</span>,<span class=s2>&#34;resources&#34;</span>:<span class=o>{</span><span class=s2>&#34;requests&#34;</span>:<span class=o>{</span><span class=s2>&#34;storage&#34;</span>:<span class=s2>&#34;150Mi&#34;</span><span class=o>}}</span>,<span class=s2>&#34;storageClassName&#34;</span>:<span class=s2>&#34;standard&#34;</span><span class=o>}}</span>
  creationTimestamp: <span class=s2>&#34;2025-01-20T13:08:41Z&#34;</span>
  finalizers:
  - kubernetes.io/pvc-protection
  name: my-pvc
  namespace: default
  resourceVersion: <span class=s2>&#34;2002&#34;</span>
  uid: a4c6c044-4118-47a4-97b9-ceb69fac3bc2
spec:
  accessModes:
  - ReadWriteMany
  resources:
    requests:
      storage: 150Mi
  storageClassName: standard
  volumeMode: Filesystem
status:
  phase: Pending

<span class=nv>$ </span>kubectl get pv my-pv <span class=nt>-o</span> yaml
apiVersion: v1
kind: PersistentVolume
metadata:
  annotations:
    kubectl.kubernetes.io/last-applied-configuration: |
      <span class=o>{</span><span class=s2>&#34;apiVersion&#34;</span>:<span class=s2>&#34;v1&#34;</span>,<span class=s2>&#34;kind&#34;</span>:<span class=s2>&#34;PersistentVolume&#34;</span>,<span class=s2>&#34;metadata&#34;</span>:<span class=o>{</span><span class=s2>&#34;annotations&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;my-pv&#34;</span><span class=o>}</span>,<span class=s2>&#34;spec&#34;</span>:<span class=o>{</span><span class=s2>&#34;accessModes&#34;</span>:[<span class=s2>&#34;ReadWriteOnce&#34;</span><span class=o>]</span>,<span class=s2>&#34;capacity&#34;</span>:<span class=o>{</span><span class=s2>&#34;storage&#34;</span>:<span class=s2>&#34;100Mi&#34;</span><span class=o>}</span>,<span class=s2>&#34;hostPath&#34;</span>:<span class=o>{</span><span class=s2>&#34;path&#34;</span>:<span class=s2>&#34;/mnt/data&#34;</span><span class=o>}</span>,<span class=s2>&#34;persistentVolumeReclaimPolicy&#34;</span>:<span class=s2>&#34;Retain&#34;</span>,<span class=s2>&#34;storageClassName&#34;</span>:<span class=s2>&#34;standard&#34;</span><span class=o>}}</span>
  creationTimestamp: <span class=s2>&#34;2025-01-20T13:08:41Z&#34;</span>
  finalizers:
  - kubernetes.io/pv-protection
  name: my-pv
  resourceVersion: <span class=s2>&#34;2003&#34;</span>
  uid: 85a371c4-0931-4b57-87ea-fc1fceb674c1
spec:
  accessModes:
  - ReadWriteOnce
  capacity:
    storage: 100Mi
  hostPath:
    path: /mnt/data
    <span class=nb>type</span>: <span class=s2>&#34;&#34;</span>
  persistentVolumeReclaimPolicy: Retain
  storageClassName: standard
  volumeMode: Filesystem

<span class=nv>$ </span>vim pv.yaml
<span class=c># 两个问题：</span>
<span class=c># 1、 PVC 和 PV 的 accessModes 不一致，改为 ReadWriteOnce即可</span>
<span class=c># 2、 PVC 的存储是 150Mi，而 PV 只有 100Mi，也改为 100Mi 即可。</span>

<span class=nv>$ </span>kubectl delete <span class=nt>-f</span> pv.yaml <span class=nt>--force</span> <span class=nt>--grace-period</span> 0
Warning: Immediate deletion does not <span class=nb>wait </span><span class=k>for </span>confirmation that the running resource has been terminated. The resource may <span class=k>continue </span>to run on the cluster indefinitely.
persistentvolumeclaim <span class=s2>&#34;my-pvc&#34;</span> force deleted

<span class=nv>$ </span>kubectl apply <span class=nt>-f</span> pv.yaml
persistentvolumeclaim/my-pvc created

<span class=nv>$ </span>kubectl get pvc my-pvc <span class=nt>-o</span> wide
NAME     STATUS   VOLUME   CAPACITY   ACCESS MODES   STORAGECLASS   VOLUMEATTRIBUTESCLASS   AGE   VOLUMEMODE
my-pvc   Bound    my-pv    100Mi      RWO            standard       &lt;<span class=nb>unset</span><span class=o>&gt;</span>                 10s   Filesystem</code></pre></div></div></div></div><div class=sect1><h2 id=_troubleshooting_cronjob_issue>2. Troubleshooting - CronJob Issue</h2><div class=sectionbody><div class=paragraph><p><a href=https://killercoda.com/sachin/course/CKA/cronjob-issue target=_blank rel=noopener>Troubleshooting - CronJob Issue</a></p></div><div class=sidebarblock><div class=content><div class=paragraph><p><code>cka-pod</code> pod exposed internally within the service name <code>cka-service</code> and for <code>cka-pod</code> monitor(access through svc) purpose deployed <code>cka-cronjob</code> cronjob that run <code>every minute</code> .</p></div><div class=paragraph><p>Now <code>cka-cronjob</code> cronjob not working as expected, fix that issue</p></div></div></div><div class=listingblock><div class=content><pre class="rouge highlight nowrap"><code data-lang=bash><span class=c># @author D瓜哥 · <a href=https://www.diguage.com target=_blank>https://www.diguage.com</a></span>


<span class=nv>$ </span>kubectl get pod
NAME                         READY   STATUS             RESTARTS     AGE
cka-cronjob-28957109-8r7mb   0/1     CrashLoopBackOff   1 <span class=o>(</span>5s ago<span class=o>)</span>   10s
cka-pod                      1/1     Running            0            63s

<span class=nv>$ </span>kubectl get pod <span class=nt>--show-labels</span>
NAME                         READY   STATUS             RESTARTS      AGE   LABELS
cka-cronjob-28957109-8r7mb   0/1     CrashLoopBackOff   1 <span class=o>(</span>10s ago<span class=o>)</span>   15s   batch.kubernetes.io/controller-uid<span class=o>=</span>c9de5bf0-5cea-4564-95fb-83d4c0edb280,batch.kubernetes.io/job-name<span class=o>=</span>cka-cronjob-28957109,controller-uid<span class=o>=</span>c9de5bf0-5cea-4564-95fb-83d4c0edb280,job-name<span class=o>=</span>cka-cronjob-28957109
cka-pod                      1/1     Running            0             68s   &lt;none&gt;

<span class=nv>$ </span>kubectl get service <span class=nt>-o</span> wide
NAME          TYPE        CLUSTER-IP      EXTERNAL-IP   PORT<span class=o>(</span>S<span class=o>)</span>   AGE   SELECTOR
cka-service   ClusterIP   10.104.12.101   &lt;none&gt;        80/TCP    82s   <span class=nv>app</span><span class=o>=</span>cka-pod
kubernetes    ClusterIP   10.96.0.1       &lt;none&gt;        443/TCP   18d   &lt;none&gt;

<span class=nv>$ </span>kubectl label pod cka-pod <span class=nv>app</span><span class=o>=</span>cka-pod
pod/cka-pod labeled
<span class=c># 问题1：Pod 没有打标签，Service 无法圈定 Pod，增加标签</span>

<span class=nv>$ </span>kubectl describe pod cka-cronjob-28957109-8r7mb
Name:             cka-cronjob-28957109-8r7mb
Namespace:        default
Priority:         0
Service Account:  default
Node:             node01/172.30.2.2
Start Time:       Tue, 21 Jan 2025 02:29:00 +0000
Labels:           batch.kubernetes.io/controller-uid<span class=o>=</span>c9de5bf0-5cea-4564-95fb-83d4c0edb280
                  batch.kubernetes.io/job-name<span class=o>=</span>cka-cronjob-28957109
                  controller-uid<span class=o>=</span>c9de5bf0-5cea-4564-95fb-83d4c0edb280
                  job-name<span class=o>=</span>cka-cronjob-28957109
Annotations:      cni.projectcalico.org/containerID: 51af99d758b14174997994ffc69b03dd8cc3181e720aa556ee2e89c54c1839aa
                  cni.projectcalico.org/podIP: 192.168.1.5/32
                  cni.projectcalico.org/podIPs: 192.168.1.5/32
Status:           Running
IP:               192.168.1.5
IPs:
  IP:           192.168.1.5
Controlled By:  Job/cka-cronjob-28957109
Containers:
  curl-container:
    Container ID:  containerd://1ccbf47c84f56d5b560a626b742582486e85eed26049998b4e023f0e17b0f69e
    Image:         curlimages/curl:latest
    Image ID:      docker.io/curlimages/curl@sha256:c1fe1679c34d9784c1b0d1e5f62ac0a79fca01fb6377cdd33e90473c6f9f9a69
    Port:          &lt;none&gt;
    Host Port:     &lt;none&gt;
    Command:
      curl
      cka-pod
    State:          Waiting
      Reason:       CrashLoopBackOff
    Last State:     Terminated
      Reason:       Error
      Exit Code:    6
      Started:      Tue, 21 Jan 2025 02:31:58 +0000
      Finished:     Tue, 21 Jan 2025 02:31:58 +0000
    Ready:          False
    Restart Count:  5
    Environment:    &lt;none&gt;
    Mounts:
      /var/run/secrets/kubernetes.io/serviceaccount from kube-api-access-hqhfx <span class=o>(</span>ro<span class=o>)</span>
Conditions:
  Type                        Status
  PodReadyToStartContainers   True
  Initialized                 True
  Ready                       False
  ContainersReady             False
  PodScheduled                True
Volumes:
  kube-api-access-hqhfx:
    Type:                    Projected <span class=o>(</span>a volume that contains injected data from multiple sources<span class=o>)</span>
    TokenExpirationSeconds:  3607
    ConfigMapName:           kube-root-ca.crt
    ConfigMapOptional:       &lt;nil&gt;
    DownwardAPI:             <span class=nb>true
</span>QoS Class:                   BestEffort
Node-Selectors:              &lt;none&gt;
Tolerations:                 node.kubernetes.io/not-ready:NoExecute <span class=nv>op</span><span class=o>=</span>Exists <span class=k>for </span>300s
                             node.kubernetes.io/unreachable:NoExecute <span class=nv>op</span><span class=o>=</span>Exists <span class=k>for </span>300s
Events:
  Type     Reason     Age                   From               Message
  <span class=nt>----</span>     <span class=nt>------</span>     <span class=nt>----</span>                  <span class=nt>----</span>               <span class=nt>-------</span>
  Normal   Scheduled  3m10s                 default-scheduler  Successfully assigned default/cka-cronjob-28957109-8r7mb to node01
  Normal   Pulled     3m7s                  kubelet            Successfully pulled image <span class=s2>&#34;curlimages/curl:latest&#34;</span> <span class=k>in </span>3.202s <span class=o>(</span>3.202s including waiting<span class=o>)</span><span class=nb>.</span> Image size: 9560620 bytes.
  Normal   Pulled     3m6s                  kubelet            Successfully pulled image <span class=s2>&#34;curlimages/curl:latest&#34;</span> <span class=k>in </span>603ms <span class=o>(</span>603ms including waiting<span class=o>)</span><span class=nb>.</span> Image size: 9560620 bytes.
  Normal   Pulled     2m50s                 kubelet            Successfully pulled image <span class=s2>&#34;curlimages/curl:latest&#34;</span> <span class=k>in </span>512ms <span class=o>(</span>512ms including waiting<span class=o>)</span><span class=nb>.</span> Image size: 9560620 bytes.
  Normal   Created    2m22s <span class=o>(</span>x4 over 3m7s<span class=o>)</span>  kubelet            Created container curl-container
  Normal   Started    2m22s <span class=o>(</span>x4 over 3m7s<span class=o>)</span>  kubelet            Started container curl-container
  Normal   Pulled     2m22s                 kubelet            Successfully pulled image <span class=s2>&#34;curlimages/curl:latest&#34;</span> <span class=k>in </span>516ms <span class=o>(</span>516ms including waiting<span class=o>)</span><span class=nb>.</span> Image size: 9560620 bytes.
  Warning  BackOff    114s <span class=o>(</span>x7 over 3m6s<span class=o>)</span>   kubelet            Back-off restarting failed container curl-container <span class=k>in </span>pod cka-cronjob-28957109-8r7mb_default<span class=o>(</span>df6d561f-6210-4f26-af44-f6b47e155fb7<span class=o>)</span>
  Normal   Pulling    99s <span class=o>(</span>x5 over 3m11s<span class=o>)</span>   kubelet            Pulling image <span class=s2>&#34;curlimages/curl:latest&#34;</span>
  Normal   Pulled     99s                   kubelet            Successfully pulled image <span class=s2>&#34;curlimages/curl:latest&#34;</span> <span class=k>in </span>463ms <span class=o>(</span>463ms including waiting<span class=o>)</span><span class=nb>.</span> Image size: 9560620 bytes.

<span class=nv>$ </span>kubectl get cronjobs.batch cka-cronjob <span class=nt>-o</span> yaml | <span class=nb>tee </span>job.yaml
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    kubectl.kubernetes.io/last-applied-configuration: |
      <span class=o>{</span><span class=s2>&#34;apiVersion&#34;</span>:<span class=s2>&#34;batch/v1&#34;</span>,<span class=s2>&#34;kind&#34;</span>:<span class=s2>&#34;CronJob&#34;</span>,<span class=s2>&#34;metadata&#34;</span>:<span class=o>{</span><span class=s2>&#34;annotations&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;cka-cronjob&#34;</span>,<span class=s2>&#34;namespace&#34;</span>:<span class=s2>&#34;default&#34;</span><span class=o>}</span>,<span class=s2>&#34;spec&#34;</span>:<span class=o>{</span><span class=s2>&#34;jobTemplate&#34;</span>:<span class=o>{</span><span class=s2>&#34;spec&#34;</span>:<span class=o>{</span><span class=s2>&#34;template&#34;</span>:<span class=o>{</span><span class=s2>&#34;spec&#34;</span>:<span class=o>{</span><span class=s2>&#34;containers&#34;</span>:[<span class=o>{</span><span class=s2>&#34;command&#34;</span>:[<span class=s2>&#34;curl&#34;</span>,<span class=s2>&#34;cka-pod&#34;</span><span class=o>]</span>,<span class=s2>&#34;image&#34;</span>:<span class=s2>&#34;curlimages/curl:latest&#34;</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;curl-container&#34;</span><span class=o>}]</span>,<span class=s2>&#34;restartPolicy&#34;</span>:<span class=s2>&#34;OnFailure&#34;</span><span class=o>}}}}</span>,<span class=s2>&#34;schedule&#34;</span>:<span class=s2>&#34;* * * * *&#34;</span><span class=o>}}</span>
  creationTimestamp: <span class=s2>&#34;2025-01-21T02:28:07Z&#34;</span>
  generation: 1
  name: cka-cronjob
  namespace: default
  resourceVersion: <span class=s2>&#34;2466&#34;</span>
  uid: 0be295fd-73c7-4560-a65e-7a0951cd495b
spec:
  concurrencyPolicy: Allow
  failedJobsHistoryLimit: 1
  jobTemplate:
    metadata:
      creationTimestamp: null
    spec:
      template:
        metadata:
          creationTimestamp: null
        spec:
          containers:
          - <span class=nb>command</span>:
            - curl
            - cka-pod
            image: curlimages/curl:latest
            imagePullPolicy: Always
            name: curl-container
            resources: <span class=o>{}</span>
            terminationMessagePath: /dev/termination-log
            terminationMessagePolicy: File
          dnsPolicy: ClusterFirst
          restartPolicy: OnFailure
          schedulerName: default-scheduler
          securityContext: <span class=o>{}</span>
          terminationGracePeriodSeconds: 30
  schedule: <span class=s1>&#39;* * * * *&#39;</span>
  successfulJobsHistoryLimit: 3
  <span class=nb>suspend</span>: <span class=nb>false</span>
<span class=c>#省略了 status 字段</span>

<span class=nv>$ </span>vim job.yaml
<span class=c># 问题2： CronJob 访问的是 Pod 名称，应该访问 Service 名称，修改之</span>
<span class=c># 问题3： 每分钟执行的 Cron 表达式应该是 &#39;*/1 * * * *&#39;，改正</span>

<span class=nv>$ </span>kubectl delete cronjobs.batch cka-cronjob <span class=nt>--force</span> <span class=nt>--grace-period</span> 0
Warning: Immediate deletion does not <span class=nb>wait </span><span class=k>for </span>confirmation that the running resource has been terminated. The resource may <span class=k>continue </span>to run on the cluster indefinitely.
cronjob.batch <span class=s2>&#34;cka-cronjob&#34;</span> force deleted

<span class=nv>$ </span>kubectl apply <span class=nt>-f</span> job.yaml
cronjob.batch/cka-cronjob created

<span class=nv>$ </span>kubectl apply <span class=nt>-f</span> job.yaml
cronjob.batch/cka-cronjob created

<span class=nv>$ </span>kubectl get cronjobs.batch
NAME          SCHEDULE    TIMEZONE   SUSPEND   ACTIVE   LAST SCHEDULE   AGE
cka-cronjob   <span class=k>*</span> <span class=k>*</span> <span class=k>*</span> <span class=k>*</span> <span class=k>*</span>   &lt;none&gt;     False     0        28s             33s

<span class=nv>$ </span>kubectl get pod
NAME                         READY   STATUS      RESTARTS   AGE
cka-cronjob-28957117-zmrmb   0/1     Completed   0          36s
cka-pod                      1/1     Running     0          9m29s

<span class=nv>$ </span><span class=nb>cat </span>job.yaml
apiVersion: batch/v1
kind: CronJob
metadata:
  generation: 1
  name: cka-cronjob
  namespace: default
spec:
  concurrencyPolicy: Allow
  failedJobsHistoryLimit: 1
  jobTemplate:
    metadata:
      creationTimestamp: null
    spec:
      template:
        metadata:
          creationTimestamp: null
        spec:
          containers:
          - <span class=nb>command</span>:
            - curl
            - cka-service
            image: curlimages/curl:latest
            imagePullPolicy: Always
            name: curl-container
            resources: <span class=o>{}</span>
            terminationMessagePath: /dev/termination-log
            terminationMessagePolicy: File
          dnsPolicy: ClusterFirst
          restartPolicy: OnFailure
          schedulerName: default-scheduler
          securityContext: <span class=o>{}</span>
          terminationGracePeriodSeconds: 30
  schedule: <span class=s1>&#39;*/1 * * * *&#39;</span>
  successfulJobsHistoryLimit: 3</code></pre></div></div></div></div><div class=sect1><h2 id=_troubleshooting_daemonset_issue>3. Troubleshooting - DaemonSet Issue</h2><div class=sectionbody><div class=paragraph><p><a href=https://killercoda.com/sachin/course/CKA/ds-issue target=_blank rel=noopener>Troubleshooting - DaemonSet Issue</a></p></div><div class=sidebarblock><div class=content><div class=paragraph><p><code>cache-daemonset</code> DaemonSet deployed, now it’s not creating any pod on the <code>controlplane</code> node. fix this issue and make sure the pods are getting created on all nodes including the controlplane node as well.</p></div></div></div><div class=listingblock><div class=content><pre class="rouge highlight nowrap"><code data-lang=bash><span class=c># @author D瓜哥 · <a href=https://www.diguage.com target=_blank>https://www.diguage.com</a></span>


<span class=nv>$ </span>kubectl describe nodes | <span class=nb>grep </span>Taints
Taints:             node-role.kubernetes.io/control-plane:NoSchedule
Taints:             &lt;none&gt;

<span class=nv>$ </span>kubectl get daemonsets.apps cache-daemonset
NAME              DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR   AGE
cache-daemonset   1         1         1       1            1           &lt;none&gt;          5m7s

<span class=nv>$ </span>kubectl get pod
NAME                    READY   STATUS    RESTARTS   AGE
cache-daemonset-58q2j   1/1     Running   0          5m15s

<span class=nv>$ </span>kubectl get daemonsets.apps cache-daemonset <span class=nt>-o</span> yaml | <span class=nb>tee </span>ds.yaml
apiVersion: apps/v1
kind: DaemonSet
metadata:
  annotations:
    deprecated.daemonset.template.generation: <span class=s2>&#34;1&#34;</span>
    kubectl.kubernetes.io/last-applied-configuration: |
      <span class=o>{</span><span class=s2>&#34;apiVersion&#34;</span>:<span class=s2>&#34;apps/v1&#34;</span>,<span class=s2>&#34;kind&#34;</span>:<span class=s2>&#34;DaemonSet&#34;</span>,<span class=s2>&#34;metadata&#34;</span>:<span class=o>{</span><span class=s2>&#34;annotations&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;cache-daemonset&#34;</span>,<span class=s2>&#34;namespace&#34;</span>:<span class=s2>&#34;default&#34;</span><span class=o>}</span>,<span class=s2>&#34;spec&#34;</span>:<span class=o>{</span><span class=s2>&#34;selector&#34;</span>:<span class=o>{</span><span class=s2>&#34;matchLabels&#34;</span>:<span class=o>{</span><span class=s2>&#34;app&#34;</span>:<span class=s2>&#34;cache&#34;</span><span class=o>}}</span>,<span class=s2>&#34;template&#34;</span>:<span class=o>{</span><span class=s2>&#34;metadata&#34;</span>:<span class=o>{</span><span class=s2>&#34;labels&#34;</span>:<span class=o>{</span><span class=s2>&#34;app&#34;</span>:<span class=s2>&#34;cache&#34;</span><span class=o>}}</span>,<span class=s2>&#34;spec&#34;</span>:<span class=o>{</span><span class=s2>&#34;containers&#34;</span>:[<span class=o>{</span><span class=s2>&#34;image&#34;</span>:<span class=s2>&#34;redis:latest&#34;</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;cache-container&#34;</span>,<span class=s2>&#34;resources&#34;</span>:<span class=o>{</span><span class=s2>&#34;limits&#34;</span>:<span class=o>{</span><span class=s2>&#34;cpu&#34;</span>:<span class=s2>&#34;10m&#34;</span>,<span class=s2>&#34;memory&#34;</span>:<span class=s2>&#34;100Mi&#34;</span><span class=o>}</span>,<span class=s2>&#34;requests&#34;</span>:<span class=o>{</span><span class=s2>&#34;cpu&#34;</span>:<span class=s2>&#34;5m&#34;</span>,<span class=s2>&#34;memory&#34;</span>:<span class=s2>&#34;50Mi&#34;</span><span class=o>}}}]}}}}</span>
  creationTimestamp: <span class=s2>&#34;2025-01-21T02:48:22Z&#34;</span>
  generation: 1
  name: cache-daemonset
  namespace: default
  resourceVersion: <span class=s2>&#34;2066&#34;</span>
  uid: 27de83c4-4080-49e8-86d0-a189bdde557a
spec:
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app: cache
  template:
    metadata:
      creationTimestamp: null
      labels:
        app: cache
    spec:
      containers:
      - image: redis:latest
        imagePullPolicy: Always
        name: cache-container
        resources:
          limits:
            cpu: 10m
            memory: 100Mi
          requests:
            cpu: 5m
            memory: 50Mi
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext: <span class=o>{}</span>
      terminationGracePeriodSeconds: 30
  updateStrategy:
    rollingUpdate:
      maxSurge: 0
      maxUnavailable: 1
    <span class=nb>type</span>: RollingUpdate
<span class=c>#省略了 status 字段</span>

<span class=nv>$ </span>vim ds.yaml
<span class=c># 增加对 node-role.kubernetes.io/control-plane:NoSchedule 污点的容忍度</span>

<span class=nv>$ </span>kubectl delete <span class=nt>-f</span> ds.yaml <span class=nt>--force</span> <span class=nt>--grace-period</span> 0
Warning: Immediate deletion does not <span class=nb>wait </span><span class=k>for </span>confirmation that the running resource has been terminated. The resource may <span class=k>continue </span>to run on the cluster indefinitely.
daemonset.apps <span class=s2>&#34;cache-daemonset&#34;</span> force deleted

<span class=nv>$ </span>kubectl apply <span class=nt>-f</span> ds.yaml
daemonset.apps/cache-daemonset created

<span class=nv>$ </span>kubectl get pod
NAME                    READY   STATUS    RESTARTS     AGE
cache-daemonset-fjswc   1/1     Running   1 <span class=o>(</span>8s ago<span class=o>)</span>   12s
cache-daemonset-wc6cr   1/1     Running   0            12s

<span class=nv>$ </span><span class=nb>cat </span>ds.yaml
apiVersion: apps/v1
kind: DaemonSet
metadata:
  annotations:
    deprecated.daemonset.template.generation: <span class=s2>&#34;1&#34;</span>
    kubectl.kubernetes.io/last-applied-configuration: |
      <span class=o>{</span><span class=s2>&#34;apiVersion&#34;</span>:<span class=s2>&#34;apps/v1&#34;</span>,<span class=s2>&#34;kind&#34;</span>:<span class=s2>&#34;DaemonSet&#34;</span>,<span class=s2>&#34;metadata&#34;</span>:<span class=o>{</span><span class=s2>&#34;annotations&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;cache-daemonset&#34;</span>,<span class=s2>&#34;namespace&#34;</span>:<span class=s2>&#34;default&#34;</span><span class=o>}</span>,<span class=s2>&#34;spec&#34;</span>:<span class=o>{</span><span class=s2>&#34;selector&#34;</span>:<span class=o>{</span><span class=s2>&#34;matchLabels&#34;</span>:<span class=o>{</span><span class=s2>&#34;app&#34;</span>:<span class=s2>&#34;cache&#34;</span><span class=o>}}</span>,<span class=s2>&#34;template&#34;</span>:<span class=o>{</span><span class=s2>&#34;metadata&#34;</span>:<span class=o>{</span><span class=s2>&#34;labels&#34;</span>:<span class=o>{</span><span class=s2>&#34;app&#34;</span>:<span class=s2>&#34;cache&#34;</span><span class=o>}}</span>,<span class=s2>&#34;spec&#34;</span>:<span class=o>{</span><span class=s2>&#34;containers&#34;</span>:[<span class=o>{</span><span class=s2>&#34;image&#34;</span>:<span class=s2>&#34;redis:latest&#34;</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;cache-container&#34;</span>,<span class=s2>&#34;resources&#34;</span>:<span class=o>{</span><span class=s2>&#34;limits&#34;</span>:<span class=o>{</span><span class=s2>&#34;cpu&#34;</span>:<span class=s2>&#34;10m&#34;</span>,<span class=s2>&#34;memory&#34;</span>:<span class=s2>&#34;100Mi&#34;</span><span class=o>}</span>,<span class=s2>&#34;requests&#34;</span>:<span class=o>{</span><span class=s2>&#34;cpu&#34;</span>:<span class=s2>&#34;5m&#34;</span>,<span class=s2>&#34;memory&#34;</span>:<span class=s2>&#34;50Mi&#34;</span><span class=o>}}}]}}}}</span>
  creationTimestamp: <span class=s2>&#34;2025-01-21T02:48:22Z&#34;</span>
  generation: 1
  name: cache-daemonset
  namespace: default
  resourceVersion: <span class=s2>&#34;2066&#34;</span>
  uid: 27de83c4-4080-49e8-86d0-a189bdde557a
spec:
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app: cache
  template:
    metadata:
      creationTimestamp: null
      labels:
        app: cache
    spec:
      containers:
      - image: redis:latest
        imagePullPolicy: Always
        name: cache-container
        resources:
          limits:
            cpu: 10m
            memory: 100Mi
          requests:
            cpu: 5m
            memory: 50Mi
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext: <span class=o>{}</span>
      terminationGracePeriodSeconds: 30
      tolerations:
      - key: <span class=s2>&#34;node-role.kubernetes.io/control-plane&#34;</span>
        operator: <span class=s2>&#34;Exists&#34;</span>
        effect: <span class=s2>&#34;NoSchedule&#34;</span>
  updateStrategy:
    rollingUpdate:
      maxSurge: 0
      maxUnavailable: 1
    <span class=nb>type</span>: RollingUpdate</code></pre></div></div></div></div><div class=sect1><h2 id=_troubleshooting_deployment_issue>4. Troubleshooting - Deployment Issue</h2><div class=sectionbody><div class=paragraph><p><a href=https://killercoda.com/sachin/course/CKA/deployment-issue target=_blank rel=noopener>Troubleshooting - Deployment Issue</a></p></div><div class=sidebarblock><div class=content><div class=paragraph><p><code>postgres-deployment.yaml</code> template is there, now we can’t create object due to some issue in that, check and fix the issue</p></div><div class=paragraph><p>Note: Don’t remove any specification</p></div></div></div><div class=listingblock><div class=content><pre class="rouge highlight nowrap"><code data-lang=bash><span class=c># @author D瓜哥 · <a href=https://www.diguage.com target=_blank>https://www.diguage.com</a></span>

<span class=nv>$ </span>kubectl apply <span class=nt>-f</span> postgres-deployment.yaml
deployment.apps/postgres-deployment created

<span class=nv>$ </span>kubectl get pod
NAME                                  READY   STATUS              RESTARTS   AGE
postgres-deployment-8c8466ff9-8bvlt   0/1     ContainerCreating   0          5s

<span class=nv>$ </span><span class=nb>cat </span>postgres-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: postgres-deployment
spec:
  replicas: 1
  selector:
    matchLabels:
      app: postgres
  template:
    metadata:
      labels:
        app: postgres
    spec:
      containers:
        - name: postgres-container
          image: postgres:latest
          <span class=nb>env</span>:
            - name: POSTGRES_DB
              value: mydatabase
            - name: POSTGRES_USER
              valueFrom:
                secretKeyRef:
                  name: postgres-secrte
                  key: db_user
            - name: POSTGRES_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: postgres-secret
                  key: db_password
          ports:
            - containerPort: 5432

<span class=nv>$ </span>kubectl get pod
NAME                                  READY   STATUS                       RESTARTS   AGE
postgres-deployment-8c8466ff9-8bvlt   0/1     CreateContainerConfigError   0          43s

<span class=nv>$ </span>kubectl describe pod postgres-deployment-8c8466ff9-8bvlt
Name:             postgres-deployment-8c8466ff9-8bvlt
Namespace:        default
Priority:         0
Service Account:  default
Node:             node01/172.30.2.2
Start Time:       Tue, 21 Jan 2025 03:04:55 +0000
Labels:           <span class=nv>app</span><span class=o>=</span>postgres
                  pod-template-hash<span class=o>=</span>8c8466ff9
Annotations:      cni.projectcalico.org/containerID: 8a8af747e876c07af783291b0b9bbb0ae69bd8aa1d280d3d2d7d40e092fe697a
                  cni.projectcalico.org/podIP: 192.168.1.4/32
                  cni.projectcalico.org/podIPs: 192.168.1.4/32
Status:           Pending
IP:               192.168.1.4
IPs:
  IP:           192.168.1.4
Controlled By:  ReplicaSet/postgres-deployment-8c8466ff9
Containers:
  postgres-container:
    Container ID:
    Image:          postgres:latest
    Image ID:
    Port:           5432/TCP
    Host Port:      0/TCP
    State:          Waiting
      Reason:       CreateContainerConfigError
    Ready:          False
    Restart Count:  0
    Environment:
      POSTGRES_DB:        mydatabase
      POSTGRES_USER:      &lt;<span class=nb>set </span>to the key <span class=s1>&#39;db_user&#39;</span> <span class=k>in </span>secret <span class=s1>&#39;postgres-secrte&#39;</span><span class=o>&gt;</span>      Optional: <span class=nb>false
      </span>POSTGRES_PASSWORD:  &lt;<span class=nb>set </span>to the key <span class=s1>&#39;db_password&#39;</span> <span class=k>in </span>secret <span class=s1>&#39;postgres-secret&#39;</span><span class=o>&gt;</span>  Optional: <span class=nb>false
    </span>Mounts:
      /var/run/secrets/kubernetes.io/serviceaccount from kube-api-access-4p6bn <span class=o>(</span>ro<span class=o>)</span>
Conditions:
  Type                        Status
  PodReadyToStartContainers   True
  Initialized                 True
  Ready                       False
  ContainersReady             False
  PodScheduled                True
Volumes:
  kube-api-access-4p6bn:
    Type:                    Projected <span class=o>(</span>a volume that contains injected data from multiple sources<span class=o>)</span>
    TokenExpirationSeconds:  3607
    ConfigMapName:           kube-root-ca.crt
    ConfigMapOptional:       &lt;nil&gt;
    DownwardAPI:             <span class=nb>true
</span>QoS Class:                   BestEffort
Node-Selectors:              &lt;none&gt;
Tolerations:                 node.kubernetes.io/not-ready:NoExecute <span class=nv>op</span><span class=o>=</span>Exists <span class=k>for </span>300s
                             node.kubernetes.io/unreachable:NoExecute <span class=nv>op</span><span class=o>=</span>Exists <span class=k>for </span>300s
Events:
  Type     Reason     Age                From               Message
  <span class=nt>----</span>     <span class=nt>------</span>     <span class=nt>----</span>               <span class=nt>----</span>               <span class=nt>-------</span>
  Normal   Scheduled  56s                default-scheduler  Successfully assigned default/postgres-deployment-8c8466ff9-8bvlt to node01
  Normal   Pulled     37s                kubelet            Successfully pulled image <span class=s2>&#34;postgres:latest&#34;</span> <span class=k>in </span>18.429s <span class=o>(</span>18.429s including waiting<span class=o>)</span><span class=nb>.</span> Image size: 153797110 bytes.
  Normal   Pulled     35s                kubelet            Successfully pulled image <span class=s2>&#34;postgres:latest&#34;</span> <span class=k>in </span>509ms <span class=o>(</span>509ms including waiting<span class=o>)</span><span class=nb>.</span> Image size: 153797110 bytes.
  Normal   Pulled     23s                kubelet            Successfully pulled image <span class=s2>&#34;postgres:latest&#34;</span> <span class=k>in </span>469ms <span class=o>(</span>469ms including waiting<span class=o>)</span><span class=nb>.</span> Image size: 153797110 bytes.
  Warning  Failed     12s <span class=o>(</span>x4 over 37s<span class=o>)</span>  kubelet            Error: secret <span class=s2>&#34;postgres-secrte&#34;</span> not found
  Normal   Pulled     12s                kubelet            Successfully pulled image <span class=s2>&#34;postgres:latest&#34;</span> <span class=k>in </span>478ms <span class=o>(</span>478ms including waiting<span class=o>)</span><span class=nb>.</span> Image size: 153797110 bytes.
  Normal   Pulling    0s <span class=o>(</span>x5 over 55s<span class=o>)</span>   kubelet            Pulling image <span class=s2>&#34;postgres:latest&#34;</span>

<span class=nv>$ </span>kubectl get secrets
NAME              TYPE     DATA   AGE
postgres-secret   Opaque   2      2m51s

<span class=nv>$ </span>kubectl get secrets postgres-secret <span class=nt>-o</span> yaml
apiVersion: v1
data:
  password: <span class=nv>ZGJwYXNzd29yZAo</span><span class=o>=</span>
  username: <span class=nv>ZGJ1c2VyCg</span><span class=o>==</span>
kind: Secret
metadata:
  annotations:
    kubectl.kubernetes.io/last-applied-configuration: |
      <span class=o>{</span><span class=s2>&#34;apiVersion&#34;</span>:<span class=s2>&#34;v1&#34;</span>,<span class=s2>&#34;data&#34;</span>:<span class=o>{</span><span class=s2>&#34;password&#34;</span>:<span class=s2>&#34;ZGJwYXNzd29yZAo=&#34;</span>,<span class=s2>&#34;username&#34;</span>:<span class=s2>&#34;ZGJ1c2VyCg==&#34;</span><span class=o>}</span>,<span class=s2>&#34;kind&#34;</span>:<span class=s2>&#34;Secret&#34;</span>,<span class=s2>&#34;metadata&#34;</span>:<span class=o>{</span><span class=s2>&#34;annotations&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;postgres-secret&#34;</span>,<span class=s2>&#34;namespace&#34;</span>:<span class=s2>&#34;default&#34;</span><span class=o>}</span>,<span class=s2>&#34;type&#34;</span>:<span class=s2>&#34;Opaque&#34;</span><span class=o>}</span>
  creationTimestamp: <span class=s2>&#34;2025-01-21T03:04:27Z&#34;</span>
  name: postgres-secret
  namespace: default
  resourceVersion: <span class=s2>&#34;2204&#34;</span>
  uid: 970470ca-60aa-4777-be2b-b5a4beb01e45
<span class=nb>type</span>: Opaque

<span class=nv>$ </span>vim postgres-deployment.yaml
<span class=c># 两个问题：</span>
<span class=c># 1、 Secret 的名称写错了</span>
<span class=c># 2、 Secret 变量名称写的与 postgres-secret 中的定义不一致</span>

<span class=nv>$ </span>kubectl delete <span class=nt>-f</span> postgres-deployment.yaml <span class=nt>--force</span> <span class=nt>--grace-period</span> 0
Warning: Immediate deletion does not <span class=nb>wait </span><span class=k>for </span>confirmation that the running resource has been terminated. The resource may <span class=k>continue </span>to run on the cluster indefinitely.
deployment.apps <span class=s2>&#34;postgres-deployment&#34;</span> force deleted

<span class=nv>$ </span>kubectl apply <span class=nt>-f</span> postgres-deployment.yaml
deployment.apps/postgres-deployment created

<span class=nv>$ </span>kubectl get pod
NAME                                  READY   STATUS    RESTARTS   AGE
postgres-deployment-7cd67d47d-tdms8   1/1     Running   0          7s</code></pre></div></div></div></div><div class=sect1><h2 id=_troubleshooting_deployment_issue_1>5. Troubleshooting - Deployment Issue 1</h2><div class=sectionbody><div class=paragraph><p><a href=https://killercoda.com/sachin/course/CKA/deployment-issue-1 target=_blank rel=noopener>Troubleshooting - Deployment Issue 1</a></p></div><div class=sidebarblock><div class=content><div class=paragraph><p><code>nginx-deployment</code> deployment pods are not running, fix that issue</p></div></div></div><div class=listingblock><div class=content><pre class="rouge highlight nowrap"><code data-lang=bash><span class=c># @author D瓜哥 · <a href=https://www.diguage.com target=_blank>https://www.diguage.com</a></span>

<span class=nv>$ </span>kubectl get deployments.apps nginx-deployment <span class=nt>-o</span> wide
NAME               READY   UP-TO-DATE   AVAILABLE   AGE   CONTAINERS        IMAGES         SELECTOR
nginx-deployment   0/1     1            0           69s   nginx-container   nginx:latest   <span class=nv>app</span><span class=o>=</span>nginx

<span class=nv>$ </span>kubectl get pod
NAME                                READY   STATUS     RESTARTS   AGE
nginx-deployment-5bf48dd9b5-6nkgk   0/1     Init:0/1   0          77s

<span class=nv>$ </span>kubectl describe pod nginx-deployment-5bf48dd9b5-6nkgk
Name:             nginx-deployment-5bf48dd9b5-6nkgk
Namespace:        default
Priority:         0
Service Account:  default
Node:             node01/172.30.2.2
Start Time:       Wed, 22 Jan 2025 09:01:15 +0000
Labels:           <span class=nv>app</span><span class=o>=</span>nginx
                  pod-template-hash<span class=o>=</span>5bf48dd9b5
Annotations:      &lt;none&gt;
Status:           Pending
IP:
IPs:              &lt;none&gt;
Controlled By:    ReplicaSet/nginx-deployment-5bf48dd9b5
Init Containers:
  init-container:
    Container ID:
    Image:         busybox
    Image ID:
    Port:          &lt;none&gt;
    Host Port:     &lt;none&gt;
    Command:
      shell
      <span class=nb>echo</span> <span class=s1>&#39;Welcome To KillerCoda!&#39;</span>
    State:          Waiting
      Reason:       PodInitializing
    Ready:          False
    Restart Count:  0
    Environment:    &lt;none&gt;
    Mounts:
      /etc/nginx/nginx.conf from nginx-config <span class=o>(</span>rw<span class=o>)</span>
      /var/run/secrets/kubernetes.io/serviceaccount from kube-api-access-8htcj <span class=o>(</span>ro<span class=o>)</span>
Containers:
  nginx-container:
    Container ID:
    Image:          nginx:latest
    Image ID:
    Port:           80/TCP
    Host Port:      0/TCP
    State:          Waiting
      Reason:       PodInitializing
    Ready:          False
    Restart Count:  0
    Environment:    &lt;none&gt;
    Mounts:
      /var/run/secrets/kubernetes.io/serviceaccount from kube-api-access-8htcj <span class=o>(</span>ro<span class=o>)</span>
Conditions:
  Type                        Status
  PodReadyToStartContainers   False
  Initialized                 False
  Ready                       False
  ContainersReady             False
  PodScheduled                True
Volumes:
  nginx-config:
    Type:      ConfigMap <span class=o>(</span>a volume populated by a ConfigMap<span class=o>)</span>
    Name:      nginx-configuration
    Optional:  <span class=nb>false
  </span>kube-api-access-8htcj:
    Type:                    Projected <span class=o>(</span>a volume that contains injected data from multiple sources<span class=o>)</span>
    TokenExpirationSeconds:  3607
    ConfigMapName:           kube-root-ca.crt
    ConfigMapOptional:       &lt;nil&gt;
    DownwardAPI:             <span class=nb>true
</span>QoS Class:                   BestEffort
Node-Selectors:              &lt;none&gt;
Tolerations:                 node.kubernetes.io/not-ready:NoExecute <span class=nv>op</span><span class=o>=</span>Exists <span class=k>for </span>300s
                             node.kubernetes.io/unreachable:NoExecute <span class=nv>op</span><span class=o>=</span>Exists <span class=k>for </span>300s
Events:
  Type     Reason       Age                From               Message
  <span class=nt>----</span>     <span class=nt>------</span>       <span class=nt>----</span>               <span class=nt>----</span>               <span class=nt>-------</span>
  Normal   Scheduled    88s                default-scheduler  Successfully assigned default/nginx-deployment-5bf48dd9b5-6nkgk to node01
  Warning  FailedMount  24s <span class=o>(</span>x8 over 87s<span class=o>)</span>  kubelet            MountVolume.SetUp failed <span class=k>for </span>volume <span class=s2>&#34;nginx-config&#34;</span> : configmap <span class=s2>&#34;nginx-configuration&#34;</span> not found

<span class=nv>$ </span>kubectl get configmaps
NAME               DATA   AGE
kube-root-ca.crt   1      19d
nginx-configmap    1      103s

<span class=nv>$ </span>kubectl get configmaps nginx-configmap <span class=nt>-o</span> yaml
apiVersion: v1
data:
  nginx.conf: |
    server <span class=o>{</span>
        listen 80<span class=p>;</span>
        server_name localhost<span class=p>;</span>

        location / <span class=o>{</span>
            root /usr/share/nginx/html<span class=p>;</span>
            index index.html<span class=p>;</span>
        <span class=o>}</span>
    <span class=o>}</span>
kind: ConfigMap
metadata:
  annotations:
    kubectl.kubernetes.io/last-applied-configuration: |
      <span class=o>{</span><span class=s2>&#34;apiVersion&#34;</span>:<span class=s2>&#34;v1&#34;</span>,<span class=s2>&#34;data&#34;</span>:<span class=o>{</span><span class=s2>&#34;nginx.conf&#34;</span>:<span class=s2>&#34;server {</span><span class=se>\n</span><span class=s2>    listen 80;</span><span class=se>\n</span><span class=s2>    server_name localhost;</span><span class=se>\n\n</span><span class=s2>    location / {</span><span class=se>\n</span><span class=s2>        root /usr/share/nginx/html;</span><span class=se>\n</span><span class=s2>        index index.html;</span><span class=se>\n</span><span class=s2>    }</span><span class=se>\n</span><span class=s2>}</span><span class=se>\n</span><span class=s2>&#34;</span><span class=o>}</span>,<span class=s2>&#34;kind&#34;</span>:<span class=s2>&#34;ConfigMap&#34;</span>,<span class=s2>&#34;metadata&#34;</span>:<span class=o>{</span><span class=s2>&#34;annotations&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;nginx-configmap&#34;</span>,<span class=s2>&#34;namespace&#34;</span>:<span class=s2>&#34;default&#34;</span><span class=o>}}</span>
  creationTimestamp: <span class=s2>&#34;2025-01-22T09:01:15Z&#34;</span>
  name: nginx-configmap
  namespace: default
  resourceVersion: <span class=s2>&#34;2794&#34;</span>
  uid: a8153cc6-3a2c-408a-81c5-8c28eee01b04

<span class=nv>$ </span>kubectl get deployments.apps nginx-deployment <span class=nt>-o</span> yaml | <span class=nb>tee </span>dep.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    deployment.kubernetes.io/revision: <span class=s2>&#34;1&#34;</span>
    kubectl.kubernetes.io/last-applied-configuration: |
      <span class=o>{</span><span class=s2>&#34;apiVersion&#34;</span>:<span class=s2>&#34;apps/v1&#34;</span>,<span class=s2>&#34;kind&#34;</span>:<span class=s2>&#34;Deployment&#34;</span>,<span class=s2>&#34;metadata&#34;</span>:<span class=o>{</span><span class=s2>&#34;annotations&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;nginx-deployment&#34;</span>,<span class=s2>&#34;namespace&#34;</span>:<span class=s2>&#34;default&#34;</span><span class=o>}</span>,<span class=s2>&#34;spec&#34;</span>:<span class=o>{</span><span class=s2>&#34;replicas&#34;</span>:1,<span class=s2>&#34;selector&#34;</span>:<span class=o>{</span><span class=s2>&#34;matchLabels&#34;</span>:<span class=o>{</span><span class=s2>&#34;app&#34;</span>:<span class=s2>&#34;nginx&#34;</span><span class=o>}}</span>,<span class=s2>&#34;template&#34;</span>:<span class=o>{</span><span class=s2>&#34;metadata&#34;</span>:<span class=o>{</span><span class=s2>&#34;labels&#34;</span>:<span class=o>{</span><span class=s2>&#34;app&#34;</span>:<span class=s2>&#34;nginx&#34;</span><span class=o>}}</span>,<span class=s2>&#34;spec&#34;</span>:<span class=o>{</span><span class=s2>&#34;containers&#34;</span>:[<span class=o>{</span><span class=s2>&#34;image&#34;</span>:<span class=s2>&#34;nginx:latest&#34;</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;nginx-container&#34;</span>,<span class=s2>&#34;ports&#34;</span>:[<span class=o>{</span><span class=s2>&#34;containerPort&#34;</span>:80<span class=o>}]}]</span>,<span class=s2>&#34;initContainers&#34;</span>:[<span class=o>{</span><span class=s2>&#34;command&#34;</span>:[<span class=s2>&#34;shell&#34;</span>,<span class=s2>&#34;echo &#39;Welcome To KillerCoda!&#39;&#34;</span><span class=o>]</span>,<span class=s2>&#34;image&#34;</span>:<span class=s2>&#34;busybox&#34;</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;init-container&#34;</span>,<span class=s2>&#34;volumeMounts&#34;</span>:[<span class=o>{</span><span class=s2>&#34;mountPath&#34;</span>:<span class=s2>&#34;/etc/nginx/nginx.conf&#34;</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;nginx-config&#34;</span><span class=o>}]}]</span>,<span class=s2>&#34;volumes&#34;</span>:[<span class=o>{</span><span class=s2>&#34;configMap&#34;</span>:<span class=o>{</span><span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;nginx-configuration&#34;</span><span class=o>}</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;nginx-config&#34;</span><span class=o>}]}}}}</span>
  creationTimestamp: <span class=s2>&#34;2025-01-22T09:01:15Z&#34;</span>
  generation: 1
  name: nginx-deployment
  namespace: default
  resourceVersion: <span class=s2>&#34;2805&#34;</span>
  uid: b7379fa9-4065-47f6-9872-c6186eb800cf
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app: nginx
  strategy:
    rollingUpdate:
      maxSurge: 25%
      maxUnavailable: 25%
    <span class=nb>type</span>: RollingUpdate
  template:
    metadata:
      creationTimestamp: null
      labels:
        app: nginx
    spec:
      containers:
      - image: nginx:latest
        imagePullPolicy: Always
        name: nginx-container
        ports:
        - containerPort: 80
          protocol: TCP
        resources: <span class=o>{}</span>
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
      dnsPolicy: ClusterFirst
      initContainers:
      - <span class=nb>command</span>:
        - shell
        - <span class=nb>echo</span> <span class=s1>&#39;Welcome To KillerCoda!&#39;</span>
        image: busybox
        imagePullPolicy: Always
        name: init-container
        resources: <span class=o>{}</span>
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        volumeMounts:
        - mountPath: /etc/nginx/nginx.conf
          name: nginx-config
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext: <span class=o>{}</span>
      terminationGracePeriodSeconds: 30
      volumes:
      - configMap:
          defaultMode: 420
          name: nginx-configuration
        name: nginx-config
<span class=c># 省略 status 字段</span>

<span class=nv>$ </span>vim dep.yaml
<span class=c># 三个问题：</span>
<span class=c># 1、Deployment 中，ConfigMap 名称写错，应该改为上述查询到的名称</span>
<span class=c># 2、没有 shell 命令，改为 sh</span>
<span class=c># 3、sh 必须配合 -c 配置项才行</span>

<span class=nv>$ </span>kubectl delete <span class=nt>-f</span> dep.yaml <span class=nt>--force</span> <span class=nt>--grace-period</span> 0
Warning: Immediate deletion does not <span class=nb>wait </span><span class=k>for </span>confirmation that the running resource has been terminated. The resource may <span class=k>continue </span>to run on the cluster indefinitely.
deployment.apps <span class=s2>&#34;nginx-deployment&#34;</span> force deleted

<span class=nv>$ </span>kubectl apply <span class=nt>-f</span> dep.yaml
deployment.apps/nginx-deployment created

<span class=nv>$ </span>kubectl get pod
NAME                                READY   STATUS    RESTARTS   AGE
nginx-deployment-84547955c8-pbbsp   1/1     Running   0          28s

<span class=nv>$ </span><span class=nb>cat </span>dep.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx-deployment
  namespace: default
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app: nginx
  strategy:
    rollingUpdate:
      maxSurge: 25%
      maxUnavailable: 25%
    <span class=nb>type</span>: RollingUpdate
  template:
    metadata:
      creationTimestamp: null
      labels:
        app: nginx
    spec:
      containers:
      - image: nginx:latest
        imagePullPolicy: Always
        name: nginx-container
        ports:
        - containerPort: 80
          protocol: TCP
        resources: <span class=o>{}</span>
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
      dnsPolicy: ClusterFirst
      initContainers:
      - <span class=nb>command</span>:
        - sh
        - <span class=s2>&#34;-c&#34;</span>
        - <span class=nb>echo</span> <span class=s1>&#39;Welcome To KillerCoda!&#39;</span>
        image: busybox
        imagePullPolicy: Always
        name: init-container
        resources: <span class=o>{}</span>
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        volumeMounts:
        - mountPath: /etc/nginx/nginx.conf
          name: nginx-config
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext: <span class=o>{}</span>
      terminationGracePeriodSeconds: 30
      volumes:
      - configMap:
          defaultMode: 420
          name: nginx-configmap
        name: nginx-config</code></pre></div></div></div></div><div class=sect1><h2 id=_troubleshooting_deployment_issue_2>6. Troubleshooting - Deployment Issue 2</h2><div class=sectionbody><div class=paragraph><p><a href=https://killercoda.com/sachin/course/CKA/deployment-issue-2 target=_blank rel=noopener>Troubleshooting - Deployment Issue 2</a></p></div><div class=sidebarblock><div class=content><div class=paragraph><p><code>frontend-deployment.yaml</code> deployment template is there, try to deploy, if there is any issue fix that</p></div></div></div><div class=listingblock><div class=content><pre class="rouge highlight nowrap"><code data-lang=bash><span class=c># @author D瓜哥 · <a href=https://www.diguage.com target=_blank>https://www.diguage.com</a></span>

<span class=nv>$ </span><span class=nb>cat </span>frontend-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: frontend-deployment
  namespace: nginx-ns
spec:
  replicas: 1
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
        - name: nginx-container
          image: nginx:latest
          ports:
            - containerPort: 80

<span class=nv>$ </span>kubectl apply <span class=nt>-f</span> frontend-deployment.yaml
Error from server <span class=o>(</span>NotFound<span class=o>)</span>: error when creating <span class=s2>&#34;frontend-deployment.yaml&#34;</span>: namespaces <span class=s2>&#34;nginx-ns&#34;</span> not found

<span class=nv>$ </span>kubectl create namespace nginx-ns
namespace/nginx-ns created

<span class=nv>$ </span>kubectl apply <span class=nt>-f</span> frontend-deployment.yaml
deployment.apps/frontend-deployment created

<span class=nv>$ </span>kubectl <span class=nt>-n</span> nginx-ns get pod
NAME                                   READY   STATUS    RESTARTS   AGE
frontend-deployment-6575f54b8f-bj9tw   1/1     Running   0          13s</code></pre></div></div></div></div><div class=sect1><h2 id=_troubleshooting_deployment_issue_3>7. Troubleshooting - Deployment Issue 3</h2><div class=sectionbody><div class=paragraph><p><a href=https://killercoda.com/sachin/course/CKA/deployment-issue-3 target=_blank rel=noopener>Troubleshooting - Deployment Issue 3</a></p></div><div class=sidebarblock><div class=content><div class=paragraph><p><code>postgres-deployment</code> deployment pods are not running, fix that issue</p></div></div></div><div class=listingblock><div class=content><pre class="rouge highlight nowrap"><code data-lang=bash><span class=c># @author D瓜哥 · <a href=https://www.diguage.com target=_blank>https://www.diguage.com</a></span>

<span class=nv>$ </span>kubectl get deployments.apps
NAME                  READY   UP-TO-DATE   AVAILABLE   AGE
postgres-deployment   0/1     1            0           20s

<span class=nv>$ </span>kubectl get pod
NAME                                   READY   STATUS                       RESTARTS   AGE
postgres-deployment-75b4ffc554-ckjp8   0/1     CreateContainerConfigError   0          25s

<span class=nv>$ </span>kubectl describe pod postgres-deployment-75b4ffc554-ckjp8
Name:             postgres-deployment-75b4ffc554-ckjp8
Namespace:        default
Priority:         0
Service Account:  default
Node:             node01/172.30.2.2
Start Time:       Tue, 21 Jan 2025 07:43:21 +0000
Labels:           <span class=nv>app</span><span class=o>=</span>postgres
                  pod-template-hash<span class=o>=</span>75b4ffc554
Annotations:      cni.projectcalico.org/containerID: f12fd2dba041db5b979492c2703270624e0c2d0cb7aeb5365badd2700297e209
                  cni.projectcalico.org/podIP: 192.168.1.4/32
                  cni.projectcalico.org/podIPs: 192.168.1.4/32
Status:           Pending
IP:               192.168.1.4
IPs:
  IP:           192.168.1.4
Controlled By:  ReplicaSet/postgres-deployment-75b4ffc554
Containers:
  postgres-container:
    Container ID:
    Image:          postgres:latest
    Image ID:
    Port:           5432/TCP
    Host Port:      0/TCP
    State:          Waiting
      Reason:       CreateContainerConfigError
    Ready:          False
    Restart Count:  0
    Environment:
      POSTGRES_DB:        &lt;<span class=nb>set </span>to the key <span class=s1>&#39;POSTGRES_DB&#39;</span> of config map <span class=s1>&#39;postgres-db-config&#39;</span><span class=o>&gt;</span>    Optional: <span class=nb>false
      </span>POSTGRES_USER:      &lt;<span class=nb>set </span>to the key <span class=s1>&#39;POSTGRES_USER&#39;</span> of config map <span class=s1>&#39;postgres-db-config&#39;</span><span class=o>&gt;</span>  Optional: <span class=nb>false
      </span>POSTGRES_PASSWORD:  &lt;<span class=nb>set </span>to the key <span class=s1>&#39;POSTGRES_PASSWORD&#39;</span> <span class=k>in </span>secret <span class=s1>&#39;postgres-db-secret&#39;</span><span class=o>&gt;</span>  Optional: <span class=nb>false
    </span>Mounts:
      /var/run/secrets/kubernetes.io/serviceaccount from kube-api-access-s95pr <span class=o>(</span>ro<span class=o>)</span>
Conditions:
  Type                        Status
  PodReadyToStartContainers   True
  Initialized                 True
  Ready                       False
  ContainersReady             False
  PodScheduled                True
Volumes:
  kube-api-access-s95pr:
    Type:                    Projected <span class=o>(</span>a volume that contains injected data from multiple sources<span class=o>)</span>
    TokenExpirationSeconds:  3607
    ConfigMapName:           kube-root-ca.crt
    ConfigMapOptional:       &lt;nil&gt;
    DownwardAPI:             <span class=nb>true
</span>QoS Class:                   BestEffort
Node-Selectors:              &lt;none&gt;
Tolerations:                 node.kubernetes.io/not-ready:NoExecute <span class=nv>op</span><span class=o>=</span>Exists <span class=k>for </span>300s
                             node.kubernetes.io/unreachable:NoExecute <span class=nv>op</span><span class=o>=</span>Exists <span class=k>for </span>300s
Events:
  Type     Reason     Age               From               Message
  <span class=nt>----</span>     <span class=nt>------</span>     <span class=nt>----</span>              <span class=nt>----</span>               <span class=nt>-------</span>
  Normal   Scheduled  34s               default-scheduler  Successfully assigned default/postgres-deployment-75b4ffc554-ckjp8 to node01
  Normal   Pulled     14s               kubelet            Successfully pulled image <span class=s2>&#34;postgres:latest&#34;</span> <span class=k>in </span>18.735s <span class=o>(</span>18.735s including waiting<span class=o>)</span><span class=nb>.</span> Image size: 153797110 bytes.
  Normal   Pulled     14s               kubelet            Successfully pulled image <span class=s2>&#34;postgres:latest&#34;</span> <span class=k>in </span>403ms <span class=o>(</span>403ms including waiting<span class=o>)</span><span class=nb>.</span> Image size: 153797110 bytes.
  Normal   Pulling    0s <span class=o>(</span>x3 over 33s<span class=o>)</span>  kubelet            Pulling image <span class=s2>&#34;postgres:latest&#34;</span>
  Warning  Failed     0s <span class=o>(</span>x3 over 14s<span class=o>)</span>  kubelet            Error: configmap <span class=s2>&#34;postgres-db-config&#34;</span> not found
  Normal   Pulled     0s                kubelet            Successfully pulled image <span class=s2>&#34;postgres:latest&#34;</span> <span class=k>in </span>334ms <span class=o>(</span>334ms including waiting<span class=o>)</span><span class=nb>.</span> Image size: 153797110 bytes.

<span class=nv>$ </span>kubectl get configmaps
NAME               DATA   AGE
kube-root-ca.crt   1      18d
postgres-config    2      44s

<span class=nv>$ </span>kubectl get configmaps postgres-config <span class=nt>-o</span> yaml
apiVersion: v1
data:
  POSTGRES_DB: mydatabase
  POSTGRES_USER: myuser
kind: ConfigMap
metadata:
  annotations:
    kubectl.kubernetes.io/last-applied-configuration: |
      <span class=o>{</span><span class=s2>&#34;apiVersion&#34;</span>:<span class=s2>&#34;v1&#34;</span>,<span class=s2>&#34;data&#34;</span>:<span class=o>{</span><span class=s2>&#34;POSTGRES_DB&#34;</span>:<span class=s2>&#34;mydatabase&#34;</span>,<span class=s2>&#34;POSTGRES_USER&#34;</span>:<span class=s2>&#34;myuser&#34;</span><span class=o>}</span>,<span class=s2>&#34;kind&#34;</span>:<span class=s2>&#34;ConfigMap&#34;</span>,<span class=s2>&#34;metadata&#34;</span>:<span class=o>{</span><span class=s2>&#34;annotations&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;postgres-config&#34;</span>,<span class=s2>&#34;namespace&#34;</span>:<span class=s2>&#34;default&#34;</span><span class=o>}}</span>
  creationTimestamp: <span class=s2>&#34;2025-01-21T07:43:21Z&#34;</span>
  name: postgres-config
  namespace: default
  resourceVersion: <span class=s2>&#34;2818&#34;</span>
  uid: 37338d2d-0827-4aa3-bfad-8344b4a38d75

<span class=nv>$ </span>kubectl get secrets
NAME              TYPE     DATA   AGE
postgres-secret   Opaque   1      3m51s

<span class=nv>$ </span>kubectl get secrets postgres-secret <span class=nt>-o</span> yaml
apiVersion: v1
data:
  POSTGRES_PASSWORD: cGFzc3dvcmQK
kind: Secret
metadata:
  annotations:
    kubectl.kubernetes.io/last-applied-configuration: |
      <span class=o>{</span><span class=s2>&#34;apiVersion&#34;</span>:<span class=s2>&#34;v1&#34;</span>,<span class=s2>&#34;data&#34;</span>:<span class=o>{</span><span class=s2>&#34;POSTGRES_PASSWORD&#34;</span>:<span class=s2>&#34;cGFzc3dvcmQK&#34;</span><span class=o>}</span>,<span class=s2>&#34;kind&#34;</span>:<span class=s2>&#34;Secret&#34;</span>,<span class=s2>&#34;metadata&#34;</span>:<span class=o>{</span><span class=s2>&#34;annotations&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;postgres-secret&#34;</span>,<span class=s2>&#34;namespace&#34;</span>:<span class=s2>&#34;default&#34;</span><span class=o>}</span>,<span class=s2>&#34;type&#34;</span>:<span class=s2>&#34;Opaque&#34;</span><span class=o>}</span>
  creationTimestamp: <span class=s2>&#34;2025-01-21T07:43:21Z&#34;</span>
  name: postgres-secret
  namespace: default
  resourceVersion: <span class=s2>&#34;2819&#34;</span>
  uid: 52e5f67e-b16b-4ca1-b147-ea59badc8509
<span class=nb>type</span>: Opaque

<span class=nv>$ </span>kubectl get deployments.apps postgres-deployment <span class=nt>-o</span> yaml | <span class=nb>tee </span>dep.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    deployment.kubernetes.io/revision: <span class=s2>&#34;1&#34;</span>
    kubectl.kubernetes.io/last-applied-configuration: |
      <span class=o>{</span><span class=s2>&#34;apiVersion&#34;</span>:<span class=s2>&#34;apps/v1&#34;</span>,<span class=s2>&#34;kind&#34;</span>:<span class=s2>&#34;Deployment&#34;</span>,<span class=s2>&#34;metadata&#34;</span>:<span class=o>{</span><span class=s2>&#34;annotations&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;postgres-deployment&#34;</span>,<span class=s2>&#34;namespace&#34;</span>:<span class=s2>&#34;default&#34;</span><span class=o>}</span>,<span class=s2>&#34;spec&#34;</span>:<span class=o>{</span><span class=s2>&#34;replicas&#34;</span>:1,<span class=s2>&#34;selector&#34;</span>:<span class=o>{</span><span class=s2>&#34;matchLabels&#34;</span>:<span class=o>{</span><span class=s2>&#34;app&#34;</span>:<span class=s2>&#34;postgres&#34;</span><span class=o>}}</span>,<span class=s2>&#34;template&#34;</span>:<span class=o>{</span><span class=s2>&#34;metadata&#34;</span>:<span class=o>{</span><span class=s2>&#34;labels&#34;</span>:<span class=o>{</span><span class=s2>&#34;app&#34;</span>:<span class=s2>&#34;postgres&#34;</span><span class=o>}}</span>,<span class=s2>&#34;spec&#34;</span>:<span class=o>{</span><span class=s2>&#34;containers&#34;</span>:[<span class=o>{</span><span class=s2>&#34;env&#34;</span>:[<span class=o>{</span><span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;POSTGRES_DB&#34;</span>,<span class=s2>&#34;valueFrom&#34;</span>:<span class=o>{</span><span class=s2>&#34;configMapKeyRef&#34;</span>:<span class=o>{</span><span class=s2>&#34;key&#34;</span>:<span class=s2>&#34;POSTGRES_DB&#34;</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;postgres-db-config&#34;</span><span class=o>}}}</span>,<span class=o>{</span><span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;POSTGRES_USER&#34;</span>,<span class=s2>&#34;valueFrom&#34;</span>:<span class=o>{</span><span class=s2>&#34;configMapKeyRef&#34;</span>:<span class=o>{</span><span class=s2>&#34;key&#34;</span>:<span class=s2>&#34;POSTGRES_USER&#34;</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;postgres-db-config&#34;</span><span class=o>}}}</span>,<span class=o>{</span><span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;POSTGRES_PASSWORD&#34;</span>,<span class=s2>&#34;valueFrom&#34;</span>:<span class=o>{</span><span class=s2>&#34;secretKeyRef&#34;</span>:<span class=o>{</span><span class=s2>&#34;key&#34;</span>:<span class=s2>&#34;POSTGRES_PASSWORD&#34;</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;postgres-db-secret&#34;</span><span class=o>}}}]</span>,<span class=s2>&#34;image&#34;</span>:<span class=s2>&#34;postgres:latest&#34;</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;postgres-container&#34;</span>,<span class=s2>&#34;ports&#34;</span>:[<span class=o>{</span><span class=s2>&#34;containerPort&#34;</span>:5432<span class=o>}]}]}}}}</span>
  creationTimestamp: <span class=s2>&#34;2025-01-21T07:43:21Z&#34;</span>
  generation: 1
  name: postgres-deployment
  namespace: default
  resourceVersion: <span class=s2>&#34;2828&#34;</span>
  uid: 5736306d-c0fa-4ad4-b0b0-fa28e80be607
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app: postgres
  strategy:
    rollingUpdate:
      maxSurge: 25%
      maxUnavailable: 25%
    <span class=nb>type</span>: RollingUpdate
  template:
    metadata:
      creationTimestamp: null
      labels:
        app: postgres
    spec:
      containers:
      - <span class=nb>env</span>:
        - name: POSTGRES_DB
          valueFrom:
            configMapKeyRef:
              key: POSTGRES_DB
              name: postgres-db-config
        - name: POSTGRES_USER
          valueFrom:
            configMapKeyRef:
              key: POSTGRES_USER
              name: postgres-db-config
        - name: POSTGRES_PASSWORD
          valueFrom:
            secretKeyRef:
              key: POSTGRES_PASSWORD
              name: postgres-db-secret
        image: postgres:latest
        imagePullPolicy: Always
        name: postgres-container
        ports:
        - containerPort: 5432
          protocol: TCP
        resources: <span class=o>{}</span>
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext: <span class=o>{}</span>
      terminationGracePeriodSeconds: 30
<span class=c># 省略了 status 字段</span>

<span class=nv>$ </span>vim dep.yaml
<span class=c># ConfigMap 和 Secret 的名称跟实际不一致，修改成正确的即可</span>

<span class=nv>$ </span>kubectl delete <span class=nt>-f</span> dep.yaml <span class=nt>--force</span> <span class=nt>--grace-period</span> 0
Warning: Immediate deletion does not <span class=nb>wait </span><span class=k>for </span>confirmation that the running resource has been terminated. The resource may <span class=k>continue </span>to run on the cluster indefinitely.
deployment.apps <span class=s2>&#34;postgres-deployment&#34;</span> force deleted

<span class=nv>$ </span>kubectl apply <span class=nt>-f</span> dep.yaml
deployment.apps/postgres-deployment created

<span class=nv>$ </span>kubectl get pod
NAME                                   READY   STATUS    RESTARTS   AGE
postgres-deployment-5c8cb5d6fc-v5c5s   1/1     Running   0          8s

<span class=nv>$ </span><span class=nb>cat </span>dep.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    deployment.kubernetes.io/revision: <span class=s2>&#34;1&#34;</span>
    kubectl.kubernetes.io/last-applied-configuration: |
      <span class=o>{</span><span class=s2>&#34;apiVersion&#34;</span>:<span class=s2>&#34;apps/v1&#34;</span>,<span class=s2>&#34;kind&#34;</span>:<span class=s2>&#34;Deployment&#34;</span>,<span class=s2>&#34;metadata&#34;</span>:<span class=o>{</span><span class=s2>&#34;annotations&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;postgres-deployment&#34;</span>,<span class=s2>&#34;namespace&#34;</span>:<span class=s2>&#34;default&#34;</span><span class=o>}</span>,<span class=s2>&#34;spec&#34;</span>:<span class=o>{</span><span class=s2>&#34;replicas&#34;</span>:1,<span class=s2>&#34;selector&#34;</span>:<span class=o>{</span><span class=s2>&#34;matchLabels&#34;</span>:<span class=o>{</span><span class=s2>&#34;app&#34;</span>:<span class=s2>&#34;postgres&#34;</span><span class=o>}}</span>,<span class=s2>&#34;template&#34;</span>:<span class=o>{</span><span class=s2>&#34;metadata&#34;</span>:<span class=o>{</span><span class=s2>&#34;labels&#34;</span>:<span class=o>{</span><span class=s2>&#34;app&#34;</span>:<span class=s2>&#34;postgres&#34;</span><span class=o>}}</span>,<span class=s2>&#34;spec&#34;</span>:<span class=o>{</span><span class=s2>&#34;containers&#34;</span>:[<span class=o>{</span><span class=s2>&#34;env&#34;</span>:[<span class=o>{</span><span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;POSTGRES_DB&#34;</span>,<span class=s2>&#34;valueFrom&#34;</span>:<span class=o>{</span><span class=s2>&#34;configMapKeyRef&#34;</span>:<span class=o>{</span><span class=s2>&#34;key&#34;</span>:<span class=s2>&#34;POSTGRES_DB&#34;</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;postgres-config&#34;</span><span class=o>}}}</span>,<span class=o>{</span><span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;POSTGRES_USER&#34;</span>,<span class=s2>&#34;valueFrom&#34;</span>:<span class=o>{</span><span class=s2>&#34;configMapKeyRef&#34;</span>:<span class=o>{</span><span class=s2>&#34;key&#34;</span>:<span class=s2>&#34;POSTGRES_USER&#34;</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;postgres-config&#34;</span><span class=o>}}}</span>,<span class=o>{</span><span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;POSTGRES_PASSWORD&#34;</span>,<span class=s2>&#34;valueFrom&#34;</span>:<span class=o>{</span><span class=s2>&#34;secretKeyRef&#34;</span>:<span class=o>{</span><span class=s2>&#34;key&#34;</span>:<span class=s2>&#34;POSTGRES_PASSWORD&#34;</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;postgres-secret&#34;</span><span class=o>}}}]</span>,<span class=s2>&#34;image&#34;</span>:<span class=s2>&#34;postgres:latest&#34;</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;postgres-container&#34;</span>,<span class=s2>&#34;ports&#34;</span>:[<span class=o>{</span><span class=s2>&#34;containerPort&#34;</span>:5432<span class=o>}]}]}}}}</span>
  creationTimestamp: <span class=s2>&#34;2025-01-21T07:43:21Z&#34;</span>
  generation: 1
  name: postgres-deployment
  namespace: default
  resourceVersion: <span class=s2>&#34;2828&#34;</span>
  uid: 5736306d-c0fa-4ad4-b0b0-fa28e80be607
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app: postgres
  strategy:
    rollingUpdate:
      maxSurge: 25%
      maxUnavailable: 25%
    <span class=nb>type</span>: RollingUpdate
  template:
    metadata:
      creationTimestamp: null
      labels:
        app: postgres
    spec:
      containers:
      - <span class=nb>env</span>:
        - name: POSTGRES_DB
          valueFrom:
            configMapKeyRef:
              key: POSTGRES_DB
              name: postgres-config
        - name: POSTGRES_USER
          valueFrom:
            configMapKeyRef:
              key: POSTGRES_USER
              name: postgres-config
        - name: POSTGRES_PASSWORD
          valueFrom:
            secretKeyRef:
              key: POSTGRES_PASSWORD
              name: postgres-secret
        image: postgres:latest
        imagePullPolicy: Always
        name: postgres-container
        ports:
        - containerPort: 5432
          protocol: TCP
        resources: <span class=o>{}</span>
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext: <span class=o>{}</span>
      terminationGracePeriodSeconds: 30</code></pre></div></div></div></div><div class=sect1><h2 id=_troubleshooting_deployment_issue_4>8. Troubleshooting - Deployment Issue 4</h2><div class=sectionbody><div class=paragraph><p><a href=https://killercoda.com/sachin/course/CKA/deployment-issue-4 target=_blank rel=noopener>Troubleshooting - Deployment Issue 4</a></p></div><div class=sidebarblock><div class=content><div class=paragraph><p><code>database-deployment</code> deployment pods are not running, fix that issue</p></div></div></div><div class=listingblock><div class=content><pre class="rouge highlight nowrap"><code data-lang=bash><span class=c># @author D瓜哥 · <a href=https://www.diguage.com target=_blank>https://www.diguage.com</a></span>

<span class=nv>$ </span>kubectl get pod
NAME                                 READY   STATUS    RESTARTS   AGE
database-deployment-9bffdf4c-pfnwc   0/1     Pending   0          39s

<span class=nv>$ </span>kubectl describe pod database-deployment-9bffdf4c-pfnwc
Name:             database-deployment-9bffdf4c-pfnwc
Namespace:        default
Priority:         0
Service Account:  default
Node:             &lt;none&gt;
Labels:           <span class=nv>app</span><span class=o>=</span>postgres
                  pod-template-hash<span class=o>=</span>9bffdf4c
Annotations:      &lt;none&gt;
Status:           Pending
IP:
IPs:              &lt;none&gt;
Controlled By:    ReplicaSet/database-deployment-9bffdf4c
Containers:
  postgres-container:
    Image:      postgres:latest
    Port:       5432/TCP
    Host Port:  0/TCP
    Environment:
      POSTGRES_DB:        mydatabase
      POSTGRES_USER:      myuser
      POSTGRES_PASSWORD:  &lt;<span class=nb>set </span>to the key <span class=s1>&#39;POSTGRES_PASSWORD&#39;</span> <span class=k>in </span>secret <span class=s1>&#39;postgres-secret&#39;</span><span class=o>&gt;</span>  Optional: <span class=nb>false
    </span>Mounts:
      /var/run/secrets/kubernetes.io/serviceaccount from kube-api-access-fzrkd <span class=o>(</span>ro<span class=o>)</span>
Conditions:
  Type           Status
  PodScheduled   False
Volumes:
  postgres-storage:
    Type:       PersistentVolumeClaim <span class=o>(</span>a reference to a PersistentVolumeClaim <span class=k>in </span>the same namespace<span class=o>)</span>
    ClaimName:  postgres-db-pvc
    ReadOnly:   <span class=nb>false
  </span>kube-api-access-fzrkd:
    Type:                    Projected <span class=o>(</span>a volume that contains injected data from multiple sources<span class=o>)</span>
    TokenExpirationSeconds:  3607
    ConfigMapName:           kube-root-ca.crt
    ConfigMapOptional:       &lt;nil&gt;
    DownwardAPI:             <span class=nb>true
</span>QoS Class:                   BestEffort
Node-Selectors:              &lt;none&gt;
Tolerations:                 node.kubernetes.io/not-ready:NoExecute <span class=nv>op</span><span class=o>=</span>Exists <span class=k>for </span>300s
                             node.kubernetes.io/unreachable:NoExecute <span class=nv>op</span><span class=o>=</span>Exists <span class=k>for </span>300s
Events:
  Type     Reason            Age   From               Message
  <span class=nt>----</span>     <span class=nt>------</span>            <span class=nt>----</span>  <span class=nt>----</span>               <span class=nt>-------</span>
  Warning  FailedScheduling  47s   default-scheduler  0/2 nodes are available: persistentvolumeclaim <span class=s2>&#34;postgres-db-pvc&#34;</span> not found. preemption: 0/2 nodes are available: 2 Preemption is not helpful <span class=k>for </span>scheduling.

<span class=nv>$ </span>kubectl get pvc
NAME           STATUS    VOLUME        CAPACITY   ACCESS MODES   STORAGECLASS   VOLUMEATTRIBUTESCLASS   AGE
postgres-pvc   Pending   postgres-pv   0                         standard       &lt;<span class=nb>unset</span><span class=o>&gt;</span>                 57s

<span class=nv>$ </span>kubectl get pvc postgres-pvc <span class=nt>-o</span> wide
NAME           STATUS    VOLUME        CAPACITY   ACCESS MODES   STORAGECLASS   VOLUMEATTRIBUTESCLASS   AGE   VOLUMEMODE
postgres-pvc   Pending   postgres-pv   0                         standard       &lt;<span class=nb>unset</span><span class=o>&gt;</span>                 71s   Filesystem

<span class=nv>$ </span>kubectl get pv <span class=nt>-o</span> wide
NAME          CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS      CLAIM   STORAGECLASS   VOLUMEATTRIBUTESCLASS   REASON   AGE   VOLUMEMODE
postgres-pv   100Mi      RWO            Retain           Available           standard       &lt;<span class=nb>unset</span><span class=o>&gt;</span>                          83s   Filesystem

<span class=nv>$ </span>kubectl get deployments.apps database-deployment <span class=nt>-o</span> yaml | <span class=nb>tee </span>dep.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    deployment.kubernetes.io/revision: <span class=s2>&#34;1&#34;</span>
    kubectl.kubernetes.io/last-applied-configuration: |
      <span class=o>{</span><span class=s2>&#34;apiVersion&#34;</span>:<span class=s2>&#34;apps/v1&#34;</span>,<span class=s2>&#34;kind&#34;</span>:<span class=s2>&#34;Deployment&#34;</span>,<span class=s2>&#34;metadata&#34;</span>:<span class=o>{</span><span class=s2>&#34;annotations&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;database-deployment&#34;</span>,<span class=s2>&#34;namespace&#34;</span>:<span class=s2>&#34;default&#34;</span><span class=o>}</span>,<span class=s2>&#34;spec&#34;</span>:<span class=o>{</span><span class=s2>&#34;replicas&#34;</span>:1,<span class=s2>&#34;selector&#34;</span>:<span class=o>{</span><span class=s2>&#34;matchLabels&#34;</span>:<span class=o>{</span><span class=s2>&#34;app&#34;</span>:<span class=s2>&#34;postgres&#34;</span><span class=o>}}</span>,<span class=s2>&#34;template&#34;</span>:<span class=o>{</span><span class=s2>&#34;metadata&#34;</span>:<span class=o>{</span><span class=s2>&#34;labels&#34;</span>:<span class=o>{</span><span class=s2>&#34;app&#34;</span>:<span class=s2>&#34;postgres&#34;</span><span class=o>}}</span>,<span class=s2>&#34;spec&#34;</span>:<span class=o>{</span><span class=s2>&#34;containers&#34;</span>:[<span class=o>{</span><span class=s2>&#34;env&#34;</span>:[<span class=o>{</span><span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;POSTGRES_DB&#34;</span>,<span class=s2>&#34;value&#34;</span>:<span class=s2>&#34;mydatabase&#34;</span><span class=o>}</span>,<span class=o>{</span><span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;POSTGRES_USER&#34;</span>,<span class=s2>&#34;value&#34;</span>:<span class=s2>&#34;myuser&#34;</span><span class=o>}</span>,<span class=o>{</span><span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;POSTGRES_PASSWORD&#34;</span>,<span class=s2>&#34;valueFrom&#34;</span>:<span class=o>{</span><span class=s2>&#34;secretKeyRef&#34;</span>:<span class=o>{</span><span class=s2>&#34;key&#34;</span>:<span class=s2>&#34;POSTGRES_PASSWORD&#34;</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;postgres-secret&#34;</span><span class=o>}}}]</span>,<span class=s2>&#34;image&#34;</span>:<span class=s2>&#34;postgres:latest&#34;</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;postgres-container&#34;</span>,<span class=s2>&#34;ports&#34;</span>:[<span class=o>{</span><span class=s2>&#34;containerPort&#34;</span>:5432<span class=o>}]}]</span>,<span class=s2>&#34;volumes&#34;</span>:[<span class=o>{</span><span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;postgres-storage&#34;</span>,<span class=s2>&#34;persistentVolumeClaim&#34;</span>:<span class=o>{</span><span class=s2>&#34;claimName&#34;</span>:<span class=s2>&#34;postgres-db-pvc&#34;</span><span class=o>}}]}}}}</span>
  creationTimestamp: <span class=s2>&#34;2025-01-21T07:53:15Z&#34;</span>
  generation: 1
  name: database-deployment
  namespace: default
  resourceVersion: <span class=s2>&#34;2331&#34;</span>
  uid: c22a499d-f568-4c60-a943-f748cb6a71f4
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app: postgres
  strategy:
    rollingUpdate:
      maxSurge: 25%
      maxUnavailable: 25%
    <span class=nb>type</span>: RollingUpdate
  template:
    metadata:
      creationTimestamp: null
      labels:
        app: postgres
    spec:
      containers:
      - <span class=nb>env</span>:
        - name: POSTGRES_DB
          value: mydatabase
        - name: POSTGRES_USER
          value: myuser
        - name: POSTGRES_PASSWORD
          valueFrom:
            secretKeyRef:
              key: POSTGRES_PASSWORD
              name: postgres-secret
        image: postgres:latest
        imagePullPolicy: Always
        name: postgres-container
        ports:
        - containerPort: 5432
          protocol: TCP
        resources: <span class=o>{}</span>
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext: <span class=o>{}</span>
      terminationGracePeriodSeconds: 30
      volumes:
      - name: postgres-storage
        persistentVolumeClaim:
          claimName: postgres-db-pvc
<span class=c>#省略 status 字段</span>

<span class=nv>$ </span><span class=nb>echo</span> <span class=s2>&#34;---&#34;</span> | <span class=nb>tee</span> <span class=nt>-a</span> dep.yaml
<span class=nt>---</span>

<span class=nv>$ </span>kubectl get pvc postgres-pvc <span class=nt>-o</span> yaml | <span class=nb>tee</span> <span class=nt>-a</span> dep.yaml
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  annotations:
    kubectl.kubernetes.io/last-applied-configuration: |
      <span class=o>{</span><span class=s2>&#34;apiVersion&#34;</span>:<span class=s2>&#34;v1&#34;</span>,<span class=s2>&#34;kind&#34;</span>:<span class=s2>&#34;PersistentVolumeClaim&#34;</span>,<span class=s2>&#34;metadata&#34;</span>:<span class=o>{</span><span class=s2>&#34;annotations&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;postgres-pvc&#34;</span>,<span class=s2>&#34;namespace&#34;</span>:<span class=s2>&#34;default&#34;</span><span class=o>}</span>,<span class=s2>&#34;spec&#34;</span>:<span class=o>{</span><span class=s2>&#34;accessModes&#34;</span>:[<span class=s2>&#34;ReadWriteMany&#34;</span><span class=o>]</span>,<span class=s2>&#34;resources&#34;</span>:<span class=o>{</span><span class=s2>&#34;requests&#34;</span>:<span class=o>{</span><span class=s2>&#34;storage&#34;</span>:<span class=s2>&#34;150Mi&#34;</span><span class=o>}}</span>,<span class=s2>&#34;storageClassName&#34;</span>:<span class=s2>&#34;standard&#34;</span>,<span class=s2>&#34;volumeName&#34;</span>:<span class=s2>&#34;postgres-pv&#34;</span><span class=o>}}</span>
  creationTimestamp: <span class=s2>&#34;2025-01-21T07:53:15Z&#34;</span>
  finalizers:
  - kubernetes.io/pvc-protection
  name: postgres-pvc
  namespace: default
  resourceVersion: <span class=s2>&#34;2316&#34;</span>
  uid: 7c662eb1-770b-47b3-9d20-0eedb7c4a597
spec:
  accessModes:
  - ReadWriteMany
  resources:
    requests:
      storage: 150Mi
  storageClassName: standard
  volumeMode: Filesystem
  volumeName: postgres-pv
status:
  phase: Pending

<span class=nv>$ </span>vim dep.yaml
<span class=c># 三个问题：</span>
<span class=c># 1、 Pod 中所使用的 PVC 名称不对</span>
<span class=c># 2、 PVC 和 PV 的 accessModes 字段不一致，修改成为 ReadWriteOnce</span>
<span class=c># 3、 PVC 的容量超过 PV，修改成 100Mi</span>

<span class=nv>$ </span>kubectl delete <span class=nt>-f</span> dep.yaml <span class=nt>--force</span> <span class=nt>--grace-period</span> 0
Warning: Immediate deletion does not <span class=nb>wait </span><span class=k>for </span>confirmation that the running resource has been terminated. The resource may <span class=k>continue </span>to run on the cluster indefinitely.
deployment.apps <span class=s2>&#34;database-deployment&#34;</span> force deleted
persistentvolumeclaim <span class=s2>&#34;postgres-pvc&#34;</span> force deleted

<span class=nv>$ </span>kubectl apply <span class=nt>-f</span> dep.yaml
deployment.apps/database-deployment created
persistentvolumeclaim/postgres-pvc created

<span class=nv>$ </span>kubectl get pvc
NAME           STATUS   VOLUME        CAPACITY   ACCESS MODES   STORAGECLASS   VOLUMEATTRIBUTESCLASS   AGE
postgres-pvc   Bound    postgres-pv   100Mi      RWO            standard       &lt;<span class=nb>unset</span><span class=o>&gt;</span>                 6s

<span class=nv>$ </span>kubectl get pod
NAME                                   READY   STATUS              RESTARTS   AGE
database-deployment-647c766bfd-6njck   0/1     ContainerCreating   0          14s

<span class=nv>$ </span>kubectl get pod
NAME                                   READY   STATUS    RESTARTS   AGE
database-deployment-647c766bfd-6njck   1/1     Running   0          20s

<span class=nv>$ </span><span class=nb>cat </span>dep.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    deployment.kubernetes.io/revision: <span class=s2>&#34;1&#34;</span>
    kubectl.kubernetes.io/last-applied-configuration: |
      <span class=o>{</span><span class=s2>&#34;apiVersion&#34;</span>:<span class=s2>&#34;apps/v1&#34;</span>,<span class=s2>&#34;kind&#34;</span>:<span class=s2>&#34;Deployment&#34;</span>,<span class=s2>&#34;metadata&#34;</span>:<span class=o>{</span><span class=s2>&#34;annotations&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;database-deployment&#34;</span>,<span class=s2>&#34;namespace&#34;</span>:<span class=s2>&#34;default&#34;</span><span class=o>}</span>,<span class=s2>&#34;spec&#34;</span>:<span class=o>{</span><span class=s2>&#34;replicas&#34;</span>:1,<span class=s2>&#34;selector&#34;</span>:<span class=o>{</span><span class=s2>&#34;matchLabels&#34;</span>:<span class=o>{</span><span class=s2>&#34;app&#34;</span>:<span class=s2>&#34;postgres&#34;</span><span class=o>}}</span>,<span class=s2>&#34;template&#34;</span>:<span class=o>{</span><span class=s2>&#34;metadata&#34;</span>:<span class=o>{</span><span class=s2>&#34;labels&#34;</span>:<span class=o>{</span><span class=s2>&#34;app&#34;</span>:<span class=s2>&#34;postgres&#34;</span><span class=o>}}</span>,<span class=s2>&#34;spec&#34;</span>:<span class=o>{</span><span class=s2>&#34;containers&#34;</span>:[<span class=o>{</span><span class=s2>&#34;env&#34;</span>:[<span class=o>{</span><span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;POSTGRES_DB&#34;</span>,<span class=s2>&#34;value&#34;</span>:<span class=s2>&#34;mydatabase&#34;</span><span class=o>}</span>,<span class=o>{</span><span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;POSTGRES_USER&#34;</span>,<span class=s2>&#34;value&#34;</span>:<span class=s2>&#34;myuser&#34;</span><span class=o>}</span>,<span class=o>{</span><span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;POSTGRES_PASSWORD&#34;</span>,<span class=s2>&#34;valueFrom&#34;</span>:<span class=o>{</span><span class=s2>&#34;secretKeyRef&#34;</span>:<span class=o>{</span><span class=s2>&#34;key&#34;</span>:<span class=s2>&#34;POSTGRES_PASSWORD&#34;</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;postgres-secret&#34;</span><span class=o>}}}]</span>,<span class=s2>&#34;image&#34;</span>:<span class=s2>&#34;postgres:latest&#34;</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;postgres-container&#34;</span>,<span class=s2>&#34;ports&#34;</span>:[<span class=o>{</span><span class=s2>&#34;containerPort&#34;</span>:5432<span class=o>}]}]</span>,<span class=s2>&#34;volumes&#34;</span>:[<span class=o>{</span><span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;postgres-storage&#34;</span>,<span class=s2>&#34;persistentVolumeClaim&#34;</span>:<span class=o>{</span><span class=s2>&#34;claimName&#34;</span>:<span class=s2>&#34;postgres-pvc&#34;</span><span class=o>}}]}}}}</span>
  creationTimestamp: <span class=s2>&#34;2025-01-21T07:53:15Z&#34;</span>
  generation: 1
  name: database-deployment
  namespace: default
  resourceVersion: <span class=s2>&#34;2331&#34;</span>
  uid: c22a499d-f568-4c60-a943-f748cb6a71f4
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app: postgres
  strategy:
    rollingUpdate:
      maxSurge: 25%
      maxUnavailable: 25%
    <span class=nb>type</span>: RollingUpdate
  template:
    metadata:
      creationTimestamp: null
      labels:
        app: postgres
    spec:
      containers:
      - <span class=nb>env</span>:
        - name: POSTGRES_DB
          value: mydatabase
        - name: POSTGRES_USER
          value: myuser
        - name: POSTGRES_PASSWORD
          valueFrom:
            secretKeyRef:
              key: POSTGRES_PASSWORD
              name: postgres-secret
        image: postgres:latest
        imagePullPolicy: Always
        name: postgres-container
        ports:
        - containerPort: 5432
          protocol: TCP
        resources: <span class=o>{}</span>
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext: <span class=o>{}</span>
      terminationGracePeriodSeconds: 30
      volumes:
      - name: postgres-storage
        persistentVolumeClaim:
          claimName: postgres-pvc
<span class=nt>---</span>
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  annotations:
    kubectl.kubernetes.io/last-applied-configuration: |
      <span class=o>{</span><span class=s2>&#34;apiVersion&#34;</span>:<span class=s2>&#34;v1&#34;</span>,<span class=s2>&#34;kind&#34;</span>:<span class=s2>&#34;PersistentVolumeClaim&#34;</span>,<span class=s2>&#34;metadata&#34;</span>:<span class=o>{</span><span class=s2>&#34;annotations&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;postgres-pvc&#34;</span>,<span class=s2>&#34;namespace&#34;</span>:<span class=s2>&#34;default&#34;</span><span class=o>}</span>,<span class=s2>&#34;spec&#34;</span>:<span class=o>{</span><span class=s2>&#34;accessModes&#34;</span>:[<span class=s2>&#34;ReadWriteMany&#34;</span><span class=o>]</span>,<span class=s2>&#34;resources&#34;</span>:<span class=o>{</span><span class=s2>&#34;requests&#34;</span>:<span class=o>{</span><span class=s2>&#34;storage&#34;</span>:<span class=s2>&#34;150Mi&#34;</span><span class=o>}}</span>,<span class=s2>&#34;storageClassName&#34;</span>:<span class=s2>&#34;standard&#34;</span>,<span class=s2>&#34;volumeName&#34;</span>:<span class=s2>&#34;postgres-pv&#34;</span><span class=o>}}</span>
  creationTimestamp: <span class=s2>&#34;2025-01-21T07:53:15Z&#34;</span>
  finalizers:
  - kubernetes.io/pvc-protection
  name: postgres-pvc
  namespace: default
  resourceVersion: <span class=s2>&#34;2316&#34;</span>
  uid: 7c662eb1-770b-47b3-9d20-0eedb7c4a597
spec:
  accessModes:
  - ReadWriteOnce
  resources:
    requests:
      storage: 100Mi
  storageClassName: standard
  volumeMode: Filesystem
  volumeName: postgres-pv</code></pre></div></div></div></div><div class=sect1><h2 id=_troubleshooting_deployment_not_up_to_date>9. Troubleshooting - Deployment Not UP-TO-DATE</h2><div class=sectionbody><div class=paragraph><p><a href=https://killercoda.com/sachin/course/CKA/deployment-rollout-resume target=_blank rel=noopener>Troubleshooting - Deployment Not UP-TO-DATE</a></p></div><div class=sidebarblock><div class=content><div class=paragraph><p><code>stream-deployment</code> deployment is not up to date. observed <code>0</code> under the UP-TO-DATE it should be <code>1</code> , Troubleshoot, fix the issue and make sure deployment is up to date.</p></div></div></div><div class=listingblock><div class=content><pre class="rouge highlight nowrap"><code data-lang=bash><span class=c># @author D瓜哥 · <a href=https://www.diguage.com target=_blank>https://www.diguage.com</a></span>

<span class=nv>$ </span>kubectl get deployments.apps
NAME                READY   UP-TO-DATE   AVAILABLE   AGE
stream-deployment   0/0     0            0           67s

<span class=nv>$ </span>kubectl get deployments.apps stream-deployment <span class=nt>-o</span> yaml | <span class=nb>tee </span>dep.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    deployment.kubernetes.io/revision: <span class=s2>&#34;1&#34;</span>
  creationTimestamp: <span class=s2>&#34;2025-01-21T08:08:41Z&#34;</span>
  generation: 1
  labels:
    app: stream-deployment
  name: stream-deployment
  namespace: default
  resourceVersion: <span class=s2>&#34;2055&#34;</span>
  uid: f6054b5f-dc99-46d1-9956-fe096b9a8d40
spec:
  progressDeadlineSeconds: 600
  replicas: 0
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app: stream-deployment
  strategy:
    rollingUpdate:
      maxSurge: 25%
      maxUnavailable: 25%
    <span class=nb>type</span>: RollingUpdate
  template:
    metadata:
      creationTimestamp: null
      labels:
        app: stream-deployment
    spec:
      containers:
      - image: redis:7.2.1
        imagePullPolicy: IfNotPresent
        name: redis
        resources: <span class=o>{}</span>
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext: <span class=o>{}</span>
      terminationGracePeriodSeconds: 30
<span class=c># 省略 status 字段</span>

<span class=nv>$ </span>kubectl scale deployment stream-deployment <span class=nt>--replicas</span> 1
deployment.apps/stream-deployment scaled
<span class=c># Deployment 的 replicas 为 0，扩展为 0 即可。</span></code></pre></div></div></div></div></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/kubernetes/ rel=tag>Kubernetes</a></li><li class=tags__item><a class="tags__link btn" href=/tags/linux/ rel=tag>Linux</a></li></ul></div></footer></article></main><div class=clearfix><h3>看在D瓜哥码字的辛苦上，请友情支持一下，D瓜哥感激不尽，😜</h3><table><tr><td><img alt=微信打赏码 src=/images/wxpay.jpg></td><td><img alt=支付宝打赏码 src=/images/alipay.png></td></tr></table></div><br><div class=clearfix><h3>欢迎关注D瓜哥的微信公众号，在公众号可以获取我的微信二维码：</h3><img alt=微信公众号 src=/images/wx-jikerizhi.jpg></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><strong>公众号的微信号是: <code>jikerizhi</code></strong>。如果图片加载不出来，可以直接通过搜索公众号的微信号来查找D瓜哥的公众号。</td></tr></tbody></table></div><div class="authorbox clearfix"><figure class=authorbox__avatar><a target=_blank href=/about/><img alt="D瓜哥 avatar" src=/images/avatar.jpg class=avatar height=110 width=110></a></figure><div class=authorbox__header><span class=authorbox__name>关于 D瓜哥</span></div><div class=authorbox__description>厨艺界最好的码农，挨踢界最棒的厨师。<ul><li><a target=_blank href=https://wordpress.diguage.com/>旧版“地瓜哥”博客网</a></li><li><a target=_blank href=https://notes.diguage.com/mysql/>MySQL 学习笔记<sup>Alpha</sup></a></li><li><a target=_blank href=https://diguage.github.io/jdk-source-analysis/>JDK 源码分析<sup>Alpha</sup></a></li></ul></div></div><nav class="pager flex"><div class="pager__item pager__item--prev"><a class=pager__link href=/post/killercoda-cka-troubleshooting-1/ rel=prev><span class=pager__subtitle>«&#8201;上一篇</span><p class=pager__title>killercoda CKA：Troubleshooting - 1</p></a></div><div class="pager__item pager__item--next"><a class=pager__link href=/post/killercoda-cka-troubleshooting-3/ rel=next><span class=pager__subtitle>下一篇&#8201;»</span><p class=pager__title>killercoda CKA：Troubleshooting - 3</p></a></div></nav><section class=comments><div id=SOHUCS sid=/post/killercoda-cka-troubleshooting-2/></div><script type=text/javascript>(function(){if(window.location.hostname==="localhost")return;var n,e="cyuuTeBp3",t="prod_2906c47c31e735e0ed518282fec489a6",s=window.innerWidth||document.documentElement.clientWidth;s<960?window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id='+e+"&conf="+t+'"><\/script>'):(n=function(e,t){var s=document.getElementsByTagName("head")[0]||document.head||document.documentElement,n=document.createElement("script");n.setAttribute("type","text/javascript"),n.setAttribute("charset","UTF-8"),n.setAttribute("src",e),typeof t=="function"&&(window.attachEvent?n.onreadystatechange=function(){var e=n.readyState;(e==="loaded"||e==="complete")&&(n.onreadystatechange=null,t())}:n.onload=t),s.appendChild(n)},n("https://changyan.sohu.com/upload/changyan.js",function(){window.changyan.api.config({appid:e,conf:t})}))})()</script></section></div><aside class=sidebar><div class="widget-search widget"><form class=widget-search__form role=search method=get action=https://google.com/search><label><input class=widget-search__field type=search placeholder=搜索… name=q aria-label=搜索…>
</label><input class=widget-search__submit type=submit value=Search>
<input type=hidden name=sitesearch value=https://www.diguage.com/></form></div><div class="widget-wechat widget"><h4 class=widget__title>微信公众号</h4><img alt=微信公众号 class=center src=/images/wx-jikerizhi-qrcode.jpg></div><div class="widget-wechat widget"><h4 class=widget__title>知识星球</h4><img alt=微信公众号 class=center src=/images/zhishixingqiu.png></div><div class="widget-recent widget"><h4 class=widget__title>近期文章</h4><div class=widget__content><ul class=widget__list><li class=widget__item><a class=widget__link href=/post/spring-boot-startup-process-overview/>Spring Boot 启动流程概述</a></li><li class=widget__item><a class=widget__link href=/post/redis-core-data-structure-4/>Redis 核心数据结构（四）</a></li><li class=widget__item><a class=widget__link href=/post/redis-core-data-structure-3/>Redis 核心数据结构（三）</a></li><li class=widget__item><a class=widget__link href=/post/algorithm-pattern-subsets/>算法模式：子集</a></li><li class=widget__item><a class=widget__link href=/post/algorithm-pattern-backtracking/>算法模式：回溯</a></li><li class=widget__item><a class=widget__link href=/post/algorithm-pattern-transform-and-conquer/>算法模式：变治法</a></li><li class=widget__item><a class=widget__link href=/post/algorithm-pattern-divide-and-conquer/>算法模式：分治法</a></li><li class=widget__item><a class=widget__link href=/post/algorithm-pattern-decrease-and-conquer/>算法模式：减治法</a></li><li class=widget__item><a class=widget__link href=/post/algorithm-pattern-topological-sort/>算法模式：拓扑排序</a></li><li class=widget__item><a class=widget__link href=/post/algorithm-pattern-union-find/>算法模式：并查集</a></li><li class=widget__item><a class=widget__link href=/post/algorithm-pattern-trie/>算法模式：前缀树</a></li><li class=widget__item><a class=widget__link href=/post/algorithm-pattern-depth-first-search/>算法模式：深度优先搜索</a></li><li class=widget__item><a class=widget__link href=/post/algorithm-pattern-breadth-first-search/>算法模式：广度优先搜索</a></li><li class=widget__item><a class=widget__link href=/post/algorithm-pattern-k-way-merge/>算法模式：多路归并</a></li><li class=widget__item><a class=widget__link href=/post/algorithm-pattern-two-heaps/>算法模式：双堆</a></li><li class=widget__item><a class=widget__link href=/post/algorithm-pattern-cyclic-sort/>算法模式：循环排序</a></li><li class=widget__item><a class=widget__link href=/post/algorithm-pattern-quickselect/>算法模式：快速选择</a></li><li class=widget__item><a class=widget__link href=/post/algorithm-pattern-top-k-elements/>算法模式：Top K 问题</a></li><li class=widget__item><a class=widget__link href=/post/algorithm-pattern-monotonic-stack/>算法模式：单调栈</a></li><li class=widget__item><a class=widget__link href=/post/algorithm-pattern-sliding-window/>算法模式：滑动窗口</a></li></ul></div></div><div class="widget-categories widget"><h4 class=widget__title>分类</h4><div class=widget__content><ul class=widget__list><li class=widget__item><a class=widget__link href=/categories/%E4%B8%AA%E4%BA%BA%E6%88%90%E9%95%BF/>个人成长</a></li><li class=widget__item><a class=widget__link href=/categories/%E5%88%86%E5%B8%83%E5%BC%8F/>分布式</a></li><li class=widget__item><a class=widget__link href=/categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/>开发工具</a></li><li class=widget__item><a class=widget__link href=/categories/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/>性能优化</a></li><li class=widget__item><a class=widget__link href=/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/>操作系统</a></li><li class=widget__item><a class=widget__link href=/categories/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/>数据存储</a></li><li class=widget__item><a class=widget__link href=/categories/%E6%96%87%E5%AD%A6/>文学</a></li><li class=widget__item><a class=widget__link href=/categories/%E6%96%B9%E6%B3%95%E8%AE%BA/>方法论</a></li><li class=widget__item><a class=widget__link href=/categories/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/>程序设计</a></li><li class=widget__item><a class=widget__link href=/categories/%E7%AE%97%E6%B3%95/>算法</a></li><li class=widget__item><a class=widget__link href=/categories/%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84/>系统架构</a></li><li class=widget__item><a class=widget__link href=/categories/%E7%BB%8F%E6%B5%8E%E9%87%91%E8%9E%8D/>经济金融</a></li><li class=widget__item><a class=widget__link href=/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/>编程语言</a></li><li class=widget__item><a class=widget__link href=/categories/%E7%BD%91%E7%BB%9C/>网络</a></li><li class=widget__item><a class=widget__link href=/categories/%E8%81%8C%E4%B8%9A%E5%8F%91%E5%B1%95/>职业发展</a></li><li class=widget__item><a class=widget__link href=/categories/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B/>软件工程</a></li><li class=widget__item><a class=widget__link href=/categories/%E9%80%B8%E9%97%BB%E8%B6%A3%E4%BA%8B/>逸闻趣事</a></li><li class=widget__item><a class=widget__link href=/categories/%E9%98%85%E8%AF%BB%E6%91%98%E8%A6%81/>阅读摘要</a></li></ul></div></div><div class="widget-taglist widget"><h4 class=widget__title>标签</h4><div class=widget__content><a class="widget-taglist__link widget__link btn" href=/tags/gc/ title=GC>GC (9)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/http/ title=HTTP>HTTP (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/java/ title=Java>Java (64)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/jvm/ title=JVM>JVM (2)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/kpi/ title=KPI>KPI (4)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/kubernetes/ title=Kubernetes>Kubernetes (10)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/linux/ title=Linux>Linux (12)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/okr/ title=OKR>OKR (5)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/redis/ title=Redis>Redis (2)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/shell/ title=Shell>Shell (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/spring/ title=Spring>Spring (26)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/tcp/ title=TCP>TCP (2)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/udp/ title=UDP>UDP (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/zookeeper/ title=ZooKeeper>ZooKeeper (2)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E4%B8%AA%E4%BA%BA%E6%8F%90%E5%8D%87/ title=个人提升>个人提升 (10)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E4%B9%A6%E7%B1%8D/ title=书籍>书籍 (15)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E4%BA%A7%E5%93%81/ title=产品>产品 (7)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E5%80%BA%E5%88%B8/ title=债券>债券 (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E5%88%86%E5%B8%83%E5%BC%8F/ title=分布式>分布式 (15)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E5%88%86%E6%B2%BB/ title=分治>分治 (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/ title=动态规划>动态规划 (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E5%9B%A2%E9%98%9F%E5%BB%BA%E8%AE%BE/ title=团队建设>团队建设 (6)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E5%9B%A2%E9%98%9F%E6%96%87%E5%8C%96/ title=团队文化>团队文化 (4)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E5%9B%BE/ title=图>图 (7)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E5%9F%BA%E9%87%91/ title=基金>基金 (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E5%A0%86/ title=堆>堆 (3)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E5%AD%98%E5%82%A8/ title=存储>存储 (6)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E5%B7%A5%E4%BD%9C%E6%96%B9%E6%B3%95/ title=工作方法>工作方法 (5)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E5%B9%B6%E5%8F%91/ title=并发>并发 (3)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E5%BA%8F%E5%88%97%E5%8C%96/ title=序列化>序列化 (10)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/ title=微服务>微服务 (17)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E5%BF%83%E7%90%86%E5%AD%A6/ title=心理学>心理学 (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/ title=性能测试>性能测试 (4)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E6%8A%95%E8%B5%84%E7%90%86%E8%B4%A2/ title=投资理财>投资理财 (5)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/ title=数据库>数据库 (10)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/ title=数据结构>数据结构 (4)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E6%95%B0%E7%BB%84/ title=数组>数组 (13)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E6%96%B9%E6%B3%95%E8%AE%BA/ title=方法论>方法论 (13)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E6%97%85%E8%A1%8C/ title=旅行>旅行 (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/ title=最佳实践>最佳实践 (10)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E6%9E%B6%E6%9E%84/ title=架构>架构 (44)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E6%A0%88/ title=栈>栈 (3)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E6%A0%91/ title=树>树 (11)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E6%B2%9F%E9%80%9A%E6%8A%80%E5%B7%A7/ title=沟通技巧>沟通技巧 (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/ title=源码分析>源码分析 (8)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E7%90%86%E8%B4%A2/ title=理财>理财 (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E7%94%9F%E6%B4%BB/ title=生活>生活 (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E7%AC%94%E8%AE%B0/ title=笔记>笔记 (5)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E7%AE%97%E6%B3%95/ title=算法>算法 (8)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E7%AE%97%E6%B3%95%E6%A8%A1%E5%BC%8F/ title=算法模式>算法模式 (23)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E7%BB%8F%E6%B5%8E/ title=经济>经济 (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E7%BC%96%E7%A0%81/ title=编码>编码 (3)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E7%BD%91%E7%BB%9C/ title=网络>网络 (2)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E7%BF%BB%E8%AF%91/ title=翻译>翻译 (7)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E8%82%A1%E7%A5%A8/ title=股票>股票 (5)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E8%84%91%E5%9B%BE/ title=脑图>脑图 (5)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E8%8A%82%E6%97%A5/ title=节日>节日 (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E8%8B%B1%E8%AF%AD/ title=英语>英语 (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/ title=虚拟机>虚拟机 (9)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E8%AE%BA%E6%96%87/ title=论文>论文 (2)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E8%AE%BE%E8%AE%A1/ title=设计>设计 (36)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/ title=设计模式>设计模式 (3)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E8%AF%97%E6%AD%8C/ title=诗歌>诗歌 (2)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E8%AF%BB%E4%B9%A6/ title=读书>读书 (5)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E9%80%92%E5%BD%92/ title=递归>递归 (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E9%87%91%E8%9E%8D/ title=金融>金融 (5)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E9%93%BE%E8%A1%A8/ title=链表>链表 (5)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/ title=面向对象>面向对象 (5)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/ title=领域驱动设计>领域驱动设计 (5)</a></div></div><div class="widget-social widget"><h4 class="widget-social__title widget__title">社交</h4><div class="widget-social__content widget__content"><div class="widget-social__item widget__item"><a class="widget-social__link widget__link btn" title=Twitter rel="noopener noreferrer" href=https://twitter.com/diguage target=_blank><svg class="widget-social__link-icon icon icon-twitter" width="24" height="24" viewBox="0 0 384 312"><path d="m384 36.9c-14.1 6.3-29.3 10.5-45.2 12.4 16.3-9.7 28.8-25.2 34.6-43.6-15.2 9-32.1 15.6-50 19.1-14.4-15.2-34.9-24.8-57.5-24.8-43.5.0-78.8 35.3-78.8 78.8.0 6.2.7 12.2 2 17.9-65.5-3.3-123.5-34.6-162.4-82.3C20 26 16.1 39.6 16.1 54c0 27.3 13.9 51.4 35 65.6-12.9-.4-25.1-4-35.7-9.9v1c0 38.2 27.2 70 63.2 77.2-6.6 1.8-13.6 2.8-20.8 2.8-5.1.0-10-.5-14.8-1.4 10 31.3 39.1 54.1 73.6 54.7-27 21.1-60.9 33.7-97.8 33.7-6.4.0-12.6-.4-18.8-1.1C34.9 299 76.3 312 120.8 312c144.9.0 224.1-120 224.1-224.1.0-3.4-.1-6.8-.2-10.2 15.4-11.1 28.7-25 39.3-40.8z"/></svg>
<span>Twitter</span></a></div><div class="widget-social__item widget__item"><a class="widget-social__link widget__link btn" title=GitHub rel="noopener noreferrer" href=https://github.com/diguage target=_blank><svg class="widget-social__link-icon icon icon-github" width="24" height="24" viewBox="0 0 384 374"><path d="m192 0C85.9.0.0 85.8.0 191.7c0 84.7 55 156.6 131.3 181.9 9.6 1.8 13.1-4.2 13.1-9.2.0-4.6-.2-16.6-.3-32.6-53.4 11.6-64.7-25.7-64.7-25.7-8.7-22.1-21.3-28-21.3-28-17.4-11.9 1.3-11.6 1.3-11.6 19.3 1.4 29.4 19.8 29.4 19.8 17.1 29.3 44.9 20.8 55.9 15.9 1.7-12.4 6.7-20.8 12.2-25.6-42.6-4.8-87.5-21.3-87.5-94.8.0-20.9 7.5-38 19.8-51.4-2-4.9-8.6-24.3 1.9-50.7.0.0 16.1-5.2 52.8 19.7 15.3-4.2 31.7-6.4 48.1-6.5 16.3.1 32.7 2.2 48.1 6.5 36.7-24.8 52.8-19.7 52.8-19.7 10.5 26.4 3.9 45.9 1.9 50.7 12.3 13.4 19.7 30.5 19.7 51.4.0 73.7-44.9 89.9-87.7 94.6 6.9 5.9 13 17.6 13 35.5.0 25.6-.2 46.3-.2 52.6.0 5.1 3.5 11.1 13.2 9.2C329 348.2 384 276.4 384 191.7 384 85.8 298 0 192 0z"/></svg>
<span>GitHub</span></a></div><div class="widget-social__item widget__item"><a class="widget-social__link widget__link btn" title=Email href=mailto:leejun119@gmail.com><svg class="widget-social__link-icon icon icon-mail" width="24" height="24" viewBox="0 0 416 288"><path d="m0 16v256 16h16 384 16v-16V16 0h-16H16 0zm347 16-139 92.5L69 32zM199 157.5l9 5.5 9-5.5L384 46v210H32V46z"/></svg>
<span>leejun119@gmail.com</span></a></div></div></div></aside></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 "地瓜哥"博客网.
<span class=footer__copyright-credits>基于 <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> 引擎和 <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> 主题</span>
<span><a href=https://beian.miit.gov.cn/ target=_target>京ICP备14046450号-4</a></span></div></div></footer></div><script async defer src=/js/menu.js></script><script type=text/x-mathjax-config>
	MathJax.Hub.Config({
	  messageStyle: "none",
	  tex2jax: {
		inlineMath: [["\\(", "\\)"]],
		displayMath: [["\\[", "\\]"]],
		ignoreClass: "nostem|nolatexmath"
	  },
	  asciimath2jax: {
		delimiters: [["\\$", "\\$"]],
		ignoreClass: "nostem|noasciimath"
	  },
	  TeX: { equationNumbers: { autoNumber: "none" } }
	})
	MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
	  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
		if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains("stemblock")) {
		  data.math.root.display = "block"
		}
		return data
	  })
	})
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-MML-AM_HTMLorMML" async></script></body></html>