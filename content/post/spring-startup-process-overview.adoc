---
title: "Spring å¯åŠ¨æµç¨‹æ¦‚è¿°"
date: 2020-06-13T00:31:25+08:00
draft: false
keywords: ["Java","Spring"]
tags: ["Java","è®¾è®¡","æ¶æ„"]
categories: ["Java","ç¨‹åºè®¾è®¡"]
thumbnail: "images/spring-framework/spring-logo.jpg"

weight: 1

# You can also close(false) or open(true) something for this content.
# P.S. comment can only be closed
# comment: false
# toc: true
---

:source-highlighter: pygments
:pygments-style: monokai
:pygments-linenums-mode: table
:source_attr: indent=0,subs="attributes,verbatim,quotes,macros"
:image_attr: align=center,width=100%
:icons: font

å¯¹äº Spring å¯åŠ¨æµç¨‹å’Œ Bean çš„ç”Ÿå‘½å‘¨æœŸï¼Œæ€»æœ‰ä¸€äº›å°åœ°æ–¹æçš„ä¸æ˜¯å¾ˆæ¸…æ¥šï¼Œå¹²è„†ç›´æ¥é€šè¿‡ä¿®æ”¹ä»£ç å¢åŠ æ—¥å¿—è¾“å‡ºï¼Œä½¿ç”¨æ–­ç‚¹å•æ­¥è°ƒè¯•ï¼ŒæŠŠæ•´ä¸ªæµç¨‹æ‹é¡ºäº†ä¸€ç‚¹ç‚¹çš„ã€‚

é™¤äº†åŠ è½½é…ç½®æ–‡ä»¶æˆ–è€…åŸºç¡€é…ç½®ç±»å¤–ï¼ŒSpring çš„å¯åŠ¨è¿‡ç¨‹å‡ ä¹éƒ½è¢«å°è£…åœ¨ `AbstractApplicationContext#refresh` æ–¹æ³•ä¸­ï¼Œå¯ä»¥è¯´å¼„æ¸…æ¥šäº†è¿™ä¸ªæ–¹æ³•çš„æ‰§è¡Œè¿‡ç¨‹ï¼Œå°±æ‘¸æ¸…æ¥šäº† Spring å¯åŠ¨å…¨æµç¨‹ï¼Œä¸‹é¢çš„æµç¨‹åˆ†æä¹Ÿæ˜¯ä»¥è¿™ä¸ªæ–¹æ³•ä¸ºéª¨æ¶æ¥å±•å¼€çš„ã€‚

== æµç¨‹æ¦‚è¦

ä¸‹é¢å®Œæ•´æµç¨‹æœ‰äº›å¤ªå¤æ‚ï¼Œæ‰€ä»¥ï¼Œæç‚¼ä¸€ä¸ªç®€è¦çš„è¿‡ç¨‹ï¼Œæ–¹ä¾¿ç³Šå¼„é¢è¯•å®˜ï¼Œå“ˆå“ˆå“ˆğŸ˜†

. åˆ›å»ºå®¹å™¨ï¼Œè¯»å– `applicationContext.register(Config.class)` æŒ‡å®šçš„é…ç½®ã€‚
. å‡†å¤‡ `BeanFactory`ï¼Œæ³¨å†Œå®¹å™¨æœ¬èº«å’Œ `BeanFactory` å®ä¾‹ï¼Œä»¥åŠæ³¨å†Œç¯å¢ƒé…ç½®ä¿¡æ¯ç­‰ã€‚
. æ‰§è¡Œ `BeanDefinitionRegistryPostProcessor#postProcessBeanDefinitionRegistry` æ³¨å†Œ `BeanDefinition`ã€‚æœ‰ä¸‰ç‚¹éœ€è¦æ³¨æ„ï¼š
.. ç›®å‰åªæœ‰ä¸€ä¸ª `ConfigurationClassPostProcessor` å®ç°ç±»ï¼ŒSpring ä¸­å¤§é‡çš„ Bean éƒ½æ˜¯åœ¨è¿™ä¸€æ­¥è¢«è¯¥ç±»æ³¨å†Œåˆ°å®¹å™¨ä¸­çš„ã€‚
.. æ‰§è¡Œé¡ºåºæ˜¯ â‘  `PriorityOrdered` â‘¡ `Ordered` â‘¢ æ™®é€šçš„é¡ºåºæ¥æ‰§è¡Œ
.. åœ¨æ‰§è¡Œä¸Šä¸€æ­¥æ˜¯ï¼Œå¦‚æœå‘ç°æ³¨å†Œäº† `BeanDefinitionRegistryPostProcessor` ç±»å‹çš„ Beanï¼Œå°±ä¼šåœ¨å¾ªç¯é‡Œç»§ç»­è°ƒç”¨ `postProcessBeanDefinitionRegistry` æ–¹æ³•ã€‚MyBATIS å’Œ Spring æ•´åˆçš„ `MapperScannerConfigurer` ç±»å°±æ˜¯åœ¨è¿™ä¸€æ­¥æ‰§è¡Œçš„ã€‚
. æ‰§è¡Œ `BeanFactoryPostProcessor#postProcessBeanFactory` æ–¹æ³•ã€‚ç›®å‰åªæœ‰ä¸€ä¸ª `ConfigurationClassPostProcessor` å®ç°ç±»ã€‚
. æ³¨å†Œ `CommonAnnotationBeanPostProcessor` å’Œ `AutowiredAnnotationBeanPostProcessor` ä¸º `BeanPostProcessor`ã€‚
. æ³¨å†Œ `ApplicationEventMulticaster`ï¼Œç”¨äºå¹¿æ’­äº‹ä»¶çš„ã€‚
. æ³¨å†Œ `ApplicationListener`
. é¢„åŠ è½½ä»¥åŠæ³¨å†Œæ‰€æœ‰éæ‡’åŠ è½½çš„ Bean


== å®Œæ•´å¯åŠ¨æµç¨‹

. è°ƒç”¨ `prepareRefresh()` æ–¹æ³•ï¼Œåˆå§‹åŒ–å±æ€§æº(property source)é…ç½®ã€‚
. è°ƒç”¨ `obtainFreshBeanFactory()` è·å¾— `ConfigurableListableBeanFactory` å¯¹è±¡ã€‚
. è°ƒç”¨ `prepareBeanFactory`ï¼Œå‡†å¤‡ `BeanFactory`ï¼Œæ·»åŠ å¿…è¦çš„ Beanï¼›æ·»åŠ  `ApplicationContextAwareProcessor`ã€`ApplicationListenerDetector` å¤„ç†å™¨ï¼›æ³¨å†Œç¯å¢ƒç›¸å…³çš„ Beanã€‚
. ä¸‹é¢é€šè¿‡ `AbstractApplicationContext#invokeBeanFactoryPostProcessors` æ–¹æ³•ï¼Œå¼€å§‹æ‰§è¡Œ `BeanDefinitionRegistryPostProcessor` å’Œ `BeanFactoryPostProcessor` ç›¸å…³çš„æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•æµç¨‹èµ·å§‹ä¹Ÿå¾ˆç®€å•ï¼š
+
ç›®å‰ï¼Œé™¤äº†ç”¨æˆ·è‡ªå®šä¹‰çš„ `BeanDefinitionRegistryPostProcessor` å’Œ `BeanFactoryPostProcessor` å¤–ï¼ŒSpring å†…ç½®çš„ï¼Œåªæœ‰ `ConfigurationClassPostProcessor` ä¸€ä¸ªç±»ã€‚æ‰€ä»¥ï¼ŒæŠŠè¿™ä¸ªç±»çš„å®ç°æ‘¸æ¸…æ¥šäº†ï¼Œ`AbstractApplicationContext#invokeBeanFactoryPostProcessors` å°±å¯ä»¥è·³è¿‡äº†ã€‚
+
.. é¦–å…ˆï¼Œæ‰§è¡Œ `BeanDefinitionRegistryPostProcessor#postProcessBeanDefinitionRegistry` æ–¹æ³•ï¼Œé¡ºåºå¦‚ä¸‹ï¼š
... ç”¨æˆ·æ‰‹åŠ¨æ·»åŠ çš„ `BeanDefinitionRegistryPostProcessor`ï¼›
... å®ç° `PriorityOrdered` æ¥å£çš„ `BeanDefinitionRegistryPostProcessor`ï¼›
... å®ç° `Ordered` æ¥å£çš„ `BeanDefinitionRegistryPostProcessor`ï¼›
... æ™®é€š `BeanDefinitionRegistryPostProcessor`ï¼Œåªè¦å‘ç°æœ‰æ–°åŠ å…¥çš„ï¼Œå°±å¾ªç¯è°ƒç”¨ã€‚
.. ç„¶åï¼Œæ‰§è¡Œ `BeanFactoryPostProcessor#postProcessBeanFactory` æ–¹æ³•ã€‚é¡ºåºå¦‚ä¸‹ï¼š
... å®ç° `BeanDefinitionRegistryPostProcessor` æ¥å£çš„ç±»ï¼›
... å®ç° `BeanFactoryPostProcessor` æ¥å£çš„ç±»ã€‚
. å…ˆæ‰§è¡Œç”¨æˆ·æ‰‹åŠ¨æ·»åŠ çš„ `BeanDefinitionRegistryPostProcessor#postProcessBeanDefinitionRegistry(DefaultListableBeanFactory)`
+
å…³äº `BeanDefinitionRegistryPostProcessor` çš„å¤„ç†æµç¨‹ï¼ŒDç“œå“¥åœ¨ https://www.diguage.com/post/spring-extensions-overview/#bean-factory-post-processor[Spring æ‰©å±•ç‚¹æ¦‚è§ˆåŠå®è·µï¼šBeanDefinitionRegistryPostProcessor^] ä¸­æœ‰æ›´è¯¦ç»†çš„æè¿°ï¼Œä¸äº†è§£çš„æœ‹å‹è¯·å‚è€ƒé‚£ç¯‡æ–‡ç« çš„ä»‹ç»ã€‚
+
. åˆ›å»º `ConfigurationClassPostProcessor` å¯¹è±¡ï¼Œå¹¶é’ˆå¯¹è¯¥å¯¹è±¡ä¾æ¬¡æ‰§è¡Œ
.. æ„é€ å‡½æ•°
.. `ApplicationListenerDetector#postProcessMergedBeanDefinition(RootBeanDefinition, ConfigurationClassPostProcessor, org.springframework.context.annotation.internalConfigurationAnnotationProcessor)`
.. è°ƒç”¨ç”¨æˆ·æ‰‹åŠ¨æ·»åŠ çš„ `BeanPostProcessor#postProcessBeforeInitialization` æ–¹æ³•
.. `ApplicationContextAwareProcessor#postProcessBeforeInitialization(ConfigurationClassPostProcessor, org.springframework.context.annotation.internalConfigurationAnnotationProcessor)`
.. `ApplicationListenerDetector#postProcessBeforeInitialization(ConfigurationClassPostProcessor, org.springframework.context.annotation.internalConfigurationAnnotationProcessor)`
.. æ‰§è¡Œ `init` æ–¹æ³•
.. è°ƒç”¨ç”¨æˆ·æ‰‹åŠ¨æ·»åŠ çš„ `BeanPostProcessor#postProcessAfterInitialization` æ–¹æ³•
.. `ApplicationContextAwareProcessor#postProcessAfterInitialization(ConfigurationClassPostProcessor, org.springframework.context.annotation.internalConfigurationAnnotationProcessor)` -- ç”±äº `ApplicationContextAwareProcessor` å¹¶æ²¡æœ‰è¯¥æ–¹æ³•ï¼Œæ‰€ä»¥ä¸æ‰§è¡Œã€‚
.. `ApplicationListenerDetector#postProcessBeforeInitialization(ConfigurationClassPostProcessor, org.springframework.context.annotation.internalConfigurationAnnotationProcessor)`
. æ‰§è¡Œ `ConfigurationClassPostProcessor#postProcessBeanDefinitionRegistry(DefaultListableBeanFactory)` -- åœ¨è¿™é‡Œï¼Œå¤„ç† `@Configuration`ã€`@Import`ã€ `@ImportResource`ã€ `@Bean` å’Œ ã€‚
. æ‰§è¡Œç”¨æˆ·æ‰‹åŠ¨æ·»åŠ çš„ `BeanDefinitionRegistryPostProcessor#postProcessBeanFactory(ConfigurableListableBeanFactory beanFactory)`
. æ‰§è¡Œ `ConfigurationClassPostProcessor#postProcessBeanFactory(ConfigurableListableBeanFactory beanFactory)` -- åœ¨è¿™é‡Œç»™ `@Configuration` æ ‡æ³¨çš„ç±»ï¼Œç”Ÿæˆ cglib å¢å¼ºåçš„ä»£ç†ç±»ã€‚æ³¨æ„ï¼šåœ¨è¿™é‡Œï¼Œè¿˜å¢åŠ äº†ä¸€ä¸ª `ImportAwareBeanPostProcessor` åç½®å¤„ç†å™¨ã€‚
+
å› ä¸º `ConfigurationClassPostProcessor` æ˜¯ä¸€ä¸ª `InstantiationAwareBeanPostProcessor` å®ä¾‹ã€‚æ‰€ä»¥ï¼Œå®ä¾‹åŒ– `ConfigurationClassPostProcessor` å¯¹è±¡å¹¶åŠ å…¥åˆ°å®¹å™¨åã€‚__è¿™å¥è¯å•¥æ„æ€ï¼Ÿæƒ³æƒ³å†è¡¥å……ä¸€ä¸‹ã€‚__
+
. åˆ›å»ºäº† `EventListenerMethodProcessor` å®ä¾‹ï¼Œå’Œåˆ›å»º `ConfigurationClassPostProcessor` æ—¶ç±»ä¼¼ï¼Œä¾æ¬¡æ‰§è¡Œ 
.. `InstantiationAwareBeanPostProcessor#postProcessBeforeInstantiation` -- ç›®å‰æœ‰ `ImportAwareBeanPostProcessor`ã€‚
.. æ„é€ å‡½æ•°
.. `MergedBeanDefinitionPostProcessor#postProcessMergedBeanDefinition` -- ç›®å‰æœ‰ `ApplicationListenerDetector`ã€‚
.. `InstantiationAwareBeanPostProcessor#postProcessAfterInstantiation`
.. `InstantiationAwareBeanPostProcessor#postProcessProperties` -- ç›®å‰æœ‰ `ImportAwareBeanPostProcessor`ã€‚
.. `InstantiationAwareBeanPostProcessor#postProcessPropertyValues` -- ä» 5.1 å¼€å§‹åºŸå¼ƒï¼Œä½¿ç”¨ä¸Šé¢æ–¹æ³•ä»£æ›¿ã€‚
.. `BeanPostProcessor#postProcessBeforeInitialization` -- ç›®å‰æœ‰
... ç”¨æˆ·æ‰‹åŠ¨æ·»åŠ çš„ `BeanPostProcessor`
... `ApplicationContextAwareProcessor`
... `ApplicationListenerDetector`
... `ImportAwareBeanPostProcessor`
.. `init`
.. `BeanPostProcessor#postProcessAfterInitialization` æ–¹æ³•ã€‚ -- ä¸ `postProcessBeforeInitialization` ç›¸åŒï¼Œä¸å†èµ˜è¿°ã€‚
+
æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼Œä¸Šé¢å¢åŠ äº† `ImportAwareBeanPostProcessor` å®ä¾‹ï¼Œè¿™é‡Œä¹Ÿä¼šæ‰§è¡Œã€‚ä»¥ä¸‹éƒ½æ˜¯å¦‚æ­¤ï¼Œä¸å†èµ˜è¿°ã€‚
+
. å®ä¾‹åŒ–ç”¨æˆ·é€šè¿‡ `BeanDefinitionRegistryPostProcessor#postProcessBeanDefinitionRegistry(DefaultListableBeanFactory)` æˆ–è€… `@Configuration` æ·»åŠ çš„ `BeanFactoryPostProcessor`ï¼Œä»¥åŠ Spring è‡ªå·±æ·»åŠ çš„ `BeanFactoryPostProcessor`ã€‚ä¾æ¬¡æ‰§è¡Œå¦‚ä¸‹æ–¹æ³•ï¼š
.. `InstantiationAwareBeanPostProcessor#postProcessBeforeInstantiation` -- ç›®å‰æœ‰ `ImportAwareBeanPostProcessor`ã€‚
.. Bean çš„æ„é€ å‡½æ•°
.. `MergedBeanDefinitionPostProcessor#postProcessMergedBeanDefinition` -- ç›®å‰æœ‰ `ApplicationListenerDetector`ã€‚
.. `InstantiationAwareBeanPostProcessor#postProcessAfterInstantiation`
.. `InstantiationAwareBeanPostProcessor#postProcessProperties` -- ç›®å‰æœ‰ `ImportAwareBeanPostProcessor`ã€‚
.. `InstantiationAwareBeanPostProcessor#postProcessPropertyValues` -- ä» 5.1 å¼€å§‹åºŸå¼ƒï¼Œä½¿ç”¨ä¸Šé¢æ–¹æ³•ä»£æ›¿ã€‚
.. `BeanPostProcessor#postProcessBeforeInitialization` -- ç›®å‰æœ‰
... ç”¨æˆ·æ‰‹åŠ¨æ·»åŠ çš„ `BeanPostProcessor`
... `ApplicationContextAwareProcessor`
... `ApplicationListenerDetector`
... `ImportAwareBeanPostProcessor`
.. `init`
.. `BeanPostProcessor#postProcessAfterInitialization` æ–¹æ³•
. è°ƒç”¨ä¸Šä¸€æ­¥åˆ›å»ºçš„ `BeanFactoryPostProcessor` å¯¹è±¡çš„ `postProcessBeanFactory(ConfigurableListableBeanFactory beanFactory)` æ–¹æ³•ã€‚è¿™é‡Œç›®å‰åŒ…å« `EventListenerMethodProcessor` å¯¹è±¡ã€‚`EventListenerMethodProcessor` æ˜¯ `AnnotationConfigApplicationContext()` åˆå§‹åŒ–æ—¶ï¼Œåˆ›å»º `new AnnotatedBeanDefinitionReader(this)` å¯¹è±¡æ—¶ï¼Œé€šè¿‡è°ƒç”¨ `AnnotationConfigUtils.registerAnnotationConfigProcessors(this.registry)` æ–¹æ³•æ³¨å†Œåˆ°å®¹å™¨ä¸­çš„ã€‚
.. è¿™é‡Œè°ƒç”¨ `EventListenerMethodProcessor#postProcessBeanFactory(ConfigurableListableBeanFactory beanFactory)`ï¼Œåˆ›å»º `EventListenerFactory` å¯¹è±¡ï¼Œä¾æ¬¡æ‰§è¡Œ
+
è¿™ä¸ª `EventListenerFactory` å¯¹è±¡ä¸é‡è¦ã€‚æˆ–è€…è¯´ï¼Œç›®å‰æ²¡æœ‰å‘ç°å®ƒç‰¹åˆ«é‡è¦çš„åœ°æ–¹ã€‚
+
... `InstantiationAwareBeanPostProcessor#postProcessBeforeInstantiation`
... Bean çš„æ„é€ å‡½æ•°
... `MergedBeanDefinitionPostProcessor#postProcessMergedBeanDefinition`
... `InstantiationAwareBeanPostProcessor#postProcessAfterInstantiation`
... `InstantiationAwareBeanPostProcessor#postProcessProperties`
... `InstantiationAwareBeanPostProcessor#postProcessPropertyValues` -- ä» 5.1 å¼€å§‹åºŸå¼ƒï¼Œä½¿ç”¨ä¸Šé¢æ–¹æ³•ä»£æ›¿ã€‚
... `BeanPostProcessor#postProcessBeforeInitialization`
... `init`
... `BeanPostProcessor#postProcessAfterInitialization` æ–¹æ³•
. åˆ°æ­¤ä¸ºæ­¢ï¼Œ`invokeBeanFactoryPostProcessors(beanFactory)` æ–¹æ³•è°ƒç”¨å®Œæ¯•ã€‚
. ä¸‹é¢å¼€å§‹è°ƒç”¨ `registerBeanPostProcessors(beanFactory)` æ–¹æ³•ã€‚
. æ·»åŠ  `PostProcessorRegistrationDelegate.BeanPostProcessorChecker` å®ä¾‹ï¼Œä»¥ä¸‹æ‰§è¡Œ `BeanPostProcessor` æ–¹æ³•æ—¶ï¼Œéƒ½ä¼šå¸¦ä¸Šã€‚
. åˆ›å»º `AutowiredAnnotationBeanPostProcessor`ã€ `CommonAnnotationBeanPostProcessor` å¯¹è±¡ï¼Œä¾æ¬¡æ‰§è¡Œå¦‚ä¸‹æ–¹æ³•ï¼š
.. `InstantiationAwareBeanPostProcessor#postProcessBeforeInstantiation` -- ç›®å‰æœ‰ `ImportAwareBeanPostProcessor`ã€‚
.. æ„é€ å‡½æ•°
.. `MergedBeanDefinitionPostProcessor#postProcessMergedBeanDefinition` -- ç›®å‰æœ‰ `ApplicationListenerDetector`ã€‚
.. `InstantiationAwareBeanPostProcessor#postProcessAfterInstantiation`
.. `InstantiationAwareBeanPostProcessor#postProcessProperties`
.. `InstantiationAwareBeanPostProcessor#postProcessPropertyValues` -- ä» 5.1 å¼€å§‹åºŸå¼ƒï¼Œä½¿ç”¨ä¸Šé¢æ–¹æ³•ä»£æ›¿ã€‚
.. `AutowiredAnnotationBeanPostProcessor#setBeanFactory(DefaultListableBeanFactory)` -- å®Œæˆ `BeanNameAware`ï¼Œ `BeanClassLoaderAware`ï¼Œ `BeanFactoryAware` ä¸‰ä¸ª `Aware` çš„æ³¨å…¥ã€‚é€šè¿‡ `AbstractAutowireCapableBeanFactory#invokeAwareMethods` æ–¹æ³•æ¥å®Œæˆã€‚
.. `BeanPostProcessor#postProcessBeforeInitialization` -- ç›®å‰æœ‰
... ç”¨æˆ·æ‰‹åŠ¨æ·»åŠ çš„ `BeanPostProcessor`
... `ApplicationContextAwareProcessor` -- å®Œæˆå¦‚ä¸‹å…­ä¸ª `Aware` çš„æ³¨å…¥ï¼š
.... `EnvironmentAware`
.... `EmbeddedValueResolverAware`
.... `ResourceLoaderAware`
.... `ApplicationEventPublisherAware`
.... `MessageSourceAware`
.... `ApplicationContextAware`
... `ApplicationListenerDetector`
... `ImportAwareBeanPostProcessor`
... `BeanPostProcessorChecker`
.. `init`
.. `BeanPostProcessor#postProcessAfterInitialization` æ–¹æ³•
. å°† `AutowiredAnnotationBeanPostProcessor`ã€ `CommonAnnotationBeanPostProcessor` å¯¹è±¡æ³¨å†Œåˆ°å®¹å™¨ä¸­ã€‚ä»¥ä¸‹ä¼šéšç€ `BeanPostProcessor` çš„è°ƒç”¨ï¼Œä¹Ÿä¼šè¢«æ‰§è¡Œã€‚
. åˆ›å»º `AnnotationAwareAspectJAutoProxyCreator` å¯¹è±¡ï¼Œä¾æ¬¡æ‰§è¡Œå¦‚ä¸‹æ–¹æ³•ï¼š
.. `InstantiationAwareBeanPostProcessor#postProcessBeforeInstantiation` -- ç›®å‰æœ‰å¦‚ä¸‹ä¸‰ä¸ªï¼š
... `ImportAwareBeanPostProcessor`
... `CommonAnnotationBeanPostProcessor`
... `AutowiredAnnotationBeanPostProcessor`
.. æ„é€ å‡½æ•°
.. `MergedBeanDefinitionPostProcessor#postProcessMergedBeanDefinition` -- ç›®å‰æœ‰å¦‚ä¸‹ä¸‰ä¸ªï¼š
... `ApplicationListenerDetector`
... `CommonAnnotationBeanPostProcessor` -- æ”¶é›†ä¾èµ–ä¿¡æ¯ã€‚
... `AutowiredAnnotationBeanPostProcessor` -- æ”¶é›†ä¾èµ–ä¿¡æ¯ã€‚
.. `InstantiationAwareBeanPostProcessor#postProcessAfterInstantiation`
.. `InstantiationAwareBeanPostProcessor#postProcessProperties` ç›®å‰æœ‰å¦‚ä¸‹ä¸‰ä¸ªï¼š
... `ImportAwareBeanPostProcessor`
... `CommonAnnotationBeanPostProcessor` -- å®Œæˆä¾èµ–æ³¨å…¥ã€‚
... `AutowiredAnnotationBeanPostProcessor` -- å®Œæˆä¾èµ–æ³¨å…¥ã€‚
.. `InstantiationAwareBeanPostProcessor#postProcessPropertyValues` -- ä» 5.1 å¼€å§‹åºŸå¼ƒï¼Œä½¿ç”¨ä¸Šé¢æ–¹æ³•ä»£æ›¿ã€‚
.. `BeanPostProcessor#postProcessBeforeInitialization` -- ç›®å‰æœ‰
... ç”¨æˆ·æ‰‹åŠ¨æ·»åŠ çš„ `BeanPostProcessor`
... `ApplicationContextAwareProcessor` -- å®Œæˆå¦‚ä¸‹å…­ä¸ª `Aware` çš„æ³¨å…¥ï¼š
.... `EnvironmentAware`
.... `EmbeddedValueResolverAware`
.... `ResourceLoaderAware`
.... `ApplicationEventPublisherAware`
.... `MessageSourceAware`
.... `ApplicationContextAware`
... `ApplicationListenerDetector`
... `ImportAwareBeanPostProcessor`
... `BeanPostProcessorChecker`
... `CommonAnnotationBeanPostProcessor`
... `AutowiredAnnotationBeanPostProcessor`
.. `init`
.. `BeanPostProcessor#postProcessAfterInitialization` æ–¹æ³•
. å°† `AnnotationAwareAspectJAutoProxyCreator` å¯¹è±¡æ³¨å†Œåˆ°å®¹å™¨ä¸­ã€‚ä»¥ä¸‹ä¼šéšç€ `BeanPostProcessor` çš„è°ƒç”¨ï¼Œä¹Ÿä¼šè¢«æ‰§è¡Œã€‚
. é‡æ–°æ·»åŠ  `ApplicationListenerDetector`ï¼Œå…¶å®å°±æ˜¯æ¢äº†ä¸ªä½ç½®ï¼Œå°†å…¶è°ƒæ•´åˆ°äº†æœ€åã€‚
. åˆ°æ­¤ä¸ºæ­¢ï¼Œ`registerBeanPostProcessors(beanFactory)` æ–¹æ³•è°ƒç”¨å®Œæ¯•ã€‚
. è°ƒç”¨ `initMessageSource()` æ–¹æ³•ï¼Œæ³¨å†Œ `MessageSource` Beanã€‚
. è°ƒç”¨ `initApplicationEventMulticaster()` æ–¹æ³•ï¼Œæ³¨å†Œ `SimpleApplicationEventMulticaster` å¯¹è±¡ï¼Œ
. è°ƒç”¨ `onRefresh()` æ–¹æ³•ï¼Œè¿™æ˜¯ç©ºæ–¹æ³•ï¼Œæ–¹ä¾¿åšæ‰©å±•ã€‚
. è°ƒç”¨ `registerListeners()` æ–¹æ³•ï¼Œä½†æ˜¯ä¼¼ä¹ä»€ä¹ˆä¹Ÿæ²¡åšã€‚
. è°ƒç”¨ `finishBeanFactoryInitialization(beanFactory)` æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¸­ï¼Œæœ€é‡è¦çš„ä¸€ä¸ªæ“ä½œå°±æ˜¯å®ä¾‹åŒ–éæ‡’åŠ è½½çš„æ‰€æœ‰ Beanï¼Œåœ¨ `DefaultListableBeanFactory#preInstantiateSingletons` ä¸­å®Œæˆè¿™äº›æ“ä½œã€‚ç›®å‰ï¼Œé™¤äº†ç”¨æˆ·è‡ªå·±å®ç°çš„ï¼Œè¿˜æœ‰ä¸ƒä¸ªå¦‚ä¸‹çš„ `BeanPostProcessor`ï¼š
.. `ApplicationContextAwareProcessor`
.. `ConfigurationClassPostProcessor`
.. `BeanPostProcessorChecker`
.. `AnnotationAwareAspectJAutoProxyCreator`
.. `CommonAnnotationBeanPostProcessor`
.. `AutowiredAnnotationBeanPostProcessor`
.. `ApplicationListenerDetector`
+
è¿™éƒ¨åˆ†å†…å®¹æ”¾åœ¨ä¸‹ä¸€ç¯‡æ–‡ç«  https://www.diguage.com/post/spring-bean-lifecycle-overview/[Spring Bean ç”Ÿå‘½å‘¨æœŸæ¦‚è¿°^] å†å±•å¼€æ¥è®²ã€‚
+
. è°ƒç”¨ `finishRefresh()` -- å¯åŠ¨ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œå¹¿æ’­åˆ·æ–°å®Œæˆé€šçŸ¥ã€‚å…·ä½“å¦‚ä¸‹ï¼š
.. æ¸…ç† `Resource` ç¼“å­˜ï¼ˆä¹Ÿå°±æ˜¯è¢«æ‰«æåˆ°çš„å„ç§ç±»ï¼Œè‡ªå®šä¹‰ç±»ï¼Œä»¥åŠç›¸å…³çˆ¶ç±»å’Œæ‰€å®ç°çš„æ¥å£ï¼‰ã€‚ï¼ˆåƒæ˜¯åœ¨ `ImportSelector` ä¸­å£°æ˜çš„ç±»ã€‚ä½†æ˜¯æ²¡æœ‰æ‰¾åˆ°æ·»åŠ åˆ°ç¼“å­˜çš„åœ°æ–¹ï¼Ÿï¼‰
.. æ³¨å†Œ `LifecycleProcessor`ï¼Œå¹¶é€šè¿‡å®ƒå¯åŠ¨æ‰€æœ‰çš„ `LifecycleProcessor` å’Œå®ƒè‡ªèº«ã€‚æ²¡æœ‰çœ‹å‡ºæ¥å¹²ä»€ä¹ˆç”¨çš„ï¼Ÿ
.. å¹¿æ’­ `ContextRefreshedEvent` äº‹ä»¶ã€‚
.. å°† `ConfigurableApplicationContext` æ³¨å†Œåˆ° `LiveBeansView` ä¸Šï¼Œå¦‚æœå®ƒå­˜åœ¨çš„è¯ã€‚
.. æ¸…ç†å„ç§ç¼“å­˜
... å¯åŠ¨è¿‡ç¨‹ä¸­çš„åå°„ç›¸å…³ç¼“å­˜ï¼Œæ¯”å¦‚ `init-method`ï¼Œ`Aware` ç›¸å…³çš„æ–¹æ³•ï¼Œæ³¨å…¥éœ€è¦çš„å­—æ®µç­‰ç­‰ï¼›
... `AnnotationFilter` ç›¸å…³ç¼“å­˜ï¼›
... æ³¨è§£å…ƒç´ ç¼“å­˜å’Œç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼ˆ`Aware`ã€`InitializingBean`ã€`BeanFactoryPostProcessor`ç­‰ï¼‰ç¼“å­˜æ¸…ç©º
... è§£æç±»å‹ç¼“å­˜æ¸…ç©º
... åçœç»“æœæ¸…ç©º


åœ¨ä¸‹ä¸€ç¯‡æ–‡ç«  https://www.diguage.com/post/spring-bean-lifecycle-overview/[Spring Bean ç”Ÿå‘½å‘¨æœŸæ¦‚è¿°^] ä¸­ï¼ŒDç“œå“¥å°†é’ˆå¯¹ Spring Bean çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå±•å¼€è¯¦ç»†è¯´æ˜ã€‚

== é™„å½•ï¼šå¯åŠ¨æ—¥å¿—

ä¸‹é¢æ˜¯å¯åŠ¨æ—¥å¿—ã€‚æœ‰åˆ å‡ï¼Œä¸ºäº†æ–¹ä¾¿é˜…è¯»ï¼Œå¢åŠ äº†åºå·å’Œå±‚æ¬¡ã€‚

. è°ƒç”¨ `prepareRefresh()` æ–¹æ³•ï¼Œåˆå§‹åŒ–å±æ€§æº(property source)é…ç½®ã€‚
. è°ƒç”¨ `obtainFreshBeanFactory()` è·å¾— `ConfigurableListableBeanFactory` å¯¹è±¡ã€‚
. å‡†å¤‡ `BeanFactory`ï¼Œæ·»åŠ å¿…è¦çš„ Beanï¼Œåœ¨ `prepareBeanFactory` ä¸­å®Œæˆã€‚
. ä¸‹é¢é€šè¿‡ `invokeBeanFactoryPostProcessors` æ–¹æ³•ï¼Œå¼€å§‹æ‰§è¡Œ `BeanFactoryPostProcessor` ç›¸å…³çš„æ–¹æ³•

. `LogBeanDefinitionRegistryPostProcessor#postProcessBeanDefinitionRegistry(DefaultListableBeanFactory)` -- ç”¨æˆ·è‡ªå·±æ‰‹åŠ¨æ·»åŠ çš„ `BeanDefinitionRegistryPostProcessor` å®ä¾‹

. åˆ›å»º `ConfigurationClassPostProcessor` Bean

.. æ„é€ å‡½æ•°

.. `ApplicationListenerDetector#postProcessMergedBeanDefinition(RootBeanDefinition, ConfigurationClassPostProcessor, org.springframework.context.annotation.internalConfigurationAnnotationProcessor)` -- `ApplicationListenerDetector` å®ä¾‹æ˜¯åœ¨ `prepareBeanFactory` æ–¹æ³•ä¸­ï¼ŒåŠ å…¥åˆ°å®¹å™¨ä¸­çš„ã€‚

.. `LogBeanPostProcessor#postProcessBeforeInitialization(ConfigurationClassPostProcessor, org.springframework.context.annotation.internalConfigurationAnnotationProcessor)` -- ç”¨æˆ·è‡ªå·±æ‰‹åŠ¨æ·»åŠ 

.. `LogDestructionAwareBeanPostProcessor#postProcessBeforeInitialization(ConfigurationClassPostProcessor, org.springframework.context.annotation.internalConfigurationAnnotationProcessor)` -- ç”¨æˆ·è‡ªå·±æ‰‹åŠ¨æ·»åŠ ï¼Œç»§æ‰¿é»˜è®¤å®ç°ã€‚

.. `ApplicationContextAwareProcessor#postProcessBeforeInitialization(ConfigurationClassPostProcessor, org.springframework.context.annotation.internalConfigurationAnnotationProcessor)` -- `ApplicationContextAwareProcessor` å®ä¾‹æ˜¯åœ¨ `prepareBeanFactory` æ–¹æ³•ä¸­ï¼ŒåŠ å…¥åˆ°å®¹å™¨ä¸­çš„ã€‚å¤„ç†å…­ç§ `Aware` æ³¨å…¥ã€‚

.. `ApplicationListenerDetector#postProcessBeforeInitialization(ConfigurationClassPostProcessor, org.springframework.context.annotation.internalConfigurationAnnotationProcessor)`

.. `LogBeanPostProcessor#postProcessAfterInitialization(ConfigurationClassPostProcessor, org.springframework.context.annotation.internalConfigurationAnnotationProcessor)`

.. `LogDestructionAwareBeanPostProcessor#postProcessAfterInitialization(ConfigurationClassPostProcessor, org.springframework.context.annotation.internalConfigurationAnnotationProcessor)` -- ç”¨æˆ·è‡ªå·±æ‰‹åŠ¨æ·»åŠ ï¼Œç»§æ‰¿é»˜è®¤å®ç°ï¼Œæ²¡æœ‰ä»»ä½•æ“ä½œã€‚

.. `ApplicationContextAwareProcessor#postProcessAfterInitialization(ConfigurationClassPostProcessor, org.springframework.context.annotation.internalConfigurationAnnotationProcessor)` -- ç»§æ‰¿é»˜è®¤å®ç°ï¼Œæ²¡æœ‰ä»»ä½•æ“ä½œã€‚

.. `ApplicationListenerDetector#postProcessAfterInitialization(ConfigurationClassPostProcessor, org.springframework.context.annotation.internalConfigurationAnnotationProcessor)`

. `ConfigurationClassPostProcessor#postProcessBeanDefinitionRegistry(DefaultListableBeanFactory)` -- åœ¨è¿™é‡Œï¼Œå¤„ç† `@Configuration`ã€`@Import`ã€ `@ImportResource`ã€ `@Bean` å’Œ ã€‚

. `LogBeanDefinitionRegistryPostProcessor#postProcessBeanFactory(DefaultListableBeanFactory)`

. `ConfigurationClassPostProcessor#postProcessBeanFactory(DefaultListableBeanFactory)` -- åœ¨è¿™é‡Œç»™ `@Configuration` æ ‡æ³¨çš„ç±»ï¼Œç”Ÿæˆ cglib å¢å¼ºåçš„ä»£ç†ç±»ã€‚æ³¨æ„ï¼šåœ¨è¿™é‡Œï¼Œè¿˜å¢åŠ äº†ä¸€ä¸ª `ImportAwareBeanPostProcessor` åç½®å¤„ç†å™¨ã€‚
+
å› ä¸º `ConfigurationClassPostProcessor` æ˜¯ä¸€ä¸ª `InstantiationAwareBeanPostProcessor` å®ä¾‹ã€‚æ‰€ä»¥ï¼Œå®ä¾‹åŒ– `ConfigurationClassPostProcessor` å¯¹è±¡å¹¶åŠ å…¥åˆ°å®¹å™¨åã€‚__è¿™å¥è¯å•¥æ„æ€ï¼Ÿæƒ³æƒ³å†è¡¥å……ä¸€ä¸‹ã€‚__
+

. åˆ›å»º `EventListenerMethodProcessor` Beanï¼Œ Nameï¼š `org.springframework.context.event.internalEventListenerProcessor`

.. `ImportAwareBeanPostProcessor#postProcessBeforeInstantiation(EventListenerMethodProcessor, org.springframework.context.event.internalEventListenerProcessor)`

.. æ„é€ å‡½æ•°

.. `ApplicationListenerDetector#postProcessMergedBeanDefinition(RootBeanDefinition, EventListenerMethodProcessor, org.springframework.context.event.internalEventListenerProcessor)`

.. `ImportAwareBeanPostProcessor#postProcessAfterInstantiation(EventListenerMethodProcessor, org.springframework.context.event.internalEventListenerProcessor)`

.. `ImportAwareBeanPostProcessor#postProcessProperties(MutablePropertyValues, EventListenerMethodProcessor, org.springframework.context.event.internalEventListenerProcessor)`

.. `LogBeanPostProcessor#postProcessBeforeInitialization(EventListenerMethodProcessor, org.springframework.context.event.internalEventListenerProcessor)`

.. `LogDestructionAwareBeanPostProcessor#postProcessBeforeInitialization(EventListenerMethodProcessor, org.springframework.context.event.internalEventListenerProcessor)`

.. `ApplicationContextAwareProcessor#postProcessBeforeInitialization(EventListenerMethodProcessor, org.springframework.context.event.internalEventListenerProcessor)`

.. `ApplicationListenerDetector#postProcessBeforeInitialization(EventListenerMethodProcessor, org.springframework.context.event.internalEventListenerProcessor)`

.. `ImportAwareBeanPostProcessor#postProcessBeforeInitialization(EventListenerMethodProcessor, org.springframework.context.event.internalEventListenerProcessor)`

.. `LogBeanPostProcessor#postProcessAfterInitialization(EventListenerMethodProcessor, org.springframework.context.event.internalEventListenerProcessor)`

.. `LogDestructionAwareBeanPostProcessor#postProcessAfterInitialization(EventListenerMethodProcessor, org.springframework.context.event.internalEventListenerProcessor)`

.. `ApplicationContextAwareProcessor#postProcessAfterInitialization(EventListenerMethodProcessor, org.springframework.context.event.internalEventListenerProcessor)`

.. `ApplicationListenerDetector#postProcessAfterInitialization(EventListenerMethodProcessor, org.springframework.context.event.internalEventListenerProcessor)`

.. `ImportAwareBeanPostProcessor#postProcessAfterInitialization(EventListenerMethodProcessor, org.springframework.context.event.internalEventListenerProcessor)`

. åˆ›å»ºè‡ªå®šä¹‰ `LogBeanFactoryPostProcessor`ï¼Œé€šè¿‡ä¸Šé¢ `LogBeanDefinitionRegistryPostProcessor` çš„ `postProcessBeanDefinitionRegistry` æ–¹æ³•æ·»åŠ ã€‚åœ¨è¿™ä¸€æ­¥åˆ›å»ºç”¨æˆ·é€šè¿‡ `BeanDefinitionRegistryPostProcessor#postProcessBeanDefinitionRegistry(DefaultListableBeanFactory)` æˆ–è€… `@Configuration` æ·»åŠ çš„ `BeanFactoryPostProcessor`ï¼Œä»¥åŠ Spring è‡ªå·±æ·»åŠ çš„ `BeanFactoryPostProcessor` ç­‰ç±»çš„ç›¸å…³ Beanã€‚

.. `ImportAwareBeanPostProcessor#postProcessBeforeInstantiation(LogBeanFactoryPostProcessor, LogBeanFactoryPostProcessor)`

.. `ApplicationListenerDetector#postProcessMergedBeanDefinition(RootBeanDefinition, LogBeanFactoryPostProcessor, LogBeanFactoryPostProcessor)`

.. `ImportAwareBeanPostProcessor#postProcessAfterInstantiation(LogBeanFactoryPostProcessor, LogBeanFactoryPostProcessor)`

.. `ImportAwareBeanPostProcessor#postProcessProperties(MutablePropertyValues, LogBeanFactoryPostProcessor, LogBeanFactoryPostProcessor)`

.. `LogBeanPostProcessor#postProcessBeforeInitialization(LogBeanFactoryPostProcessor, LogBeanFactoryPostProcessor)`

.. `LogDestructionAwareBeanPostProcessor#postProcessBeforeInitialization(LogBeanFactoryPostProcessor, LogBeanFactoryPostProcessor)`

.. `ApplicationContextAwareProcessor#postProcessBeforeInitialization(LogBeanFactoryPostProcessor, LogBeanFactoryPostProcessor)`

.. `ApplicationListenerDetector#postProcessBeforeInitialization(LogBeanFactoryPostProcessor, LogBeanFactoryPostProcessor)`

.. `ImportAwareBeanPostProcessor#postProcessBeforeInitialization(LogBeanFactoryPostProcessor, LogBeanFactoryPostProcessor)`

.. `LogBeanPostProcessor#postProcessAfterInitialization(LogBeanFactoryPostProcessor, LogBeanFactoryPostProcessor)`

.. `LogDestructionAwareBeanPostProcessor#postProcessAfterInitialization(LogBeanFactoryPostProcessor, LogBeanFactoryPostProcessor)`

.. `ApplicationContextAwareProcessor#postProcessAfterInitialization(LogBeanFactoryPostProcessor, LogBeanFactoryPostProcessor)`

.. `ApplicationListenerDetector#postProcessAfterInitialization(LogBeanFactoryPostProcessor, LogBeanFactoryPostProcessor)`

.. `ImportAwareBeanPostProcessor#postProcessAfterInitialization(LogBeanFactoryPostProcessor, LogBeanFactoryPostProcessor)`

. è¿™é‡Œä¼šè°ƒç”¨ä¸Šä¸€æ­¥åˆ›å»ºçš„ `BeanFactoryPostProcessor` å¯¹è±¡çš„ `postProcessBeanFactory(ConfigurableListableBeanFactory beanFactory)` æ–¹æ³•ã€‚è¿™é‡Œç›®å‰åŒ…å« `EventListenerMethodProcessor` å¯¹è±¡ã€‚`EventListenerMethodProcessor` æ˜¯ `AnnotationConfigApplicationContext()` åˆå§‹åŒ–æ—¶ï¼Œåˆ›å»º `new AnnotatedBeanDefinitionReader(this)` å¯¹è±¡æ—¶ï¼Œé€šè¿‡è°ƒç”¨ `AnnotationConfigUtils.registerAnnotationConfigProcessors(this.registry)` æ–¹æ³•æ³¨å†Œåˆ°å®¹å™¨ä¸­çš„ã€‚

. `LogBeanFactoryPostProcessor#postProcessBeanFactory(DefaultListableBeanFactory)`

. åˆ°æ­¤ä¸ºæ­¢ï¼Œ`invokeBeanFactoryPostProcessors(beanFactory)` æ–¹æ³•è°ƒç”¨å®Œæ¯•ã€‚

. ä¸‹é¢å¼€å§‹è°ƒç”¨ `registerBeanPostProcessors(beanFactory)` æ–¹æ³•ã€‚

. æ·»åŠ  `PostProcessorRegistrationDelegate.BeanPostProcessorChecker` å®ä¾‹ï¼Œä»¥ä¸‹æ‰§è¡Œ `BeanPostProcessor` æ–¹æ³•æ—¶ï¼Œéƒ½ä¼šå¸¦ä¸Šã€‚

. åˆ›å»º `AutowiredAnnotationBeanPostProcessor` Beanï¼ŒNameï¼š `org.springframework.context.annotation.internalAutowiredAnnotationProcessor`

.. `ImportAwareBeanPostProcessor#postProcessBeforeInstantiation(AutowiredAnnotationBeanPostProcessor, org.springframework.context.annotation.internalAutowiredAnnotationProcessor)`

.. `ApplicationListenerDetector#postProcessMergedBeanDefinition(RootBeanDefinition, AutowiredAnnotationBeanPostProcessor, org.springframework.context.annotation.internalAutowiredAnnotationProcessor)`

.. `ImportAwareBeanPostProcessor#postProcessAfterInstantiation(AutowiredAnnotationBeanPostProcessor, org.springframework.context.annotation.internalAutowiredAnnotationProcessor)`

.. `ImportAwareBeanPostProcessor#postProcessProperties(MutablePropertyValues, AutowiredAnnotationBeanPostProcessor, org.springframework.context.annotation.internalAutowiredAnnotationProcessor)`

.. `AutowiredAnnotationBeanPostProcessor#setBeanFactory(DefaultListableBeanFactory)`

.. `LogBeanPostProcessor#postProcessBeforeInitialization(AutowiredAnnotationBeanPostProcessor, org.springframework.context.annotation.internalAutowiredAnnotationProcessor)`

.. `LogDestructionAwareBeanPostProcessor#postProcessBeforeInitialization(AutowiredAnnotationBeanPostProcessor, org.springframework.context.annotation.internalAutowiredAnnotationProcessor)`

.. `ApplicationContextAwareProcessor#postProcessBeforeInitialization(AutowiredAnnotationBeanPostProcessor, org.springframework.context.annotation.internalAutowiredAnnotationProcessor)`

.. `ApplicationListenerDetector#postProcessBeforeInitialization(AutowiredAnnotationBeanPostProcessor, org.springframework.context.annotation.internalAutowiredAnnotationProcessor)`

.. `ImportAwareBeanPostProcessor#postProcessBeforeInitialization(AutowiredAnnotationBeanPostProcessor, org.springframework.context.annotation.internalAutowiredAnnotationProcessor)`

.. `BeanPostProcessorChecker#postProcessBeforeInitialization(AutowiredAnnotationBeanPostProcessor, org.springframework.context.annotation.internalAutowiredAnnotationProcessor)`

.. `LogBeanPostProcessor#postProcessAfterInitialization(AutowiredAnnotationBeanPostProcessor, org.springframework.context.annotation.internalAutowiredAnnotationProcessor)`

.. `LogDestructionAwareBeanPostProcessor#postProcessAfterInitialization(AutowiredAnnotationBeanPostProcessor, org.springframework.context.annotation.internalAutowiredAnnotationProcessor)`

.. `ApplicationContextAwareProcessor#postProcessAfterInitialization(AutowiredAnnotationBeanPostProcessor, org.springframework.context.annotation.internalAutowiredAnnotationProcessor)`

.. `ApplicationListenerDetector#postProcessAfterInitialization(AutowiredAnnotationBeanPostProcessor, org.springframework.context.annotation.internalAutowiredAnnotationProcessor)`

.. `ImportAwareBeanPostProcessor#postProcessAfterInitialization(AutowiredAnnotationBeanPostProcessor, org.springframework.context.annotation.internalAutowiredAnnotationProcessor)`

.. `BeanPostProcessorChecker#postProcessAfterInitialization(AutowiredAnnotationBeanPostProcessor, org.springframework.context.annotation.internalAutowiredAnnotationProcessor)`

. åˆ›å»º `CommonAnnotationBeanPostProcessor` Beanï¼ŒNameï¼š `org.springframework.context.annotation.internalCommonAnnotationProcessor`

.. `ImportAwareBeanPostProcessor#postProcessBeforeInstantiation(CommonAnnotationBeanPostProcessor, org.springframework.context.annotation.internalCommonAnnotationProcessor)`

.. `ApplicationListenerDetector#postProcessMergedBeanDefinition(RootBeanDefinition, CommonAnnotationBeanPostProcessor, org.springframework.context.annotation.internalCommonAnnotationProcessor)`

.. `ImportAwareBeanPostProcessor#postProcessAfterInstantiation(CommonAnnotationBeanPostProcessor, org.springframework.context.annotation.internalCommonAnnotationProcessor)`

.. `ImportAwareBeanPostProcessor#postProcessProperties(MutablePropertyValues, CommonAnnotationBeanPostProcessor, org.springframework.context.annotation.internalCommonAnnotationProcessor)`

.. `LogBeanPostProcessor#postProcessBeforeInitialization(CommonAnnotationBeanPostProcessor, org.springframework.context.annotation.internalCommonAnnotationProcessor)`

.. `LogDestructionAwareBeanPostProcessor#postProcessBeforeInitialization(CommonAnnotationBeanPostProcessor, org.springframework.context.annotation.internalCommonAnnotationProcessor)`

.. `ApplicationContextAwareProcessor#postProcessBeforeInitialization(CommonAnnotationBeanPostProcessor, org.springframework.context.annotation.internalCommonAnnotationProcessor)`

.. `ApplicationListenerDetector#postProcessBeforeInitialization(CommonAnnotationBeanPostProcessor, org.springframework.context.annotation.internalCommonAnnotationProcessor)`

.. `ImportAwareBeanPostProcessor#postProcessBeforeInitialization(CommonAnnotationBeanPostProcessor, org.springframework.context.annotation.internalCommonAnnotationProcessor)`

.. `BeanPostProcessorChecker#postProcessBeforeInitialization(CommonAnnotationBeanPostProcessor, org.springframework.context.annotation.internalCommonAnnotationProcessor)`

.. `LogBeanPostProcessor#postProcessAfterInitialization(CommonAnnotationBeanPostProcessor, org.springframework.context.annotation.internalCommonAnnotationProcessor)`

.. `LogDestructionAwareBeanPostProcessor#postProcessAfterInitialization(CommonAnnotationBeanPostProcessor, org.springframework.context.annotation.internalCommonAnnotationProcessor)`

.. `ApplicationContextAwareProcessor#postProcessAfterInitialization(CommonAnnotationBeanPostProcessor, org.springframework.context.annotation.internalCommonAnnotationProcessor)`

.. `ApplicationListenerDetector#postProcessAfterInitialization(CommonAnnotationBeanPostProcessor, org.springframework.context.annotation.internalCommonAnnotationProcessor)`

.. `ImportAwareBeanPostProcessor#postProcessAfterInitialization(CommonAnnotationBeanPostProcessor, org.springframework.context.annotation.internalCommonAnnotationProcessor)`

.. `BeanPostProcessorChecker#postProcessAfterInitialization(CommonAnnotationBeanPostProcessor, org.springframework.context.annotation.internalCommonAnnotationProcessor)`

. åˆ›å»º `AnnotationAwareAspectJAutoProxyCreator`ï¼ŒNameï¼š `org.springframework.aop.config.internalAutoProxyCreator`ã€‚ä¹Ÿè®¸æ˜¯å› ä¸ºé…ç½®äº† `@EnableAspectJAutoProxy(proxyTargetClass = true, exposeProxy = true)`ã€‚__è¿™ä¸ªå†æ¢ç©¶ç«Ÿï¼Ÿ__

.. `ImportAwareBeanPostProcessor#postProcessBeforeInstantiation(AnnotationAwareAspectJAutoProxyCreator, org.springframework.aop.config.internalAutoProxyCreator)`

.. `CommonAnnotationBeanPostProcessor#postProcessBeforeInstantiation(AnnotationAwareAspectJAutoProxyCreator, org.springframework.aop.config.internalAutoProxyCreator)`

.. `AutowiredAnnotationBeanPostProcessor#postProcessBeforeInstantiation(AnnotationAwareAspectJAutoProxyCreator, org.springframework.aop.config.internalAutoProxyCreator)`

.. `ApplicationListenerDetector#postProcessMergedBeanDefinition(RootBeanDefinition, AnnotationAwareAspectJAutoProxyCreator, org.springframework.aop.config.internalAutoProxyCreator)`

.. `CommonAnnotationBeanPostProcessor#postProcessMergedBeanDefinition(RootBeanDefinition, AnnotationAwareAspectJAutoProxyCreator, org.springframework.aop.config.internalAutoProxyCreator)`

.. `AutowiredAnnotationBeanPostProcessor#postProcessMergedBeanDefinition(RootBeanDefinition, AnnotationAwareAspectJAutoProxyCreator, org.springframework.aop.config.internalAutoProxyCreator)`

.. `ImportAwareBeanPostProcessor#postProcessAfterInstantiation(AnnotationAwareAspectJAutoProxyCreator, org.springframework.aop.config.internalAutoProxyCreator)`

.. `CommonAnnotationBeanPostProcessor#postProcessAfterInstantiation(AnnotationAwareAspectJAutoProxyCreator, org.springframework.aop.config.internalAutoProxyCreator)`

.. `AutowiredAnnotationBeanPostProcessor#postProcessAfterInstantiation(AnnotationAwareAspectJAutoProxyCreator, org.springframework.aop.config.internalAutoProxyCreator)`

.. `ImportAwareBeanPostProcessor#postProcessProperties(MutablePropertyValues, AnnotationAwareAspectJAutoProxyCreator, org.springframework.aop.config.internalAutoProxyCreator)`

.. `CommonAnnotationBeanPostProcessor#postProcessProperties(MutablePropertyValues, AnnotationAwareAspectJAutoProxyCreator, org.springframework.aop.config.internalAutoProxyCreator)`

.. `AutowiredAnnotationBeanPostProcessor#postProcessProperties(MutablePropertyValues, AnnotationAwareAspectJAutoProxyCreator, org.springframework.aop.config.internalAutoProxyCreator)`

.. `LogBeanPostProcessor#postProcessBeforeInitialization(AnnotationAwareAspectJAutoProxyCreator, org.springframework.aop.config.internalAutoProxyCreator)`

.. `LogDestructionAwareBeanPostProcessor#postProcessBeforeInitialization(AnnotationAwareAspectJAutoProxyCreator, org.springframework.aop.config.internalAutoProxyCreator)`

.. `ApplicationContextAwareProcessor#postProcessBeforeInitialization(AnnotationAwareAspectJAutoProxyCreator, org.springframework.aop.config.internalAutoProxyCreator)`

.. `ApplicationListenerDetector#postProcessBeforeInitialization(AnnotationAwareAspectJAutoProxyCreator, org.springframework.aop.config.internalAutoProxyCreator)`

.. `ImportAwareBeanPostProcessor#postProcessBeforeInitialization(AnnotationAwareAspectJAutoProxyCreator, org.springframework.aop.config.internalAutoProxyCreator)`

.. `BeanPostProcessorChecker#postProcessBeforeInitialization(AnnotationAwareAspectJAutoProxyCreator, org.springframework.aop.config.internalAutoProxyCreator)`

.. `CommonAnnotationBeanPostProcessor#postProcessBeforeInitialization(AnnotationAwareAspectJAutoProxyCreator, org.springframework.aop.config.internalAutoProxyCreator)`

.. `AutowiredAnnotationBeanPostProcessor#postProcessBeforeInitialization(AnnotationAwareAspectJAutoProxyCreator, org.springframework.aop.config.internalAutoProxyCreator)`

.. `LogBeanPostProcessor#postProcessAfterInitialization(AnnotationAwareAspectJAutoProxyCreator, org.springframework.aop.config.internalAutoProxyCreator)`

.. `LogDestructionAwareBeanPostProcessor#postProcessAfterInitialization(AnnotationAwareAspectJAutoProxyCreator, org.springframework.aop.config.internalAutoProxyCreator)`

.. `ApplicationContextAwareProcessor#postProcessAfterInitialization(AnnotationAwareAspectJAutoProxyCreator, org.springframework.aop.config.internalAutoProxyCreator)`

.. `ApplicationListenerDetector#postProcessAfterInitialization(AnnotationAwareAspectJAutoProxyCreator, org.springframework.aop.config.internalAutoProxyCreator)`

.. `ImportAwareBeanPostProcessor#postProcessAfterInitialization(AnnotationAwareAspectJAutoProxyCreator, org.springframework.aop.config.internalAutoProxyCreator)`

.. `BeanPostProcessorChecker#postProcessAfterInitialization(AnnotationAwareAspectJAutoProxyCreator, org.springframework.aop.config.internalAutoProxyCreator)`

.. `CommonAnnotationBeanPostProcessor#postProcessAfterInitialization(AnnotationAwareAspectJAutoProxyCreator, org.springframework.aop.config.internalAutoProxyCreator)`

.. `AutowiredAnnotationBeanPostProcessor#postProcessAfterInitialization(AnnotationAwareAspectJAutoProxyCreator, org.springframework.aop.config.internalAutoProxyCreator)`

. é¢„åŠ è½½ `Config`ã€ `UserService` ç­‰ Beanã€‚ä¸‹é¢ä»¥ `UserService` ä¸ºä¾‹ï¼š

.. `ImportAwareBeanPostProcessor#postProcessBeforeInstantiation(UserService, UserService)`

.. `AnnotationAwareAspectJAutoProxyCreator#postProcessBeforeInstantiation(UserService, UserService)`

.. `CommonAnnotationBeanPostProcessor#postProcessBeforeInstantiation(UserService, UserService)`

.. `AutowiredAnnotationBeanPostProcessor#postProcessBeforeInstantiation(UserService, UserService)`

.. æ„é€ å‡½æ•°

.. `CommonAnnotationBeanPostProcessor#postProcessMergedBeanDefinition(RootBeanDefinition, UserService, UserService)`

.. `AutowiredAnnotationBeanPostProcessor#postProcessMergedBeanDefinition(RootBeanDefinition, UserService, UserService)`

.. `ApplicationListenerDetector#postProcessMergedBeanDefinition(RootBeanDefinition, UserService, UserService)`

.. `ImportAwareBeanPostProcessor#postProcessAfterInstantiation(UserService, UserService)`

.. `AnnotationAwareAspectJAutoProxyCreator#postProcessAfterInstantiation(UserService, UserService)`

.. `CommonAnnotationBeanPostProcessor#postProcessAfterInstantiation(UserService, UserService)`

.. `AutowiredAnnotationBeanPostProcessor#postProcessAfterInstantiation(UserService, UserService)`

.. `ImportAwareBeanPostProcessor#postProcessProperties(MutablePropertyValues, UserService, UserService)`

.. `AnnotationAwareAspectJAutoProxyCreator#postProcessProperties(MutablePropertyValues, UserService, UserService)`

.. `AnnotationAwareAspectJAutoProxyCreator#postProcessPropertyValues(MutablePropertyValues, PropertyDescriptor[], UserService, UserService)`

.. `CommonAnnotationBeanPostProcessor#postProcessProperties(MutablePropertyValues, UserService, UserService)`

.. `AutowiredAnnotationBeanPostProcessor#postProcessProperties(MutablePropertyValues, UserService, UserService)`

.. `UserService#setBeanFactory(DefaultListableBeanFactory)`

.. `LogBeanPostProcessor#postProcessBeforeInitialization(UserService, UserService)`

.. `LogDestructionAwareBeanPostProcessor#postProcessBeforeInitialization(UserService, UserService)`

.. `ApplicationContextAwareProcessor#postProcessBeforeInitialization(UserService, UserService)`

.. `UserService#setApplicationContext(AnnotationConfigApplicationContext)`

.. `ImportAwareBeanPostProcessor#postProcessBeforeInitialization(UserService, UserService)`

.. `BeanPostProcessorChecker#postProcessBeforeInitialization(UserService, UserService)`

.. `AnnotationAwareAspectJAutoProxyCreator#postProcessBeforeInitialization(UserService, UserService)`

.. `CommonAnnotationBeanPostProcessor#postProcessBeforeInitialization(UserService, UserService)`

.. `AutowiredAnnotationBeanPostProcessor#postProcessBeforeInitialization(UserService, UserService)`

.. `ApplicationListenerDetector#postProcessBeforeInitialization(UserService, UserService)`

.. `UserService#afterPropertiesSet()`

.. `UserService#init()`

.. `LogBeanPostProcessor#postProcessAfterInitialization(UserService, UserService)`

.. `LogDestructionAwareBeanPostProcessor#postProcessAfterInitialization(UserService, UserService)`

.. `ApplicationContextAwareProcessor#postProcessAfterInitialization(UserService, UserService)`

.. `ImportAwareBeanPostProcessor#postProcessAfterInitialization(UserService, UserService)`

.. `BeanPostProcessorChecker#postProcessAfterInitialization(UserService, UserService)`

.. `AnnotationAwareAspectJAutoProxyCreator#postProcessAfterInitialization(UserService, UserService)`

.. `CommonAnnotationBeanPostProcessor#postProcessAfterInitialization(UserService, UserService)`

.. `AutowiredAnnotationBeanPostProcessor#postProcessAfterInitialization(UserService, UserService)`

.. `ApplicationListenerDetector#postProcessAfterInitialization(UserService, UserService)`

. é”€æ¯ Beanï¼Œ`beanFactory.destroyBean(bean)`

.. `LogDestructionAwareBeanPostProcessor#postProcessBeforeDestruction(UserService, UserService)`

.. `UserService#destroy()`

ä¸çŸ¥é“æœ‰æ²¡æœ‰äººå…³æ³¨è¿™ä¸ªé™„å½•æ—¥å¿—ï¼Œè¿™é‡Œå†é‡å¤ä¸€éï¼šåœ¨ä¸‹ä¸€ç¯‡æ–‡ç«  https://www.diguage.com/post/spring-bean-lifecycle-overview/[Spring Bean ç”Ÿå‘½å‘¨æœŸæ¦‚è¿°^] ä¸­ï¼ŒDç“œå“¥å°†é’ˆå¯¹ Spring Bean çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå±•å¼€è¯¦ç»†è¯´æ˜ã€‚

