---
title: "Redis æ ¸å¿ƒæ•°æ®ç»“æ„ï¼ˆå››ï¼‰"
date: 2025-06-17T16:36:56+08:00
draft: false
keywords: ["Redis"]
tags: ["å­˜å‚¨","è®¾è®¡","æ¶æ„"]
categories: ["ç¨‹åºè®¾è®¡","ç®—æ³•","åˆ†å¸ƒå¼"]
thumbnail: "images/redis/redis-logo.png"
weight: 1
---

åœ¨ https://www.diguage.com/post/redis-core-data-structure-3/[Redis æ ¸å¿ƒæ•°æ®ç»“æ„ï¼ˆä¸‰ï¼‰^] ä¸­ï¼Œé‡ç‚¹ä»‹ç»äº†ä¸€ä¸‹ Redis 7+ ä½¿ç”¨çš„åº•å±‚çš„æ•°æ®ç»“æ„ listpackã€‚æœ¬æ–‡é‡ç‚¹çœ‹ä¸€ä¸‹ï¼ŒRedis æ˜¯å¦‚ä½•åŸºäº listpack ä»¥åŠå…¶ä»–æ•°æ®ç»“æ„ç±»å‹æ¥æ„å»ºå¯¹å¤–æš´éœ²çš„äº”ä¸ªæ ¸å¿ƒæ•°æ®ç»“æ„çš„ã€‚

== quicklist

å…³äº quicklist æ›´è¯¦ç»†çš„ä»‹ç»ï¼Œè¯·çœ‹ https://www.diguage.com/post/redis-core-data-structure-1/#quicklist[Redis æ ¸å¿ƒæ•°æ®ç»“æ„ï¼ˆä¸€ï¼‰ - "åœ°ç“œå“¥"åšå®¢ç½‘ï¼šquicklist^]ã€‚

ä¸ä¸Šè¿°å†…å®¹ä¸ä¸€æ ·çš„åœ°æ–¹æ˜¯ï¼Œç°åœ¨çš„ quicklist åº•å±‚æ˜¯ä½¿ç”¨ listpack æ¥æ„å»ºçš„ï¼Œè€Œä¸æ˜¯ä¸Šè¿°å†…å®¹ä»‹ç»çš„ ziplistã€‚

`list-max-listpack-size` é»˜è®¤ `-2` 8 Kb sizeï¼Œæˆ–è€… `-1` 4 Kb size

== skiplist

== list

.`redis.conf`
[source%nowrap,bash,{source_attr}]
----
# Lists are also encoded in a special way to save a lot of space.
# The number of entries allowed per internal list node can be specified
# as a fixed maximum size or a maximum number of elements.
# For a fixed maximum size, use -5 through -1, meaning:
# -5: max size: 64 Kb  <-- not recommended for normal workloads
# -4: max size: 32 Kb  <-- not recommended
# -3: max size: 16 Kb  <-- probably not recommended
# -2: max size: 8 Kb   <-- good
# -1: max size: 4 Kb   <-- good
# Positive numbers mean store up to _exactly_ that number of elements
# per list node.
# The highest performing option is usually -2 (8 Kb size) or -1 (4 Kb size),
# but if your use case is unique, adjust the settings as necessary.
list-max-listpack-size -2
----

== set

----
# å…ƒç´ æ•°é‡å°äº 128
set-max-listpack-entries 128
# æ‰€æœ‰å…ƒç´ é•¿åº¦å°äº 64
set-max-listpack-value 64
----

== hash

----
# å…ƒç´ æ•°é‡å°äº 512
hash-max-listpack-entries 512
# æ‰€æœ‰å…ƒç´ é•¿åº¦å°äº 64
hash-max-listpack-value 64
----

[source%nowrap,bash,{source_attr}]
----
$ redis-cli --raw
127.0.0.1:6379> HMSET profile name "Dç“œå“¥" site "https://www.diguage.com" job "Developer"
OK

127.0.0.1:6379> TYPE profile
hash

127.0.0.1:6379> OBJECT encoding profile
listpack

127.0.0.1:6379> HSET profile address "1234567890123456789012345678901234567890123456789012345678901234"
1

127.0.0.1:6379> HVALS profile
Dç“œå“¥
https://www.diguage.com
Developer
1234567890123456789012345678901234567890123456789012345678901234

127.0.0.1:6379> OBJECT encoding profile
listpack

# ğŸ“¢ æ³¨æ„ï¼šä¸‹é¢ç¼–ç æ ¼å¼å¼€å§‹å‘ç”Ÿå˜åŒ–äº†ï¼
127.0.0.1:6379> HSET profile address2 "12345678901234567890123456789012345678901234567890123456789012345"
1

127.0.0.1:6379> HVALS profile
Developer
Dç“œå“¥
1234567890123456789012345678901234567890123456789012345678901234
https://www.diguage.com
12345678901234567890123456789012345678901234567890123456789012345

127.0.0.1:6379> OBJECT encoding profile
hashtable
----

== zset

----
# å…ƒç´ æ•°é‡å°äº 128
zset-max-listpack-entries 128
# æ‰€æœ‰å…ƒç´ é•¿åº¦å°äº 64
zset-max-listpack-value 64
----

[source,bash,{source_attr}]
----
$ redis-cli --raw
127.0.0.1:6379> ZADD NameRanking 1 "Dç“œå“¥"
1

127.0.0.1:6379> ZADD NameRanking 2 "https://www.diguage.com"
1

127.0.0.1:6379> ZADD NameRanking 3 "https://github.com/diguage"
1

127.0.0.1:6379> ZRANGE NameRanking 0 -1 WITHSCORES
Dç“œå“¥
1
https://www.diguage.com
2
https://github.com/diguage
3

127.0.0.1:6379> TYPE NameRanking
zset

127.0.0.1:6379> OBJECT encoding NameRanking
listpack

127.0.0.1:6379> ZADD NameRanking 4 "1234567890123456789012345678901234567890123456789012345678901234"
1

127.0.0.1:6379> ZRANGE NameRanking 0 -1 WITHSCORES
Dç“œå“¥
1
https://www.diguage.com
2
https://github.com/diguage
3
1234567890123456789012345678901234567890123456789012345678901234
4

127.0.0.1:6379> OBJECT encoding NameRanking
listpack

# ğŸ“¢ æ³¨æ„ï¼šä¸‹é¢ç¼–ç æ ¼å¼å¼€å§‹å‘ç”Ÿå˜åŒ–äº†ï¼
127.0.0.1:6379> ZADD NameRanking 5 "12345678901234567890123456789012345678901234567890123456789012345"
1

127.0.0.1:6379> ZRANGE NameRanking 0 -1 WITHSCORES
Dç“œå“¥
1
https://www.diguage.com
2
https://github.com/diguage
3
1234567890123456789012345678901234567890123456789012345678901234
4
12345678901234567890123456789012345678901234567890123456789012345
5

127.0.0.1:6379> OBJECT encoding NameRanking
skiplist

127.0.0.1:6379> TYPE NameRanking
zset
----

