<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>æºç åˆ†æ on "åœ°ç“œå“¥"åšå®¢ç½‘</title><link>https://www.diguage.com/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/</link><description>Recent content in æºç åˆ†æ on "åœ°ç“œå“¥"åšå®¢ç½‘</description><generator>Hugo</generator><language>zh-cn</language><lastBuildDate>Fri, 25 Oct 2024 11:01:03 +0800</lastBuildDate><atom:link href="https://www.diguage.com/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/index.xml" rel="self" type="application/rss+xml"/><item><title>æ—¥å¿—æœ€ä½³å®è·µæ¢ç©¶</title><link>https://www.diguage.com/post/logging-best-practices/</link><pubDate>Wed, 14 Jul 2021 10:52:58 +0800</pubDate><guid>https://www.diguage.com/post/logging-best-practices/</guid><description>&lt;div class="paragraph">
&lt;p>åŠ å…¥å…¬å¸ä»¥æ¥ï¼Œå‚ä¸äº†å¾ˆå¤šä¸ªé¡¹ç›®çš„å¼€å‘ç»´æŠ¤ï¼›ä¹Ÿæ’æŸ¥å¤„ç†è¿‡å¾ˆå¤šçº¿ä¸Šé—®é¢˜ï¼›ä¸ºäº†å†™ Mock æµ‹è¯•ï¼Œä¹Ÿä¸“é—¨å»æ—¥å¿—ç³»ç»Ÿä¸Šæ‰’æ‹‰è¿‡ä¸å°‘æ—¥å¿—ç­‰ç­‰ã€‚åœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œå¯¹æ—¥å¿—çš„è®¤è¯†æœ‰äº†ä¸å°‘æ›´æ·±åˆ»çš„è®¤è¯†å’Œä½“ä¼šã€‚ä¹Ÿå‘ç°ä¸å°‘é—®é¢˜ã€‚è¿™é‡Œå…ˆä»å­˜åœ¨çš„é—®é¢˜å±•å¼€è®ºè¿°ã€‚&lt;/p>
&lt;/div>
&lt;div class="sect1">
&lt;h2 id="_æ—¥å¿—å­˜åœ¨çš„é—®é¢˜">æ—¥å¿—å­˜åœ¨çš„é—®é¢˜&lt;/h2>
&lt;div class="sectionbody">
&lt;div class="paragraph">
&lt;p>ä»ä¸ªäººçš„çœ¼å…‰ä¸Šæ¥çœ‹ï¼Œå½“å‰çš„ç³»ç»Ÿå­˜åœ¨å¦‚ä¸‹é—®é¢˜ï¼š&lt;/p>
&lt;/div>
&lt;div class="olist arabic">
&lt;ol class="arabic">
&lt;li>
&lt;p>å¿…è¦æ—¥å¿—æ²¡æœ‰æ‰“å°å‡ºæ¥ï¼Œå¯¼è‡´åœ¨è¿½è¸ªé—®é¢˜æˆ–æµ‹è¯•ä»£ç æ—¶ï¼Œå¸¦æ¥ä¸å¿…è¦çš„éº»çƒ¦ã€‚æ¯”å¦‚æŸ¥çœ‹ä¸€ä¸ªæ¥å£çš„è¿”å›å€¼ç”¨äº Mock æµ‹è¯•ï¼›å†æ¯”å¦‚ RPC è°ƒç”¨æŠ¥é”™ï¼Œè¿”å›å€¼ä»¥åŠé”™è¯¯ä¿¡æ¯æ²¡æœ‰æ‰“å°åˆ°æ—¥å¿—ä¸­ï¼Œä¸çŸ¥é“å…·ä½“é”™è¯¯åŸå› æ˜¯ä»€ä¹ˆã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æ—¥å¿—æŠ½å–ä¸­æ—¥å¿—è·¯å¾„é…ç½®é”™è¯¯ï¼Œå¯¼è‡´æ—¥å¿—é‡å¤æ”¶é›†ï¼Œå¸¦æ¥ä¸å¿…è¦çš„å¤„ç†å’Œå­˜å‚¨æˆæœ¬ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æ—¥å¿—ä»£ç ä¸è§„èŒƒï¼Œå¯¼è‡´ä¸å¿…è¦çš„æ€§èƒ½æ¶ˆè€—ï¼›æˆ–è€…å¤§ä¿ƒæ—¶ï¼Œæ—¥å¿—é™çº§ä¸ç”Ÿæ•ˆã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æ—¥å¿—æ¡†æ¶ç¹å¤šï¼Œé€ æˆé€ æˆå†²çªï¼Œé—æ¼éƒ¨åˆ†æ—¥å¿—ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æ—¥å¿—é…ç½®ä¸è§„èŒƒï¼Œä¸åˆ©äºæ—¥å¿—çš„é‡‡é›†å’Œæ¸…æ´—ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æ—¥å¿—å’Œè°ƒç”¨é“¾è·¯ç‰©ç†éš”ç¦»ï¼ŒæŸ¥çœ‹ä¸€ä¸ªè¯·æ±‚çš„æ•´ä¸ªè°ƒç”¨é“¾è·¯ä¸Šçš„æ—¥å¿—éå¸¸ä¸æ–¹ä¾¿ï¼Œä¸åˆ©äºé—®é¢˜çš„å¿«é€Ÿæ’æŸ¥å’Œå®šä½ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div>
&lt;div class="paragraph">
&lt;p>&lt;em>å¤§å®¶çš„ç³»ç»Ÿä¸­ï¼Œå­˜åœ¨ä»€ä¹ˆæ ·çš„æ—¥å¿—é—®é¢˜ï¼Ÿæ¬¢è¿ç•™è¨€äº¤æµè®¨è®ºã€‚&lt;/em>&lt;/p>
&lt;/div>
&lt;div class="paragraph">
&lt;p>é’ˆå¯¹è¿™äº›é—®é¢˜ï¼Œæˆ‘è§‰å¾—æœ‰äº›åœ°æ–¹å€¼å¾—å‘åŠ›ä¸€ä¸‹ã€‚ç„¶åï¼Œåšäº†ä¸€äº›æ¢ç´¢ï¼Œæ€»ç»“ä¸€ä¸‹ï¼Œä»¥å¤‡åç»­ä½¿ç”¨ã€‚&lt;/p>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;div class="sect1">
&lt;h2 id="_æ—¥å¿—æœ€ä½³å®è·µæ¢ç´¢">æ—¥å¿—æœ€ä½³å®è·µæ¢ç´¢&lt;/h2>
&lt;div class="sectionbody">
&lt;div class="paragraph">
&lt;p>å¯¹äºæ—¥å¿—çš„ä½¿ç”¨ï¼Œç›¸ä¿¡æ‰€æœ‰çš„å¼€å‘äººå‘˜éƒ½æ¯”è¾ƒæ¸…æ¥šï¼Œç½‘ä¸Šä¹Ÿæœ‰å¤§é‡èµ„æ–™ï¼Œç›¸å…³æ—¥å¿—æ¡†æ¶çš„å®˜æ–¹æ–‡æ¡£ï¼Œä¹Ÿå†™çš„éå¸¸è¯¦å°½ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°ã€‚&lt;/p>
&lt;/div>
&lt;div class="paragraph">
&lt;p>æœ¬æ–‡ä»ä¸€ä¸ªè§’åº¦å¯¹æ—¥å¿—è§„èŒƒè¿›è¡Œæ¢ç©¶ï¼š&lt;strong>åœ¨æ’æŸ¥é—®é¢˜æ—¶ï¼Œèƒ½å¦é€šè¿‡æ—¥å¿—æ¥å°½å¿«åœ°äº†è§£ç³»ç»Ÿè¿è¡ŒçŠ¶æ€ï¼Œå®šä½é—®é¢˜åŸå› ï¼Ÿ&lt;/strong>å¦å¤–ï¼Œç”±äº Java çš„æ—¥å¿—æ¡†æ¶ç‰¹åˆ«å¤šï¼Œæœ‰ä¸€äº›æ¯”è¾ƒå®¹æ˜“è¿·æƒ‘çš„é—®é¢˜ï¼Œå°è¯•åšå‡ºä¸€ç‚¹æ€»ç»“ã€‚&lt;/p>
&lt;/div>
&lt;div class="paragraph">
&lt;p>ç³»ç»Ÿè¿è¡Œåï¼Œä¸ä¸¥æ ¼åœ°è¯´ï¼Œå†å»è§‚å¯Ÿç³»ç»Ÿè¿è¡ŒçŠ¶æ€ï¼Œå°±ç±»ä¼¼äºåœ¨é»‘å¤œä¸­è¡Œèµ°ã€‚æ­¤æ—¶ï¼Œå‘ä½ æ‰”è¿‡æ¥ä¸€å—æ¿ç –ğŸ§±ï¼Œé‚£ä¹ˆï¼Œäº‹åå¦‚ä½•è¿½è´£å‘¢ï¼Ÿ&lt;/p>
&lt;/div>
&lt;div class="imageblock text-center">
&lt;div class="content">
&lt;img src="https://www.diguage.com/images/logging/throw-bug.jpg" alt="throw bug" width="95%"/>
&lt;/div>
&lt;/div>
&lt;div class="paragraph">
&lt;p>è¯·é—®ï¼šä½ èƒ½å¦æˆåŠŸèº²å¼€è¿™å—å«åš Bug çš„æ¿ç –ğŸ§±ï¼Ÿ&lt;/p>
&lt;/div>
&lt;div class="paragraph">
&lt;p>æ—¥å¿—ç”¨æ¥è®°å½•ç”¨æˆ·æ“ä½œã€ç³»ç»Ÿè¿è¡ŒçŠ¶æ€ç­‰ï¼Œæ˜¯ä¸€ä¸ªç³»ç»Ÿçš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚ç„¶è€Œï¼Œç”±äºæ—¥å¿—é€šå¸¸ä¸å±äºç³»ç»Ÿçš„æ ¸å¿ƒåŠŸèƒ½ï¼Œä½†æ˜¯åœ¨æ—¥å¿—å¯¹äºæ’æŸ¥é—®é¢˜ï¼Œæœ‰æ— å¯æ›¿ä»£çš„ä½œç”¨ï¼Œç†åº”å¾—åˆ°æ‰€æœ‰å¼€å‘äººå‘˜çš„é‡è§†ï¼ˆä¸é‡è§†ï¼Œæ€ä¹ˆç”©é”…ï¼Ÿï¼ï¼‰ï¼&lt;/p>
&lt;/div>
&lt;div class="quoteblock">
&lt;blockquote>
&lt;div class="paragraph">
&lt;p>If dog is a manâ€™s best friend, &lt;br/>
logs are software engineerâ€™s best friend.&lt;/p>
&lt;/div>
&lt;/blockquote>
&lt;div class="attribution">
â€” Geshan Manandhar&lt;br/>
&lt;cite>Logging best practices&lt;/cite>
&lt;/div>
&lt;/div>
&lt;div class="paragraph">
&lt;p>å¥½çš„æ—¥å¿—å¯ä»¥å¸®åŠ©ç³»ç»Ÿçš„å¼€å‘å’Œè¿ç»´äººå‘˜ï¼š&lt;/p>
&lt;/div>
&lt;div class="olist arabic">
&lt;ol class="arabic">
&lt;li>
&lt;p>äº†è§£çº¿ä¸Šç³»ç»Ÿçš„è¿è¡ŒçŠ¶æ€&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¿«é€Ÿå‡†ç¡®å®šä½çº¿ä¸Šé—®é¢˜&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å‘ç°ç³»ç»Ÿç“¶é¢ˆ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>é¢„è­¦ç³»ç»Ÿæ½œåœ¨é£é™©&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æŒ–æ˜äº§å“æœ€å¤§ä»·å€¼&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¯ä»¥å°†ä¸€ä¸ªæµç¨‹å®Œæ•´ä¸²èµ·æ¥ï¼ˆæ¯”å¦‚orderIdï¼‰&lt;/p>
&lt;/li>
&lt;li>
&lt;p>â€¦â€¦&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div>
&lt;div class="imageblock text-center">
&lt;div class="content">
&lt;img src="https://www.diguage.com/images/logging/bug-goto-land.jpg" alt="bug goto land" width="95%"/>
&lt;/div>
&lt;/div>
&lt;div class="paragraph">
&lt;p>ä¸å¥½çš„æ—¥å¿—å¯¼è‡´ï¼š&lt;/p>
&lt;/div>
&lt;div class="olist arabic">
&lt;ol class="arabic">
&lt;li>
&lt;p>å¯¹ç³»ç»Ÿçš„è¿è¡ŒçŠ¶æ€ä¸€çŸ¥åŠè§£ï¼Œç”šè‡³ä¸€æ— æ‰€çŸ¥&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç³»ç»Ÿå‡ºç°é—®é¢˜æ— æ³•å®šä½ï¼Œæˆ–è€…éœ€è¦èŠ±è´¹å·¨å¤§çš„æ—¶é—´å’Œç²¾åŠ›&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æ— æ³•å‘ç°ç³»ç»Ÿç“¶é¢ˆï¼Œä¸çŸ¥ä¼˜åŒ–ä»ä½•åšèµ·&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æ— æ³•åŸºäºæ—¥å¿—å¯¹ç³»ç»Ÿè¿è¡Œè¿‡ç¨‹ä¸­çš„é”™è¯¯å’Œæ½œåœ¨é£é™©è¿›è¡Œç›‘æ§å’ŒæŠ¥è­¦&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¯¹æŒ–æ˜ç”¨æˆ·è¡Œä¸ºå’Œæå‡äº§å“ä»·å€¼æ¯«æ— å¸®åŠ©&lt;/p>
&lt;/li>
&lt;li>
&lt;p>â€¦â€¦&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>å¦‚ä½•é˜…è¯» Spring æºç ï¼Ÿ</title><link>https://www.diguage.com/post/how-to-read-spring-sources/</link><pubDate>Sat, 08 Aug 2020 07:53:32 +0800</pubDate><guid>https://www.diguage.com/post/how-to-read-spring-sources/</guid><description>&lt;div class="paragraph">
&lt;p>æ˜¨æ™šåŸè®¡åˆ’ç»™å‡ ä¸ªæœ‹å‹ç®€å•ä»‹ç»ä¸€ä¸‹é˜…è¯» Spring æºç çš„æ–¹æ³•ã€‚ç»“æœï¼Œå¤§å®¶å› ä¸ºå„ç§åŸå› æ²¡èƒ½åŠæ—¶å‚åŠ ã€‚åæ¥ï¼Œå°±å–æ¶ˆåˆ†äº«äº†ã€‚å¹²è„†å†™ä¸€ç¯‡æ–‡ç« å‡ºæ¥ï¼Œæ„Ÿå…´è¶£æ¬¢è¿è‡ªå–ã€‚&lt;/p>
&lt;/div>
&lt;div class="sect1">
&lt;h2 id="_ä»£ç å‡†å¤‡">ä»£ç å‡†å¤‡&lt;/h2>
&lt;div class="sectionbody">
&lt;div class="paragraph">
&lt;p>Spring Framework æ˜¯å¼€æºçš„ï¼Œä»£ç æ‰˜ç®¡åœ¨ GitHub ä¸Šï¼š &lt;a href="https://github.com/spring-projects/spring-framework" target="_blank" rel="noopener">Spring Framework&lt;/a>ã€‚ä»»ä½•äººéƒ½å¯ä»¥æ–¹ä¾¿åœ°è·å¾—å®ƒçš„æºä»£ç ã€‚æ‰€ä»¥ï¼Œå¦‚æœæƒ³é˜…è¯» Spring çš„æºä»£ç ï¼Œå½“ç„¶æ˜¯ç›´æ¥æŠŠä»£ç å…‹éš†åˆ°æœ¬åœ°ï¼Œç„¶åç›´æ¥åœ¨ IDEï¼ˆæ¨è IDEAï¼‰ä¸­è¿›è¡Œè°ƒè¯•äº†ã€‚å¦å¤–ï¼Œè¿˜éœ€è¦å­˜æ”¾è‡ªå·±å†™ä¸€äº›æµ‹è¯•å’Œæ–‡æ¡£ã€‚æ‰€ä»¥ï¼Œæœ€å¥½æŠŠä»£ç  fork åˆ°è‡ªå·±çš„è´¦æˆ·ä¸‹ï¼Œä» &lt;code>master&lt;/code> ä¸Šåˆ‡å‡ºä¸€ä¸ªæ–°åˆ†æ”¯å¹¶ push åˆ°è‡ªå·±çš„ Repo ä¸­ï¼Œè¿™æ ·è‡ªå·±å°±å¯ä»¥éšæ„æ›´æ–°äº†ã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š&lt;/p>
&lt;/div>
&lt;div class="olist arabic">
&lt;ol class="arabic">
&lt;li>
&lt;p>å…‹éš†ä»£ç &lt;/p>
&lt;div class="listingblock">
&lt;div class="content">
&lt;pre class="rouge highlight nowrap">&lt;code data-lang="bash">&lt;span class="c"># ç›´æ¥å…‹éš†åŸå§‹ä»“åº“ä¸º origin&lt;/span>
git clone git@github.com:spring-projects/spring-framework.git&lt;/code>&lt;/pre>
&lt;/div>
&lt;/div>
&lt;/li>
&lt;li>
&lt;p>fork ä»£ç ï¼ŒDç“œå“¥ç›´æ¥ fork åˆ°è‡ªå·±è´¦æˆ·ä¸‹äº†ï¼š &lt;a href="https://github.com/diguage/spring-framework" target="_blank" rel="noopener">diguage/spring-framework&lt;/a>ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æ·»åŠ åŸåˆ›ä»“åº“åœ°å€ï¼š&lt;/p>
&lt;div class="listingblock">
&lt;div class="content">
&lt;pre class="rouge highlight nowrap">&lt;code data-lang="bash">&lt;span class="c"># æ·»åŠ è‡ªå·±ä»“åº“ä¸º diguage&lt;/span>
&lt;span class="c"># è¿™æ ·å°±èƒ½åœ¨æ‰€æœ‰é¡¹ç›®ä¸­ä¿æŒå‘½åçš„ä¸€è‡´æ€§ï¼Œæ–¹ä¾¿æ ‡è¯†&lt;/span>
git remote add diguage git@github.com:diguage/spring-framework.git&lt;/code>&lt;/pre>
&lt;/div>
&lt;/div>
&lt;/li>
&lt;li>
&lt;p>åˆ›å»ºæ–°åˆ†æ”¯&lt;/p>
&lt;div class="listingblock">
&lt;div class="content">
&lt;pre class="rouge highlight nowrap">&lt;code data-lang="bash">&lt;span class="c"># åˆ›å»ºæ–°åˆ†æ”¯&lt;/span>
git switch &lt;span class="nt">-c&lt;/span> analysis

&lt;span class="c"># å°†æ–°åˆ†æ”¯ push åˆ°è‡ªå·±çš„ Repo ä¸­&lt;/span>
git push diguage analysis&lt;/code>&lt;/pre>
&lt;/div>
&lt;/div>
&lt;div class="paragraph">
&lt;p>è¿™æ ·ï¼Œåœ¨è¿™ä¸ªæ–°åˆ†æ”¯ä¸Šï¼Œå°±å¯ä»¥éšæ„æŠ˜è…¾äº†ã€‚&lt;/p>
&lt;/div>
&lt;/li>
&lt;li>
&lt;p>ä¸‹è½½ä¾èµ–&lt;/p>
&lt;div class="listingblock">
&lt;div class="content">
&lt;pre class="rouge highlight nowrap">&lt;code data-lang="bash">&lt;span class="c"># Mac or Linux&lt;/span>
./gradlew clean &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> ./gradlew :spring-oxm:compileTestJava &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> ./gradlew &lt;span class="nb">test&lt;/span>

&lt;span class="c"># Windows&lt;/span>
gradlew.bat clean &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> gradlew.bat :spring-oxm:compileTestJava &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> gradlew.bat &lt;span class="nb">test&lt;/span>&lt;/code>&lt;/pre>
&lt;/div></description></item><item><title>HikariCP æºç åˆ†æ -- FastList</title><link>https://www.diguage.com/post/hikari-cp-source-analysis-fast-list/</link><pubDate>Sun, 02 Aug 2020 15:06:02 +0800</pubDate><guid>https://www.diguage.com/post/hikari-cp-source-analysis-fast-list/</guid><description>&lt;div class="paragraph">
&lt;p>åœ¨å‰é¢çš„æ–‡ç«  &lt;a href="https://www.diguage.com/post/hikari-cp-source-analysis-concurrent-bag/">HikariCP æºç åˆ†æâ€‰â€”â€‰ConcurrentBag&lt;/a> ä¸­ï¼ŒDç“œå“¥åˆ†æäº†ä¸€ä¸‹ HikariCP ä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„æ•°æ®ç»“æ„ &lt;code>ConcurrentBag&lt;/code>ã€‚&lt;/p>
&lt;/div>
&lt;div class="paragraph">
&lt;p>ä»Šå¤©ï¼Œç»§ç»­å†ä»‹ç» HikariCP ä¸­å¦ä¸€ä¸ªå¾ˆå…³é”®çš„æ•°æ®ç»“æ„ï¼š &lt;code>FastList&lt;/code>ã€‚&lt;/p>
&lt;/div>
&lt;div class="paragraph">
&lt;p>&lt;code>FastList&lt;/code> æœ¬èº«çš„å®ç°éå¸¸ç®€å•ï¼Œè¦ç†è§£å®ƒçš„å¥¥ç§˜ï¼Œå°±éœ€è¦ç»“åˆ Java åŸç”Ÿé›†åˆç±»çš„ &lt;code>ArrayList&lt;/code> æ¥æ¯”è¾ƒæ€§åœ°çœ‹ã€‚&lt;/p>
&lt;/div>
&lt;div class="sect1">
&lt;h2 id="_æ„é€ å‡½æ•°">æ„é€ å‡½æ•°&lt;/h2>
&lt;div class="sectionbody">
&lt;div class="paragraph">
&lt;p>å…ˆæ¥å¯¹æ¯”ä¸€ä¸‹ä¸¤è€…çš„æ„é€ å‡½æ•°ã€‚å…ˆæ¥çœ‹çœ‹ &lt;code>FastList&lt;/code>ï¼š&lt;/p>
&lt;/div>
&lt;div class="listingblock">
&lt;div class="title">&lt;code>FastList&lt;/code>&lt;/div>
&lt;div class="content">
&lt;pre class="rouge highlight">&lt;code data-lang="java">&lt;span class="kd">public&lt;/span> &lt;span class="kd">final&lt;/span> &lt;span class="kd">class&lt;/span> &lt;span class="nc">FastList&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="no">T&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="kd">implements&lt;/span> &lt;span class="nc">List&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="no">T&lt;/span>&lt;span class="o">&amp;gt;,&lt;/span> &lt;span class="nc">RandomAccess&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="nc">Serializable&lt;/span>
&lt;span class="o">{&lt;/span>
 &lt;span class="kd">private&lt;/span> &lt;span class="kd">static&lt;/span> &lt;span class="kd">final&lt;/span> &lt;span class="kt">long&lt;/span> &lt;span class="n">serialVersionUID&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">4598088075242913858L&lt;/span>&lt;span class="o">;&lt;/span>

 &lt;span class="kd">private&lt;/span> &lt;span class="kd">final&lt;/span> &lt;span class="nc">Class&lt;/span>&lt;span class="o">&amp;lt;?&amp;gt;&lt;/span> &lt;span class="n">clazz&lt;/span>&lt;span class="o">;&lt;/span>
 &lt;span class="kd">private&lt;/span> &lt;span class="no">T&lt;/span>&lt;span class="o">[]&lt;/span> &lt;span class="n">elementData&lt;/span>&lt;span class="o">;&lt;/span>
 &lt;span class="kd">private&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">size&lt;/span>&lt;span class="o">;&lt;/span>

 &lt;span class="cm">/**
 * Construct a FastList with a default size of 32.
 * @param clazz the Class stored in the collection
 */&lt;/span>
 &lt;span class="nd">@SuppressWarnings&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s">&amp;#34;unchecked&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>
 &lt;span class="kd">public&lt;/span> &lt;span class="nf">FastList&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="nc">Class&lt;/span>&lt;span class="o">&amp;lt;?&amp;gt;&lt;/span> &lt;span class="n">clazz&lt;/span>&lt;span class="o">)&lt;/span>
 &lt;span class="o">{&lt;/span>
 &lt;span class="k">this&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">elementData&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">(&lt;/span>&lt;span class="no">T&lt;/span>&lt;span class="o">[])&lt;/span> &lt;span class="nc">Array&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">newInstance&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">clazz&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="mi">32&lt;/span>&lt;span class="o">);&lt;/span>
 &lt;span class="k">this&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">clazz&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">clazz&lt;/span>&lt;span class="o">;&lt;/span>
 &lt;span class="o">}&lt;/span>

 &lt;span class="cm">/**
 * Construct a FastList with a specified size.
 * @param clazz the Class stored in the collection
 * @param capacity the initial size of the FastList
 */&lt;/span>
 &lt;span class="nd">@SuppressWarnings&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s">&amp;#34;unchecked&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>
 &lt;span class="kd">public&lt;/span> &lt;span class="nf">FastList&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="nc">Class&lt;/span>&lt;span class="o">&amp;lt;?&amp;gt;&lt;/span> &lt;span class="n">clazz&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">capacity&lt;/span>&lt;span class="o">)&lt;/span>
 &lt;span class="o">{&lt;/span>
 &lt;span class="k">this&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">elementData&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">(&lt;/span>&lt;span class="no">T&lt;/span>&lt;span class="o">[])&lt;/span> &lt;span class="nc">Array&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">newInstance&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">clazz&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">capacity&lt;/span>&lt;span class="o">);&lt;/span>
 &lt;span class="k">this&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">clazz&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">clazz&lt;/span>&lt;span class="o">;&lt;/span>
 &lt;span class="o">}&lt;/span>&lt;/code>&lt;/pre>
&lt;/div></description></item><item><title>åˆ†å¸ƒå¼é”ä¹‹ Apache Curator InterProcessReadWriteLock</title><link>https://www.diguage.com/post/distributed-lock-apache-curator-interprocessreadwritelock/</link><pubDate>Wed, 22 Jul 2020 10:45:44 +0800</pubDate><guid>https://www.diguage.com/post/distributed-lock-apache-curator-interprocessreadwritelock/</guid><description>&lt;div class="paragraph">
&lt;p>åœ¨ä¸Šä¸€ç¯‡æ–‡ç«  &lt;a href="https://www.diguage.com/post/distributed-lock-apache-curator-interprocessmutex/">åˆ†å¸ƒå¼é”ä¹‹ Apache Curator InterProcessMutex&lt;/a> ä¸­ä»‹ç»äº†åŸºäº ZooKeeper å®ç°çš„äº’æ–¥é”ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥å®ç°è¯»å†™é”ã€‚è¿™ç¯‡æ–‡ç« å°±æ¥ç®€è¦ä»‹ç»ä¸€ä¸‹ &lt;code>InterProcessReadWriteLock&lt;/code> çš„å®ç°åŸç†ã€‚&lt;/p>
&lt;/div>
&lt;div class="paragraph">
&lt;p>è€è§„çŸ©ï¼Œå…ˆçœ‹çœ‹ç±»çš„æ³¨é‡Šï¼š&lt;/p>
&lt;/div>
&lt;div class="listingblock">
&lt;div class="content">
&lt;pre class="rouge highlight">&lt;code data-lang="java">&lt;span class="cm">/**
 * &amp;lt;p&amp;gt;
 * A re-entrant read/write mutex that works across JVMs. Uses Zookeeper to hold the lock. All processes
 * in all JVMs that use the same lock path will achieve an inter-process critical section. Further, this mutex is
 * &amp;#34;fair&amp;#34; - each user will get the mutex in the order requested (from ZK&amp;#39;s point of view).
 * &amp;lt;/p&amp;gt;
 *
 * &amp;lt;p&amp;gt;
 * A read write lock maintains a pair of associated locks, one for read-only operations and one
 * for writing. The read lock may be held simultaneously by multiple reader processes, so long as
 * there are no writers. The write lock is exclusive.
 * &amp;lt;/p&amp;gt;
 *
 * &amp;lt;p&amp;gt;
 * &amp;lt;b&amp;gt;Reentrancy&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;
 * This lock allows both readers and writers to reacquire read or write locks in the style of a
 * re-entrant lock. Non-re-entrant readers are not allowed until all write locks held by the
 * writing thread/process have been released. Additionally, a writer can acquire the read lock, but not
 * vice-versa. If a reader tries to acquire the write lock it will never succeed.&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;
 *
 * &amp;lt;b&amp;gt;Lock downgrading&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;
 * Re-entrancy also allows downgrading from the write lock to a read lock, by acquiring the write
 * lock, then the read lock and then releasing the write lock. However, upgrading from a read
 * lock to the write lock is not possible.
 * &amp;lt;/p&amp;gt;
 */&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kd">class&lt;/span> &lt;span class="nc">InterProcessReadWriteLock&lt;/span>
&lt;span class="o">{&lt;/span>&lt;/code>&lt;/pre>
&lt;/div></description></item><item><title>åˆ†å¸ƒå¼é”ä¹‹ Apache Curator InterProcessMutex</title><link>https://www.diguage.com/post/distributed-lock-apache-curator-interprocessmutex/</link><pubDate>Tue, 21 Jul 2020 10:13:21 +0800</pubDate><guid>https://www.diguage.com/post/distributed-lock-apache-curator-interprocessmutex/</guid><description>&lt;div class="paragraph">
&lt;p>å¯¹åˆ†å¸ƒå¼é”è€³ç†Ÿèƒ½è¯¦ã€‚ä¸è¿‡ï¼Œä¸€ç›´å…³æ³¨çš„æ˜¯åŸºäº Redis å®ç°çš„åˆ†å¸ƒå¼é”ã€‚çŸ¥é“ ZooKeeper ä¹Ÿå¯ä»¥å®ç°åˆ†å¸ƒå¼é”ã€‚ä½†æ˜¯ï¼ŒåŸæ¥çš„æƒ³æ³•æ˜¯æŠŠ Redis é‚£ä¸ªæ€è·¯åˆ‡æ¢åˆ° ZooKeeper ä¸Šæ¥å®ç°å°±å¥½ã€‚ä»Šå¤©äº†è§£åˆ° Apache Curator å†…ç½®äº†åˆ†å¸ƒå¼é”çš„å®ç°ï¼š &lt;code>InterProcessMutex&lt;/code>ã€‚æŸ¥çœ‹äº†ä¸€ä¸‹æºç å®ç°ï¼Œå‘ç°è·ŸåŸºäº Redis å®ç°çš„æºç ç›¸æ¯”ï¼Œåœ¨æ€è·¯ä¸Šè¿˜æ˜¯æœ‰å¾ˆå¤§ä¸åŒçš„ã€‚æ‰€ä»¥ï¼Œç‰¹åˆ«ä½œæ–‡è®°å½•ä¸€ä¸‹ã€‚&lt;/p>
&lt;/div>
&lt;div class="paragraph">
&lt;p>å…ˆæ¥çœ‹ä¸€ä¸‹ï¼Œæ•´ä½“æµç¨‹ï¼š&lt;/p>
&lt;/div>
&lt;div class="paragraph">
&lt;p>&lt;span class="image">&lt;img src="https://www.diguage.com/images/distributed-system/InterProcessMutex-process.png" alt="InterProcessMutex process" width="95%"/>&lt;/span>&lt;/p>
&lt;/div>
&lt;div class="paragraph">
&lt;p>ç»“åˆæµç¨‹å›¾å’Œæºç ï¼ŒåŠ é”çš„è¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼š&lt;/p>
&lt;/div>
&lt;div class="olist arabic">
&lt;ol class="arabic">
&lt;li>
&lt;p>å…ˆåˆ¤æ–­æœ¬åœ°æ˜¯å¦æœ‰é”æ•°æ®ï¼Œå¦‚æœæœ‰åˆ™å¯¹é”å®šæ¬¡æ•°è‡ªå¢ä¸€ä¸‹ï¼Œç„¶åè¿”å› &lt;code>true&lt;/code>ï¼›&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¦‚æœæ²¡æœ‰é”æ•°æ®ï¼Œåˆ™å°è¯•è·å–é”ï¼š&lt;/p>
&lt;div class="olist loweralpha">
&lt;ol class="loweralpha" type="a">
&lt;li>
&lt;p>åœ¨æŒ‡å®šè·¯å¾„ä¸‹åˆ›å»ºä¸´æ—¶é¡ºåºèŠ‚ç‚¹&lt;/p>
&lt;/li>
&lt;li>
&lt;p>è·å–æŒ‡å®šè·¯å¾„ä¸‹ï¼Œæ‰€æœ‰èŠ‚ç‚¹ï¼Œæ£€æŸ¥è‡ªèº«æ˜¯å¦æ˜¯åºå·æœ€å°çš„èŠ‚ç‚¹ï¼š&lt;/p>
&lt;div class="olist lowerroman">
&lt;ol class="lowerroman" type="i">
&lt;li>
&lt;p>å¦‚æœè‡ªèº«åºå·æœ€å°ï¼Œåˆ™è·å¾—é”ï¼›å¦åˆ™&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¦‚æœè‡ªèº«ä¸æ˜¯åºå·æœ€å°çš„èŠ‚ç‚¹ï¼Œåˆ™é€šè¿‡ &lt;code>while&lt;/code> è‡ªæ—‹ + &lt;code>wait(times)&lt;/code> ä¸æ–­å°è¯•è·å–é”ï¼Œç›´åˆ°æˆåŠŸã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div>
&lt;/li>
&lt;li>
&lt;p>è·å¾—é”åï¼ŒæŠŠé”ä¿¡æ¯ç¼“å­˜åœ¨æœ¬åœ° &lt;code>ConcurrentMap&amp;lt;Thread, LockData&amp;gt; threadData&lt;/code> å˜é‡ä¸­ï¼Œæ–¹ä¾¿è®¡ç®—é‡å…¥ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div>
&lt;/li>
&lt;/ol>
&lt;/div>
&lt;div class="paragraph">
&lt;p>åœ¨ ZooKeeper ä¸­çš„ç»“æ„å¤§è‡´å¦‚ä¸‹ï¼š&lt;/p>
&lt;/div>
&lt;div class="paragraph">
&lt;p>&lt;span class="image">&lt;img src="https://www.diguage.com/images/distributed-system/InterProcessMutex-structure.png" alt="InterProcessMutex structure" width="95%"/>&lt;/span>&lt;/p>
&lt;/div>
&lt;div class="paragraph">
&lt;p>ä¸‹é¢æˆ‘ä»¬é€ä¸ªæ–¹æ³•è¿›è¡Œåˆ†æè¯´æ˜ã€‚å…ˆæ¥çœ‹ä¸€ä¸‹ &lt;code>InterProcessMutex&lt;/code> çš„æ³¨é‡Šï¼š&lt;/p>
&lt;/div>
&lt;div class="listingblock">
&lt;div class="content">
&lt;pre class="rouge highlight">&lt;code data-lang="java">&lt;span class="cm">/**
 * A re-entrant mutex that works across JVMs. Uses Zookeeper to hold the lock. All processes in all JVMs that
 * use the same lock path will achieve an inter-process critical section. Further, this mutex is
 * &amp;#34;fair&amp;#34; - each user will get the mutex in the order requested (from ZK&amp;#39;s point of view)
 */&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kd">class&lt;/span> &lt;span class="nc">InterProcessMutex&lt;/span> &lt;span class="kd">implements&lt;/span> &lt;span class="nc">InterProcessLock&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="nc">Revocable&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="nc">InterProcessMutex&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;/code>&lt;/pre>
&lt;/div></description></item><item><title>æ·±å…¥å‰–æ Spring æ ¸å¿ƒæ•°æ®ç»“æ„ï¼šBeanFactory</title><link>https://www.diguage.com/post/dive-into-spring-core-data-structure-bean-factory/</link><pubDate>Fri, 26 Jun 2020 15:30:08 +0800</pubDate><guid>https://www.diguage.com/post/dive-into-spring-core-data-structure-bean-factory/</guid><description>&lt;div class="paragraph">
&lt;p>åœ¨ &lt;a href="https://www.diguage.com/post/dive-into-spring-core-data-structure-bean-definition/" target="_blank" rel="noopener">æ·±å…¥å‰–æ Spring æ ¸å¿ƒæ•°æ®ç»“æ„ï¼šBeanDefinition&lt;/a> ä¸­ï¼Œä»‹ç»äº† &lt;code>BeanDefinition&lt;/code>ã€‚ç½‘ä¸Šå¾ˆå¤šæ–‡ç« ä»‹ç» &lt;code>BeanDefinition&lt;/code> çš„ APIï¼ŒDç“œå“¥å´è¦åå…¶é“è€Œè¡Œä¹‹ï¼Œä»å†…éƒ¨å±æ€§æ¥åˆ†æä¸€ä¸‹ã€‚ä¸‹é¢æˆ‘ä»¬å¼€å§‹ã€‚&lt;/p>
&lt;/div>
&lt;div class="sect1">
&lt;h2 id="_ç»§æ‰¿ä½“ç³»">ç»§æ‰¿ä½“ç³»&lt;/h2>
&lt;div class="sectionbody">
&lt;div class="paragraph">
&lt;p>Spring éå¸¸å¥½åœ°éµå¾ªäº†é¢å‘å¯¹è±¡çš„è®¾è®¡åŸåˆ™ï¼šé¢å‘æ¥å£ç¼–ç¨‹ã€‚ä¸æ”¾è¿‡ä»»ä½•å¯ä»¥æå–å‡ºæˆæ¥å£çš„æœºä¼šã€‚è™½ç„¶æ„Ÿè§‰ä¼¼ä¹å¢åŠ äº†ç±»çš„ç»§æ‰¿å…³ç³»ï¼Œå¢åŠ äº†ä¸€ç‚¹çš„å¤æ‚åº¦ã€‚ä½†æ˜¯ï¼Œå´å¸¦æ¥äº†éå¸¸å¥½çš„å¯æ‰©å±•æ€§ã€‚è€Œ &lt;code>BeanFactory&lt;/code> çš„ç»§æ‰¿ä½“ç³»å°±æ˜¯ä¸€ä¸ªéå¸¸å…¸å‹çš„ä¾‹å­ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å®ƒçš„ç»§æ‰¿ä½“ç³»ï¼š&lt;/p>
&lt;/div>
&lt;div class="imageblock text-center">
&lt;div class="content">
&lt;img src="https://www.diguage.com/images/spring-framework/BeanFactory.svg" alt="BeanFactory ç»§æ‰¿ä½“ç³»" width="98%"/>
&lt;/div>
&lt;div class="title">å›¾ 1. BeanFactory ç»§æ‰¿ä½“ç³»&lt;/div>
&lt;/div>
&lt;div class="ulist">
&lt;ul>
&lt;li>
&lt;p>&lt;code>AliasRegistry&lt;/code>ï¼šåˆ«åæ³¨å†Œå™¨ã€‚Spring ä¸­ï¼Œåˆ«åæ³¨å†Œç›¸å…³çš„åŠŸèƒ½å°±æ˜¯ä»è¿™é‡Œå®ç°çš„ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>SimpleAliasRegistry&lt;/code>ï¼šåˆ«åæ³¨å†Œå™¨çš„ä¸€ä¸ªç®€å•å®ç°ï¼Œä»å†…éƒ¨å±æ€§å¯ä»¥çœ‹å‡ºï¼Œå®ƒæ˜¯æŠŠåˆ«åæ˜ å°„ä¿¡æ¯å­˜åˆ°ä¸€ä¸ª &lt;code>Map&lt;/code> ä¸­äº†ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>DefaultSingletonBeanRegistry&lt;/code>ï¼šé»˜è®¤çš„å•ä¾‹ Bean æ³¨å†Œå™¨ï¼Œä»å†…éƒ¨å±æ€§æ¥è¯´ï¼Œä¹Ÿæ˜¯åŸºäº &lt;code>Map&lt;/code> å®ç°çš„ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>FactoryBeanRegistrySupport&lt;/code>ï¼š &lt;code>FactoryBean&lt;/code> æ³¨å†Œå™¨ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>SingletonBeanRegistry&lt;/code>ï¼šå•ä¾‹ Bean æ³¨å†Œå™¨ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>BeanDefinitionRegistry&lt;/code>ï¼š &lt;code>BeanDefinition&lt;/code> æ³¨å†Œå™¨ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>BeanFactory&lt;/code>ï¼šå®¹å™¨çš„åŸºç±»ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>ListableBeanFactory&lt;/code>ï¼šåœ¨åŸºæœ¬å®¹å™¨åŸºç¡€ä¸Šï¼Œå¢åŠ äº†éå†ç›¸å…³åŠŸèƒ½ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>HierarchicalBeanFactory&lt;/code>ï¼šåœ¨åŸºæœ¬å®¹å™¨åŸºç¡€ä¸Šï¼Œå¢åŠ äº†çˆ¶å­ä¸Šä¸‹çº§å®¹å™¨å…³è”ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>AutowireCapableBeanFactory&lt;/code>ï¼šåœ¨åŸºæœ¬å®¹å™¨åŸºç¡€ä¸Šï¼Œå¢åŠ äº†è‡ªåŠ¨æ³¨å…¥åŠŸèƒ½ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>ConfigurableBeanFactory&lt;/code>ï¼šå¯¹å®¹å™¨å¢åŠ å¯é…ç½®æ€§ï¼Œæ¯”å¦‚çˆ¶çº§å®¹å™¨ã€&lt;code>ClassLoader&lt;/code>ã€&lt;code>TypeConverter&lt;/code> ç­‰ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>ConfigurableListableBeanFactory&lt;/code>ï¼šå¯é…ç½®å¯éå†å®¹å™¨ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>AbstractBeanFactory&lt;/code>ï¼šå®¹å™¨çš„æŠ½è±¡å®ç°ç±»ï¼Œå®ç°äº†å®¹å™¨çš„åŸºç¡€åŠŸèƒ½ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>AbstractAutowireCapableBeanFactory&lt;/code>ï¼šå¸¦è‡ªåŠ¨è£…é…åŠŸèƒ½çš„æŠ½è±¡å®¹å™¨ç±»ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>DefaultListableBeanFactory&lt;/code>ï¼šè¿™æ˜¯ Spring å†…éƒ¨ä½¿ç”¨çš„é»˜è®¤å®¹å™¨å®ç°ã€‚ä¹Ÿæ˜¯ Spring ä¸­æœ€é‡è¦çš„ä¸€ä¸ªç±»ã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;div class="sect1">
&lt;h2 id="_æ ¸å¿ƒå±æ€§">æ ¸å¿ƒå±æ€§&lt;/h2>
&lt;div class="sectionbody">
&lt;div class="sect2">
&lt;h3 id="registry">Registry&lt;/h3>
&lt;div class="olist arabic">
&lt;ol class="arabic">
&lt;li>
&lt;p>&lt;code>Map&amp;lt;String, String&amp;gt; aliasMap = new ConcurrentHashMap&amp;lt;&amp;gt;(16)&lt;/code>ï¼šåˆ«ååˆ° Bean åç§°çš„æ˜ å°„ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>&lt;code>Map&amp;lt;String, Object&amp;gt; singletonObjects = new ConcurrentHashMap&amp;lt;&amp;gt;(256)&lt;/code>&lt;/strong>ï¼šBean åç§°åˆ°å•ä¾‹ Bean çš„æ˜ å°„ã€‚å¯ä»¥ç†è§£æˆï¼Œè¿™å°±æ˜¯æ‰€è°“çš„å®¹å™¨ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>Map&amp;lt;String, Object&amp;gt; earlySingletonObjects = new HashMap&amp;lt;&amp;gt;(16)&lt;/code>ï¼šBean åˆ°â€œæœªæˆç†Ÿâ€å•ä¾‹ Bean çš„æ˜ å°„ã€‚è¯¥ Bean å¯¹è±¡åªæ˜¯è¢«åˆ›å»ºå‡ºæ¥ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰æ³¨å…¥ä¾èµ–ã€‚åœ¨å®¹å™¨è§£å†³å¾ªç¯ä¾èµ–æ—¶ï¼Œç”¨äºå­˜å‚¨ä¸­é—´çŠ¶æ€ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>Map&amp;lt;String, ObjectFactory&amp;lt;?&amp;gt;&amp;gt; singletonFactories = new HashMap&amp;lt;&amp;gt;(16)&lt;/code>ï¼šBean åç§°åˆ° Bean çš„ &lt;code>ObjectFactory&lt;/code> å¯¹è±¡çš„æ˜ å°„ï¼Œåœ¨å®¹å™¨è§£å†³å¾ªç¯ä¾èµ–æ—¶ï¼Œç”¨äºå­˜å‚¨ä¸­é—´çŠ¶æ€ã€‚&lt;/p>
&lt;div class="paragraph">
&lt;p>å…³äºè¿™ä¸‰ä¸ªå±æ€§çš„è¿›ä¸€æ­¥è¯´æ˜ï¼Œè¯·ç§»æ­¥ï¼š &lt;a href="https://www.diguage.com//post/spring-circular-dependence/">æºç å‰–æ Spring å¾ªç¯ä¾èµ–&lt;/a>ã€‚&lt;/p>
&lt;/div></description></item><item><title>æ·±å…¥å‰–æ Spring æ ¸å¿ƒæ•°æ®ç»“æ„ï¼šBeanDefinition</title><link>https://www.diguage.com/post/dive-into-spring-core-data-structure-bean-definition/</link><pubDate>Sun, 21 Jun 2020 21:18:57 +0800</pubDate><guid>https://www.diguage.com/post/dive-into-spring-core-data-structure-bean-definition/</guid><description>&lt;div class="paragraph">
&lt;p>æ—çº³æ–¯Â·æ‰˜ç“¦å…¹ï¼ˆLinus Torvaldsï¼‰è¯´ï¼šâ€œæˆ‘ä»å¿ƒåº•è®¤ä¸ºï¼Œä¼˜ç§€çš„ç¨‹åºå‘˜ä¸å¹³åº¸çš„ç¨‹åºå‘˜ä¹‹é—´çš„åŒºåˆ«ï¼Œæ˜¯åœ¨äºè®¤ä¸ºè‡ªå·±çš„ä»£ç é‡è¦è¿˜æ˜¯æ•°æ®ç»“æ„æ›´åŠ é‡è¦ã€‚å¹³åº¸çš„ç¨‹åºå‘˜çœ¼é‡Œåªæœ‰ä»£ç ï¼Œä¼˜ç§€çš„ç¨‹åºå‘˜åˆ™å…³æ³¨æ•°æ®ç»“æ„åŠä¹‹å‰çš„å…³ç³»ã€‚â€ ä¹Ÿè®¸å¾ˆå¤šäººè§‰å¾— Spring ç¥ç§˜è«æµ‹ï¼Œä½†æ˜¯å¦‚æœäº†è§£äº†å®ƒçš„æ ¸å¿ƒæ•°æ®ç»“æ„ï¼Œå¾ˆå¤šé—®é¢˜è¿åˆƒè€Œè§£ã€‚&lt;/p>
&lt;/div>
&lt;div class="paragraph">
&lt;p>Spring ä¸­ä¸¤ä¸ªæ•°æ®ç»“æ„æœ€æ ¸å¿ƒï¼šâ‘  &lt;code>BeanDefinition&lt;/code>ï¼Œç”¨äºè¡¨ç¤º Bean çš„å®šä¹‰ï¼›â‘¡ &lt;code>BeanFactory&lt;/code>ï¼Œç”¨äºè¡¨ç¤ºæ•´ä¸ª IoC å®¹å™¨ã€‚&lt;/p>
&lt;/div>
&lt;div class="paragraph">
&lt;p>åœ¨å‰é¢æ–‡ç«  &lt;a href="https://www.diguage.com/post/spring-bean-lifecycle-overview/" target="_blank" rel="noopener">Spring Bean ç”Ÿå‘½å‘¨æœŸæ¦‚è¿°&lt;/a>ä¸­ï¼Œä»‹ç»äº† Spring Bean çš„ç”Ÿå‘½å‘¨æœŸã€‚ä¸çŸ¥é“å¤§å®¶æœ‰æ²¡æœ‰æ€è€ƒè¿‡ Spring åœ¨å†…éƒ¨æ˜¯å¦‚ä½•è¡¨ç¤ºä¸€ä¸ª Bean çš„ï¼Ÿæœ¬ç¯‡æ–‡ç« ï¼Œå°±æ¥èŠä¸€èŠ &lt;code>BeanDefinition&lt;/code>&lt;/p>
&lt;/div>
&lt;div class="sect1">
&lt;h2 id="_é—®é¢˜">é—®é¢˜&lt;/h2>
&lt;div class="sectionbody">
&lt;div class="paragraph">
&lt;p>ä½¿ç”¨ Spring æ—¶ï¼Œå°¤å…¶æ˜¯ä½¿ç”¨ XML é…ç½®çš„æ—¶å€™ï¼Œä¹Ÿè®¸æˆ‘ä»¬ä¼šè¿™æ ·çš„é—®é¢˜ï¼š&lt;/p>
&lt;/div>
&lt;div class="olist arabic">
&lt;ol class="arabic">
&lt;li>
&lt;p>Bean æ€ä¹ˆè¡¨ç¤ºï¼Ÿ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Bean çš„ä¾èµ–æ€ä¹ˆè¡¨ç¤ºï¼Ÿ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>init-method&lt;/code> æ–¹æ³•æ€ä¹ˆå­˜å‚¨ï¼Ÿ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Bean çš„ä¸€äº›å±æ€§ï¼Œæ¯”å¦‚ &lt;code>lazy-init&lt;/code> ç­‰ï¼Œæ€ä¹ˆè¡¨ç¤ºï¼Ÿ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Bean æ„é€ å‡½æ•°çš„å‚æ•°æ€ä¹ˆå­˜å‚¨ï¼Ÿ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>â€¦â€‹&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div>
&lt;div class="paragraph">
&lt;p>Java ä¹Ÿæœ‰ç±»ä¼¼çš„é—®é¢˜ï¼Œæ¯”å¦‚æ€ä¹ˆè¡¨ç¤ºä¸€ä¸ªç±»ï¼ŸJava é€šè¿‡åå°„ API æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š&lt;/p>
&lt;/div>
&lt;div class="olist arabic">
&lt;ol class="arabic">
&lt;li>
&lt;p>&lt;code>Class&lt;/code>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>Method&lt;/code>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>Field&lt;/code>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>Constructor&lt;/code>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>Annotation&lt;/code>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div>
&lt;div class="paragraph">
&lt;p>ä½†æ˜¯ï¼Œä¸ºä»€ä¹ˆ Spring è¿˜è¦è‡ªå·±å®šä¹‰ä¸€å¥—å‘¢ï¼Ÿä¸»è¦åŸå› æ˜¯ Java åå°„ API ä¸æ»¡è¶³ Spring çš„éœ€æ±‚ï¼Œæ¯”å¦‚ï¼Œå®ƒæ²¡åŠæ³•è¡¨ç¤ºå“ªäº›ç±»æ˜¯ &lt;code>SCOPE_SINGLETON&lt;/code>ï¼Œå“ªäº›ç±»æ˜¯ &lt;code>SCOPE_PROTOTYPE&lt;/code>ã€‚&lt;/p>
&lt;/div>
&lt;div class="paragraph">
&lt;p>å¦å¤–ï¼ŒSpring çš„ Bean æŠ½è±¡ä¹Ÿå¹¶ä¸æ˜¯å®Œå…¨è‡ªå®šä¹‰çš„ï¼Œå®ƒæ˜¯åŸºäº Java åå°„ API åˆå¢åŠ äº†è‡ªå®šä¹‰åŠŸèƒ½ï¼Œå…¶æ ¸å¿ƒ API å°±æ˜¯ &lt;code>BeanDefinition&lt;/code>ã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬æ¥ä»”ç»†çœ‹ä¸€ä¸‹å®ƒçš„ç»§æ‰¿ä½“ç³»ä»¥åŠå†…éƒ¨æ ¸å¿ƒå±æ€§ã€‚&lt;/p>
&lt;/div></description></item><item><title>HikariCP æºç åˆ†æ -- ConcurrentBag</title><link>https://www.diguage.com/post/hikari-cp-source-analysis-concurrent-bag/</link><pubDate>Wed, 06 May 2020 17:12:55 +0800</pubDate><guid>https://www.diguage.com/post/hikari-cp-source-analysis-concurrent-bag/</guid><description>&lt;div class="paragraph">
&lt;p>ä»¥å‰æ— æ„é—´æœèµ„æ–™äº†è§£åˆ° HikariCPï¼Œä¸€ä¸‹å­å°±è¢«å®ƒçš„ç®€æ´ä»£ç å’Œå“è¶Šæ€§èƒ½å¸å¼•ä½äº†ã€‚ä»¥å‰ä¹Ÿæœ‰ç¿»è¿‡å®ƒçš„ä»£ç ï¼Œä½†æ˜¯ä¸æ˜¯å¾ˆç³»ç»Ÿï¼Œæœ€è¿‘å†æ¬¡ç¿»é˜…ï¼Œæ­£å¥½åšäº›ç¬”è®°ï¼Œæ–¹ä¾¿ä»¥åå­¦ä¹ ã€‚&lt;/p>
&lt;/div>
&lt;div class="paragraph">
&lt;p>Dç“œå“¥æœ€è¿‘åœ¨å­¦ä¹  Java å¹¶å‘çŸ¥è¯†ã€‚é‚£å°±ä» HikariCP è‡ªå®šä¹‰çš„å¹¶å‘é›†åˆ &lt;code>ConcurrentBag&lt;/code> å¼€å§‹å­¦ä¹ ã€‚&lt;/p>
&lt;/div>
&lt;div class="paragraph">
&lt;p>åœ¨ HikariCP çš„ Wiki ä¸­ï¼Œæœ‰ &lt;a href="https://github.com/brettwooldridge/HikariCP/wiki/Down-the-Rabbit-Hole#concurrentbag" target="_blank" rel="noopener">Down the Rabbit Hole Â· ConcurrentBag&lt;/a> çš„ç« èŠ‚æ¥ä¸“é—¨ä»‹ç» &lt;code>ConcurrentBag&lt;/code>ï¼š&lt;/p>
&lt;/div>
&lt;div class="paragraph">
&lt;p>&lt;code>ConcurrentBag&lt;/code> çš„çµæ„Ÿå€Ÿé‰´è‡ª C# .NET çš„ &lt;code>ConcurrentBag&lt;/code> ç±»ã€‚ä½†æ˜¯å®ç°å´æ˜¯å®Œå…¨ä¸åŒçš„ã€‚è¿™é‡Œçš„ &lt;code>ConcurrentBag&lt;/code> æœ‰å¦‚ä¸‹ç‰¹æ€§ï¼š&lt;/p>
&lt;/div>
&lt;div class="ulist">
&lt;ul>
&lt;li>
&lt;p>A lock-free design&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ThreadLocal caching&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Queue-stealing&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Direct hand-off optimizations&lt;/p>
&lt;/li>
&lt;/ul>
&lt;/div>
&lt;div class="paragraph">
&lt;p>ä¸‹é¢ï¼Œé€šè¿‡ä»£ç æ¥å¯¹æ­¤åšä¸ªè¯´æ˜ã€‚&lt;/p>
&lt;/div>
&lt;div class="paragraph">
&lt;p>åœ¨ &lt;code>ConcurrentBag&lt;/code> ç±»çš„å®šä¹‰ä¸­ï¼Œå£°æ˜äº†é›†åˆå…ƒç´ å¿…é¡»æ˜¯ &lt;code>IConcurrentBagEntry&lt;/code> çš„å­ç±»ã€‚å…ˆæ¥çœ‹çœ‹è¿™ä¸ªæ¥å£çš„å®šä¹‰ï¼š&lt;/p>
&lt;/div>
&lt;div class="listingblock">
&lt;div class="content">
&lt;pre class="rouge highlight">&lt;code data-lang="java">&lt;span class="kd">public&lt;/span> &lt;span class="kd">interface&lt;/span> &lt;span class="nc">IConcurrentBagEntry&lt;/span>
&lt;span class="o">{&lt;/span>
 &lt;span class="kt">int&lt;/span> &lt;span class="no">STATE_NOT_IN_USE&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="o">;&lt;/span>
 &lt;span class="kt">int&lt;/span> &lt;span class="no">STATE_IN_USE&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">;&lt;/span>
 &lt;span class="kt">int&lt;/span> &lt;span class="no">STATE_REMOVED&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">;&lt;/span>
 &lt;span class="kt">int&lt;/span> &lt;span class="no">STATE_RESERVED&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="o">;&lt;/span>

 &lt;span class="kt">boolean&lt;/span> &lt;span class="nf">compareAndSet&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">expectState&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">newState&lt;/span>&lt;span class="o">);&lt;/span>
 &lt;span class="kt">void&lt;/span> &lt;span class="nf">setState&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">newState&lt;/span>&lt;span class="o">);&lt;/span>
 &lt;span class="kt">int&lt;/span> &lt;span class="nf">getState&lt;/span>&lt;span class="o">();&lt;/span>
&lt;span class="o">}&lt;/span>&lt;/code>&lt;/pre>
&lt;/div>
&lt;/div>
&lt;div class="paragraph">
&lt;p>æ¥ä¸‹æ¥ï¼Œçœ‹ä¸€ä¸‹æˆå‘˜å˜é‡ï¼š&lt;/p>
&lt;/div>
&lt;div class="listingblock">
&lt;div class="content">
&lt;pre class="rouge highlight">&lt;code data-lang="java">&lt;span class="c1">// å­˜æ”¾å…±äº«å…ƒç´ &lt;/span>
&lt;span class="kd">private&lt;/span> &lt;span class="kd">final&lt;/span> &lt;span class="nc">CopyOnWriteArrayList&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="no">T&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">sharedList&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="kd">private&lt;/span> &lt;span class="kd">final&lt;/span> &lt;span class="kt">boolean&lt;/span> &lt;span class="n">weakThreadLocals&lt;/span>&lt;span class="o">;&lt;/span>

&lt;span class="c1">// åœ¨ ThreadLocal ç¼“å­˜çº¿ç¨‹æœ¬åœ°å…ƒç´ ï¼Œé¿å…çº¿ç¨‹äº‰ç”¨&lt;/span>
&lt;span class="kd">private&lt;/span> &lt;span class="kd">final&lt;/span> &lt;span class="nc">ThreadLocal&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="nc">List&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="nc">Object&lt;/span>&lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">threadList&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="kd">private&lt;/span> &lt;span class="kd">final&lt;/span> &lt;span class="nc">IBagStateListener&lt;/span> &lt;span class="n">listener&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="c1">//&lt;/span>
&lt;span class="kd">private&lt;/span> &lt;span class="kd">final&lt;/span> &lt;span class="nc">AtomicInteger&lt;/span> &lt;span class="n">waiters&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="kd">private&lt;/span> &lt;span class="kd">volatile&lt;/span> &lt;span class="kt">boolean&lt;/span> &lt;span class="n">closed&lt;/span>&lt;span class="o">;&lt;/span>

&lt;span class="c1">// æ¥åŠ›é˜Ÿåˆ—&lt;/span>
&lt;span class="kd">private&lt;/span> &lt;span class="kd">final&lt;/span> &lt;span class="nc">SynchronousQueue&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="no">T&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">handoffQueue&lt;/span>&lt;span class="o">;&lt;/span>&lt;/code>&lt;/pre>
&lt;/div>
&lt;/div>
&lt;div class="paragraph">
&lt;p>åœ¨ &lt;code>ConcurrentBag&lt;/code> å¼€å¤´çš„ JavaDoc ä¸­å°±åšäº†æ˜ç¡®è¯´æ˜ï¼š&lt;/p>
&lt;/div>
&lt;div class="sidebarblock">
&lt;div class="content">
&lt;div class="paragraph">
&lt;p>Note that items that are &amp;#34;borrowed&amp;#34; from the bag are not actually removed from any collection, so garbage collection will not occur even if the reference is abandoned. Thus care must be taken to &amp;#34;requite&amp;#34; borrowed objects otherwise a memory leak will result. Only the &amp;#34;remove&amp;#34; method can completely remove an object from the bag.&lt;/p>
&lt;/div></description></item></channel></rss>